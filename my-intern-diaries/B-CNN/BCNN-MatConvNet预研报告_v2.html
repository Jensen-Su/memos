<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>Research On B-CNN & MatConvNet_ch.html</title>
  <meta name="generator" content="Haroopad 0.13.1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>div.oembedall-githubrepos{border:1px solid #DDD;border-radius:4px;list-style-type:none;margin:0 0 10px;padding:8px 10px 0;font:13.34px/1.4 helvetica,arial,freesans,clean,sans-serif;width:452px;background-color:#fff}div.oembedall-githubrepos .oembedall-body{background:-moz-linear-gradient(center top,#FAFAFA,#EFEFEF);background:-webkit-gradient(linear,left top,left bottom,from(#FAFAFA),to(#EFEFEF));border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-top:1px solid #EEE;margin-left:-10px;margin-top:8px;padding:5px 10px;width:100%}div.oembedall-githubrepos h3{font-size:14px;margin:0;padding-left:18px;white-space:nowrap}div.oembedall-githubrepos p.oembedall-description{color:#444;font-size:12px;margin:0 0 3px}div.oembedall-githubrepos p.oembedall-updated-at{color:#888;font-size:11px;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats{border:none;float:right;font-size:11px;font-weight:700;padding-left:15px;position:relative;z-index:5;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats li{border:none;color:#666;display:inline-block;list-style-type:none;margin:0!important}div.oembedall-githubrepos ul.oembedall-repo-stats li a{background-color:transparent;border:none;color:#666!important;background-position:5px -2px;background-repeat:no-repeat;border-left:1px solid #DDD;display:inline-block;height:21px;line-height:21px;padding:0 5px 0 23px}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a{border-left:medium none;margin-right:-3px}div.oembedall-githubrepos ul.oembedall-repo-stats li a:hover{background:5px -27px no-repeat #4183C4;color:#FFF!important;text-decoration:none}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a:hover{border-bottom-left-radius:3px;border-top-left-radius:3px}ul.oembedall-repo-stats li:last-child a:hover{border-bottom-right-radius:3px;border-top-right-radius:3px}span.oembedall-closehide{background-color:#aaa;border-radius:2px;cursor:pointer;margin-right:3px}div.oembedall-container{margin-top:5px;text-align:left}.oembedall-ljuser{font-weight:700}.oembedall-ljuser img{vertical-align:bottom;border:0;padding-right:1px}.oembedall-stoqembed{border-bottom:1px dotted #999;float:left;overflow:hidden;width:730px;line-height:1;background:#FFF;color:#000;font-family:Arial,Liberation Sans,DejaVu Sans,sans-serif;font-size:80%;text-align:left;margin:0;padding:0}.oembedall-stoqembed a{color:#07C;text-decoration:none;margin:0;padding:0}.oembedall-stoqembed a:hover{text-decoration:underline}.oembedall-stoqembed a:visited{color:#4A6B82}.oembedall-stoqembed h3{font-family:Trebuchet MS,Liberation Sans,DejaVu Sans,sans-serif;font-size:130%;font-weight:700;margin:0;padding:0}.oembedall-stoqembed .oembedall-reputation-score{color:#444;font-size:120%;font-weight:700;margin-right:2px}.oembedall-stoqembed .oembedall-user-info{height:35px;width:185px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-gravatar32{float:left;height:32px;width:32px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-details{float:left;margin-left:5px;overflow:hidden;white-space:nowrap;width:145px}.oembedall-stoqembed .oembedall-question-hyperlink{font-weight:700}.oembedall-stoqembed .oembedall-stats{background:#EEE;margin:0 0 0 7px;padding:4px 7px 6px;width:58px}.oembedall-stoqembed .oembedall-statscontainer{float:left;margin-right:8px;width:86px}.oembedall-stoqembed .oembedall-votes{color:#555;padding:0 0 7px;text-align:center}.oembedall-stoqembed .oembedall-vote-count-post{font-size:240%;color:#808185;display:block;font-weight:700}.oembedall-stoqembed .oembedall-views{color:#999;padding-top:4px;text-align:center}.oembedall-stoqembed .oembedall-status{margin-top:-3px;padding:4px 0;text-align:center;background:#75845C;color:#FFF}.oembedall-stoqembed .oembedall-status strong{color:#FFF;display:block;font-size:140%}.oembedall-stoqembed .oembedall-summary{float:left;width:635px}.oembedall-stoqembed .oembedall-excerpt{line-height:1.2;margin:0;padding:0 0 5px}.oembedall-stoqembed .oembedall-tags{float:left;line-height:18px}.oembedall-stoqembed .oembedall-tags a:hover{text-decoration:none}.oembedall-stoqembed .oembedall-post-tag{background-color:#E0EAF1;border-bottom:1px solid #3E6D8E;border-right:1px solid #7F9FB6;color:#3E6D8E;font-size:90%;line-height:2.4;margin:2px 2px 2px 0;padding:3px 4px;text-decoration:none;white-space:nowrap}.oembedall-stoqembed .oembedall-post-tag:hover{background-color:#3E6D8E;border-bottom:1px solid #37607D;border-right:1px solid #37607D;color:#E0EAF1}.oembedall-stoqembed .oembedall-fr{float:right}.oembedall-stoqembed .oembedall-statsarrow{background-image:url(http://cdn.sstatic.net/stackoverflow/img/sprites.png?v=3);background-repeat:no-repeat;overflow:hidden;background-position:0 -435px;float:right;height:13px;margin-top:12px;width:7px}.oembedall-facebook1{border:1px solid #1A3C6C;padding:0;font:13.34px/1.4 verdana;width:500px}.oembedall-facebook2{background-color:#627add}.oembedall-facebook2 a{color:#e8e8e8;text-decoration:none}.oembedall-facebookBody{background-color:#fff;vertical-align:top;padding:5px}.oembedall-facebookBody .contents{display:inline-block;width:100%}.oembedall-facebookBody div img{float:left;margin-right:5px}div.oembedall-lanyard{-webkit-box-shadow:none;-webkit-transition-delay:0s;-webkit-transition-duration:.4000000059604645s;-webkit-transition-property:width;-webkit-transition-timing-function:cubic-bezier(0.42,0,.58,1);background-attachment:scroll;background-clip:border-box;background-color:transparent;background-image:none;background-origin:padding-box;border-width:0;box-shadow:none;color:#112644;display:block;float:left;font-family:'Trebuchet MS',Trebuchet,sans-serif;font-size:16px;height:253px;line-height:19px;margin:0;max-width:none;min-height:0;outline:#112644 0;overflow-x:visible;overflow-y:visible;padding:0;position:relative;text-align:left;vertical-align:baseline;width:804px}div.oembedall-lanyard .tagline{font-size:1.5em}div.oembedall-lanyard .wrapper{overflow:hidden;clear:both}div.oembedall-lanyard .split{float:left;display:inline}div.oembedall-lanyard .prominent-place .flag:active,div.oembedall-lanyard .prominent-place .flag:focus,div.oembedall-lanyard .prominent-place .flag:hover,div.oembedall-lanyard .prominent-place .flag:link,div.oembedall-lanyard .prominent-place .flag:visited{float:left;display:block;width:48px;height:48px;position:relative;top:-5px;margin-right:10px}div.oembedall-lanyard .place-context{font-size:.889em}div.oembedall-lanyard .prominent-place .sub-place{display:block}div.oembedall-lanyard .prominent-place{font-size:1.125em;line-height:1.1em;font-weight:400}div.oembedall-lanyard .main-date{color:#8CB4E0;font-weight:700;line-height:1.1}div.oembedall-lanyard .first{width:48.57%;margin:0 0 0 2.857%}.cluster rect{rx:40}.cluster text{fill:#333}.actor{stroke:#13540c;fill:#cde498}text.actor{fill:#000;stroke:none}.actor-line{stroke:grey}.messageLine0{stroke-width:1.5;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#333}.messageLine1{stroke-width:1.5;stroke-dasharray:"2 2";stroke:#333}#arrowhead{fill:#333}#crosshead path{fill:#333!important;stroke:#333!important}.messageText{fill:#333;stroke:none}.labelBox{stroke:#326932;fill:#cde498}.labelText,.loopText{fill:#000;stroke:none}.loopLine{stroke-width:2;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#326932}.note{stroke:#6eaa49;fill:#fff5ad}.noteText{fill:#000;stroke:none;font-family:'trebuchet ms',verdana,arial;font-size:14px}.section{stroke:none;opacity:.2}.section0,.section2{fill:#6eaa49}.section1,.section3{fill:#fff;opacity:.2}.sectionTitle0,.sectionTitle1,.sectionTitle2,.sectionTitle3{fill:#333}.sectionTitle{text-anchor:start;font-size:11px;text-height:14px}.grid .tick{stroke:lightgrey;opacity:.3;shape-rendering:crispEdges}.grid path{stroke-width:0}.today{fill:none;stroke:red;stroke-width:2px}.task{stroke-width:2}.taskText{text-anchor:middle;font-size:11px}.taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px}.taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}.taskText0,.taskText1,.taskText2,.taskText3{fill:#fff}.task0,.task1,.task2,.task3{fill:#487e3a;stroke:#13540c}.taskTextOutside0,.taskTextOutside1,.taskTextOutside2,.taskTextOutside3{fill:#000}.active0,.active1,.active2,.active3{fill:#cde498;stroke:#13540c}.activeText0,.activeText1,.activeText2,.activeText3{fill:#000!important}.done0,.done1,.done2,.done3{stroke:grey;fill:lightgrey;stroke-width:2}.doneText0,.doneText1,.doneText2,.doneText3{fill:#000!important}.crit0,.crit1,.crit2,.crit3{stroke:#f88;fill:red;stroke-width:2}.activeCrit0,.activeCrit1,.activeCrit2,.activeCrit3{stroke:#f88;fill:#cde498;stroke-width:2}.doneCrit0,.doneCrit1,.doneCrit2,.doneCrit3{stroke:#f88;fill:lightgrey;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}.activeCritText0,.activeCritText1,.activeCritText2,.activeCritText3,.doneCritText0,.doneCritText1,.doneCritText2,.doneCritText3{fill:#000!important}.titleText{text-anchor:middle;font-size:18px;fill:#000}text{font-family:'trebuchet ms',verdana,arial;font-size:14px}html{height:100%}body{margin:0!important;padding:5px 20px 26px!important;background-color:#fff;font-family:"Lucida Grande","Segoe UI","Apple SD Gothic Neo","Malgun Gothic","Lucida Sans Unicode",Helvetica,Arial,sans-serif;font-size:.9em;overflow-x:hidden;overflow-y:auto}br,h1,h2,h3,h4,h5,h6{clear:both}hr.page{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x;border:0;height:3px;padding:0}hr.underscore{border-top-style:dashed!important}body >:first-child{margin-top:0!important}img.plugin{box-shadow:0 1px 3px rgba(0,0,0,.1);border-radius:3px}iframe{border:0}figure{-webkit-margin-before:0;-webkit-margin-after:0;-webkit-margin-start:0;-webkit-margin-end:0}kbd{border:1px solid #aaa;-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;-moz-box-shadow:1px 2px 2px #ddd;-webkit-box-shadow:1px 2px 2px #ddd;box-shadow:1px 2px 2px #ddd;background-color:#f9f9f9;background-image:-moz-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-o-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-webkit-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:linear-gradient(top,#eee,#f9f9f9,#eee);padding:1px 3px;font-family:inherit;font-size:.85em}.oembeded .oembed_photo{display:inline-block}img[data-echo]{margin:25px 0;width:100px;height:100px;background:url(../img/ajax.gif) center center no-repeat #fff}.spinner{display:inline-block;width:10px;height:10px;margin-bottom:-.1em;border:2px solid rgba(0,0,0,.5);border-top-color:transparent;border-radius:100%;-webkit-animation:spin 1s infinite linear;animation:spin 1s infinite linear}.spinner:after{content:'';display:block;width:0;height:0;position:absolute;top:-6px;left:0;border:4px solid transparent;border-bottom-color:rgba(0,0,0,.5);-webkit-transform:rotate(45deg);transform:rotate(45deg)}@-webkit-keyframes spin{to{-webkit-transform:rotate(360deg)}}@keyframes spin{to{transform:rotate(360deg)}}p.toc{margin:0!important}p.toc ul{padding-left:10px}p.toc>ul{padding:10px;margin:0 10px;display:inline-block;border:1px solid #ededed;border-radius:5px}p.toc li,p.toc ul{list-style-type:none}p.toc li{width:100%;padding:0;overflow:hidden}p.toc li a::after{content:"."}p.toc li a:before{content:"• "}p.toc h5{text-transform:uppercase}p.toc .title{float:left;padding-right:3px}p.toc .number{margin:0;float:right;padding-left:3px;background:#fff;display:none}input.task-list-item{margin-left:-1.62em}.markdown{font-family:"Hiragino Sans GB","Microsoft YaHei",STHeiti,SimSun,"Lucida Grande","Lucida Sans Unicode","Lucida Sans",'Segoe UI',AppleSDGothicNeo-Medium,'Malgun Gothic',Verdana,Tahoma,sans-serif;padding:20px}.markdown a{text-decoration:none;vertical-align:baseline}.markdown a:hover{text-decoration:underline}.markdown h1{font-size:2.2em;font-weight:700;margin:1.5em 0 1em}.markdown h2{font-size:1.8em;font-weight:700;margin:1.275em 0 .85em}.markdown h3{font-size:1.6em;font-weight:700;margin:1.125em 0 .75em}.markdown h4{font-size:1.4em;font-weight:700;margin:.99em 0 .66em}.markdown h5{font-size:1.2em;font-weight:700;margin:.855em 0 .57em}.markdown h6{font-size:1em;font-weight:700;margin:.75em 0 .5em}.markdown h1+p,.markdown h1:first-child,.markdown h2+p,.markdown h2:first-child,.markdown h3+p,.markdown h3:first-child,.markdown h4+p,.markdown h4:first-child,.markdown h5+p,.markdown h5:first-child,.markdown h6+p,.markdown h6:first-child{margin-top:0}.markdown hr{border:1px solid #ccc}.markdown p{margin:1em 0;word-wrap:break-word}.markdown ol{list-style-type:decimal}.markdown li{display:list-item;line-height:1.4em}.markdown blockquote{margin:1em 20px}.markdown blockquote>:first-child{margin-top:0}.markdown blockquote>:last-child{margin-bottom:0}.markdown blockquote cite:before{content:'\2014 \00A0'}.markdown .code{border-radius:3px;word-wrap:break-word}.markdown pre{border-radius:3px;word-wrap:break-word;border:1px solid #ccc;overflow:auto;padding:.5em}.markdown pre code{border:0;display:block}.markdown pre>code{font-family:Consolas,Inconsolata,Courier,monospace;font-weight:700;white-space:pre;margin:0}.markdown code{border-radius:3px;word-wrap:break-word;border:1px solid #ccc;padding:0 5px;margin:0 2px}.markdown img{max-width:100%}.markdown mark{color:#000;background-color:#fcf8e3}.markdown table{padding:0;border-collapse:collapse;border-spacing:0;margin-bottom:16px}.markdown table tr td,.markdown table tr th{border:1px solid #ccc;margin:0;padding:6px 13px}.markdown table tr th{font-weight:700}.markdown table tr th>:first-child{margin-top:0}.markdown table tr th>:last-child{margin-bottom:0}.markdown table tr td>:first-child{margin-top:0}.markdown table tr td>:last-child{margin-bottom:0}.solarized-light{padding:20px;color:#737373;font-size:15px;background:#fdf6e3;-webkit-font-smoothing:antialiased}.solarized-light a{color:#1e6ea7}.solarized-light a:hover{color:#268bd2}.solarized-light h1,.solarized-light h2,.solarized-light h3,.solarized-light h4,.solarized-light h5{color:#b58900}.solarized-light h2{border-bottom:1px solid #f6d784;line-height:1.7em}.solarized-light h6{color:#9c7600}.solarized-light hr{border:1px solid #fae7b3}.solarized-light pre>code{font-size:.9em}.solarized-light blockquote{border-left:4px solid #fae7b3;padding:0 15px;font-style:italic}.solarized-light table{background-color:#fdf4dd}.solarized-light table tr td,.solarized-light table tr th{border:1px solid #fae7b3}.solarized-light table tr:nth-child(2n){background-color:#fef8ea}.hljs{display:block;overflow-x:auto;padding:.5em;color:#333;background:#f8f8f8;-webkit-text-size-adjust:none}.diff .hljs-header,.hljs-comment,.hljs-javadoc{color:#998;font-style:italic}.css .rule .hljs-keyword,.hljs-keyword,.hljs-request,.hljs-status,.hljs-subst,.hljs-winutils,.nginx .hljs-title{color:#333;font-weight:700}.hljs-hexcolor,.hljs-number,.ruby .hljs-constant{color:teal}.hljs-dartdoc,.hljs-phpdoc,.hljs-string,.hljs-tag .hljs-value,.tex .hljs-formula{color:#d14}.hljs-id,.hljs-title,.scss .hljs-preprocessor{color:#900;font-weight:700}.hljs-list .hljs-keyword,.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type,.tex .hljs-command,.vhdl .hljs-literal{color:#458;font-weight:700}.django .hljs-tag .hljs-keyword,.hljs-rules .hljs-property,.hljs-tag,.hljs-tag .hljs-title{color:navy;font-weight:400}.hljs-attribute,.hljs-variable,.lisp .hljs-body{color:teal}.hljs-regexp{color:#009926}.clojure .hljs-keyword,.hljs-prompt,.hljs-symbol,.lisp .hljs-keyword,.ruby .hljs-symbol .hljs-string,.scheme .hljs-keyword,.tex .hljs-special{color:#990073}.hljs-built_in{color:#0086b3}.hljs-cdata,.hljs-doctype,.hljs-pi,.hljs-pragma,.hljs-preprocessor,.hljs-shebang{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.diff .hljs-change{background:#0086b3}.hljs-chunk{color:#aaa}.MathJax_Hover_Frame{border-radius:.25em;-webkit-border-radius:.25em;-moz-border-radius:.25em;-khtml-border-radius:.25em;box-shadow:0 0 15px #83A;-webkit-box-shadow:0 0 15px #83A;-moz-box-shadow:0 0 15px #83A;-khtml-box-shadow:0 0 15px #83A;border:1px solid #A6D!important;display:inline-block;position:absolute}.MathJax_Hover_Arrow{position:absolute;width:15px;height:11px;cursor:pointer}#MathJax_About{position:fixed;left:50%;width:auto;text-align:center;border:3px outset;padding:1em 2em;background-color:#DDD;color:#000;cursor:default;font-family:message-box;font-size:120%;font-style:normal;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;border-radius:15px;-webkit-border-radius:15px;-moz-border-radius:15px;-khtml-border-radius:15px;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_Menu{position:absolute;background-color:#fff;color:#000;width:auto;padding:5px 0;border:1px solid #CCC;margin:0;cursor:default;font:menu;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;border-radius:5px;-webkit-border-radius:5px;-moz-border-radius:5px;-khtml-border-radius:5px;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_MenuItem{padding:1px 2em;background:0 0}.MathJax_MenuArrow{position:absolute;right:.5em;color:#666}.MathJax_MenuActive .MathJax_MenuArrow{color:#fff}.MathJax_MenuArrow.RTL{left:.5em;right:auto}.MathJax_MenuCheck{position:absolute;left:.7em}.MathJax_MenuCheck.RTL{right:.7em;left:auto}.MathJax_MenuRadioCheck{position:absolute;left:.7em}.MathJax_MenuRadioCheck.RTL{right:.7em;left:auto}.MathJax_MenuLabel{padding:1px 2em 3px 1.33em;font-style:italic}.MathJax_MenuRule{border-top:1px solid #DDD;margin:4px 3px}.MathJax_MenuDisabled{color:GrayText}.MathJax_MenuActive{background-color:#606872;color:#fff}.MathJax_Menu_Close{position:absolute;width:31px;height:31px;top:-15px;left:-15px}#MathJax_Zoom{position:absolute;background-color:#F0F0F0;overflow:auto;display:block;z-index:301;padding:.5em;border:1px solid #000;margin:0;font-weight:400;font-style:normal;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;box-shadow:5px 5px 15px #AAA;-webkit-box-shadow:5px 5px 15px #AAA;-moz-box-shadow:5px 5px 15px #AAA;-khtml-box-shadow:5px 5px 15px #AAA;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}#MathJax_ZoomOverlay{position:absolute;left:0;top:0;z-index:300;display:inline-block;width:100%;height:100%;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}#MathJax_ZoomFrame{position:relative;display:inline-block;height:0;width:0}#MathJax_ZoomEventTrap{position:absolute;left:0;top:0;z-index:302;display:inline-block;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}.MathJax_Preview{color:#888}#MathJax_Message{position:fixed;left:1px;bottom:2px;background-color:#E6E6E6;border:1px solid #959595;margin:0;padding:2px 8px;z-index:102;color:#000;font-size:80%;width:auto;white-space:nowrap}#MathJax_MSIE_Frame{position:absolute;top:0;left:0;width:0;z-index:101;border:0;margin:0;padding:0}.MathJax_Error{color:#C00;font-style:italic}.MathJax_Display{text-align:center;margin:1em 0;position:relative;display:block!important;text-indent:0;max-width:none;max-height:none;min-width:0;min-height:0;width:100%}.MathJax .merror{background-color:#FF8;color:#C00;border:1px solid #C00;padding:1px 3px;font-style:normal;font-size:90%}.MathJax .MJX-monospace{font-family:monospace}.MathJax .MJX-sans-serif{font-family:sans-serif}#MathJax_Tooltip{background-color:InfoBackground;color:InfoText;border:1px solid #000;box-shadow:2px 2px 5px #AAA;-webkit-box-shadow:2px 2px 5px #AAA;-moz-box-shadow:2px 2px 5px #AAA;-khtml-box-shadow:2px 2px 5px #AAA;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true');padding:3px 4px;z-index:401;position:absolute;left:0;top:0;width:auto;height:auto;display:none}.MathJax{display:inline;font-style:normal;font-weight:400;line-height:normal;font-size:100%;font-size-adjust:none;text-indent:0;text-align:left;text-transform:none;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;direction:ltr;max-width:none;max-height:none;min-width:0;min-height:0;border:0;padding:0;margin:0}.MathJax a,.MathJax img,.MathJax nobr{border:0;padding:0;margin:0;max-width:5000em;max-height:5000em;min-width:0;min-height:0;vertical-align:0;line-height:normal;text-decoration:none}img.MathJax_strut{border:0!important;padding:0!important;margin:0!important;vertical-align:0!important}.MathJax span{display:inline;position:static;border:0;padding:0;margin:0;vertical-align:0;line-height:normal;text-decoration:none}.MathJax nobr{white-space:nowrap!important}.MathJax img{display:inline!important;float:none!important}.MathJax *{transition:none;-webkit-transition:none;-moz-transition:none;-ms-transition:none;-o-transition:none}.MathJax_Processing{visibility:hidden;position:fixed;width:0;height:0;overflow:hidden}.MathJax_Processed{display:none!important}.MathJax_ExBox{display:block!important;overflow:hidden;width:1px;height:60ex;min-height:0;max-height:none}.MathJax .MathJax_EmBox{display:block!important;overflow:hidden;width:1px;height:60em;min-height:0;max-height:none}.MathJax .MathJax_HitBox{cursor:text;background:#fff;opacity:0;filter:alpha(opacity=0)}#MathJax_Tooltip *,.MathJax .MathJax_HitBox *{filter:none;opacity:1;background:0 0}@font-face{font-family:MathJax_Main;src:url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?rev=2.4-beta-2) format('opentype')}@font-face{font-family:MathJax_Main;src:url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?rev=2.4-beta-2) format('woff'),url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?rev=2.4-beta-2) format('opentype');font-weight:700}@font-face{font-family:MathJax_Main;src:url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?rev=2.4-beta-2) format('woff'),url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?rev=2.4-beta-2) format('opentype');font-style:italic}@font-face{font-family:MathJax_Math;src:url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?rev=2.4-beta-2) format('woff'),url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?rev=2.4-beta-2) format('opentype');font-style:italic}@font-face{font-family:MathJax_Caligraphic;src:url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?rev=2.4-beta-2) format('opentype')}@font-face{font-family:MathJax_Size1;src:url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?rev=2.4-beta-2) format('opentype')}@font-face{font-family:MathJax_Size2;src:url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?rev=2.4-beta-2) format('opentype')}@font-face{font-family:MathJax_Size3;src:url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?rev=2.4-beta-2) format('opentype')}@font-face{font-family:MathJax_Size4;src:url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?rev=2.4-beta-2) format('opentype')}.MathJax .noError{font-size:90%;text-align:left;color:#000;padding:1px 3px;border:1px solid}@font-face{font-family:MathJax_AMS;src:url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///usr/share/haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf?rev=2.4-beta-2) format('opentype')}#mermaidChart0 .node{fill:#ffa;stroke:#666;stroke-width:3px}#mermaidChart0 .edgeLabel text,#mermaidChart0 .node text{fill:#000;stroke:none;font-weight:300;font-family:"Helvetica Neue",Helvetica,Arial,sans-serf;font-size:14px}.mermaid .label{color:#333}.node circle,.node polygon,.node rect{fill:#cde498;stroke:#13540c;stroke-width:1px}.edgePath .path{stroke:green;stroke-width:1.5px}.cluster rect{fill:#cdffb2;stroke:#6eaa49;stroke-width:1px}footer{position:fixed;font-size:.8em;text-align:right;bottom:0;margin-left:-25px;height:20px;width:100%}</style>
</head>
<body class="markdown solarized-light">
<h1 id="a-research-report-on-b-cnn-&amp;-matconvnet"><a name="a-research-report-on-b-cnn-&amp;-matconvnet" href="#a-research-report-on-b-cnn-&amp;-matconvnet"></a>A Research Report on B-CNN &amp; MatConvNet</h1><hr class="section"><pre><code data-origin="<pre><code>                            By 苏金成 @ Hikvision, Mail: jcsu14@fudan.edu.cn
                            Date: 2016.11.14 ~ 2016.12.20
</code></pre>">                            By 苏金成 @ Hikvision, Mail: jcsu14@fudan.edu.cn
                            Date: 2016.11.14 ~ 2016.12.20
</code></pre><hr class="section"><p class="toc" style="undefined"></p><ul>
<li><ul>
<li><span class="title">
<a href="#0-摘要" title="0 摘要">0 摘要</a>
</span>
<!--span class="number">
0
</span-->
</li>
<li><span class="title">
<a href="#1-引言" title="1 引言">1 引言</a>
</span>
<!--span class="number">
1
</span-->
<ul>
<li><ul>
<li><span class="title">
<a href="#1.1-背景" title="1.1 背景">1.1 背景</a>
</span>
<!--span class="number">
2
</span-->
</li>
<li><span class="title">
<a href="#1.2-相关工作" title="1.2 相关工作">1.2 相关工作</a>
</span>
<!--span class="number">
3
</span-->
</li>
<li><span class="title">
<a href="#1.3-参考文献" title="1.3 参考文献">1.3 参考文献</a>
</span>
<!--span class="number">
4
</span-->
</li>
<li><span class="title">
<a href="#1.4-术语" title="1.4 术语">1.4 术语</a>
</span>
<!--span class="number">
5
</span-->
</li>
</ul>
</li>
</ul>
</li>
<li><span class="title">
<a href="#2-b-cnn-模型-[1]" title="2 B-CNN 模型 [1]">2 B-CNN 模型 [1]</a>
</span>
<!--span class="number">
6
</span-->
<ul>
<li><ul>
<li><span class="title">
<a href="#2.1-b-cnn-概览" title="2.1 B-CNN 概览">2.1 B-CNN 概览</a>
</span>
<!--span class="number">
7
</span-->
</li>
<li><span class="title">
<a href="#2.2-**bilinear**-模型技术细节" title="2.2 Bilinear 模型技术细节">2.2 Bilinear 模型技术细节</a>
</span>
<!--span class="number">
8
</span-->
</li>
<li><span class="title">
<a href="#2.3-bilinear-cnn-模型" title="2.3 Bilinear-CNN 模型">2.3 Bilinear-CNN 模型</a>
</span>
<!--span class="number">
9
</span-->
</li>
<li><span class="title">
<a href="#2.4-梯度计算&amp;编程细节" title="2.4 梯度计算&amp;编程细节">2.4 梯度计算&amp;编程细节</a>
</span>
<!--span class="number">
10
</span-->
</li>
<li><span class="title">
<a href="#2.5-训练方法" title="2.5 训练方法">2.5 训练方法</a>
</span>
<!--span class="number">
11
</span-->
</li>
<li><span class="title">
<a href="#2.6-实验结果" title="2.6 实验结果">2.6 实验结果</a>
</span>
<!--span class="number">
12
</span-->
</li>
</ul>
</li>
</ul>
</li>
<li><span class="title">
<a href="#3.-b-cnn-模型复现&amp;评估" title="3. B-CNN 模型复现&amp;评估">3. B-CNN 模型复现&amp;评估</a>
</span>
<!--span class="number">
13
</span-->
<ul>
<li><ul>
<li><span class="title">
<a href="#3.1-b-cnn-模型复现情况" title="3.1 B-CNN 模型复现情况">3.1 B-CNN 模型复现情况</a>
</span>
<!--span class="number">
14
</span-->
</li>
<li><span class="title">
<a href="#3.2-b-cnn-模型在-`hikvision-car1000_data`-数据集上的表现" title="3.2 B-CNN 模型在 Hikvision car1000_data 数据集上的表现">3.2 B-CNN 模型在 Hikvision car1000_data 数据集上的表现</a>
</span>
<!--span class="number">
15
</span-->
</li>
</ul>
</li>
</ul>
</li>
<li><span class="title">
<a href="#4-反思" title="4 反思">4 反思</a>
</span>
<!--span class="number">
16
</span-->
<ul>
<li><ul>
<li><span class="title">
<a href="#4.1-直观解释(intuition)" title="4.1 直观解释(intuition)">4.1 直观解释(intuition)</a>
</span>
<!--span class="number">
17
</span-->
</li>
<li><span class="title">
<a href="#4.2-从训练的过程看双线性模型" title="4.2 从训练的过程看双线性模型">4.2 从训练的过程看双线性模型</a>
</span>
<!--span class="number">
18
</span-->
</li>
<li><span class="title">
<a href="#4.3-对称双线性模型(symmetric-bilinear-model)跟方差有什么关系？" title="4.3 对称双线性模型(symmetric bilinear model)跟方差有什么关系？">4.3 对称双线性模型(symmetric bilinear model)跟方差有什么关系？</a>
</span>
<!--span class="number">
19
</span-->
</li>
<li><span class="title">
<a href="#4.4-双线性模型参数复杂度" title="4.4 双线性模型参数复杂度">4.4 双线性模型参数复杂度</a>
</span>
<!--span class="number">
20
</span-->
</li>
</ul>
</li>
</ul>
</li>
<li><span class="title">
<a href="#5-总结与展望" title="5 总结与展望">5 总结与展望</a>
</span>
<!--span class="number">
21
</span-->
<ul>
<li><ul>
<li><span class="title">
<a href="#5.1-总结" title="5.1 总结">5.1 总结</a>
</span>
<!--span class="number">
22
</span-->
</li>
<li><span class="title">
<a href="#5.2-展望" title="5.2 展望">5.2 展望</a>
</span>
<!--span class="number">
23
</span-->
</li>
</ul>
</li>
</ul>
</li>
<li><span class="title">
<a href="#附录-1-matconvnet-介绍" title="附录-1 MatConvNet 介绍">附录-1 MatConvNet 介绍</a>
</span>
<!--span class="number">
24
</span-->
</li>
<li><span class="title">
<a href="#附录-2-b-cnn-实验平台搭建" title="附录-2 B-CNN 实验平台搭建">附录-2 B-CNN 实验平台搭建</a>
</span>
<!--span class="number">
25
</span-->
</li>
<li><span class="title">
<a href="#附录-3-带-b-cnn-飞起来" title="附录-3 带 B-CNN 飞起来">附录-3 带 B-CNN 飞起来</a>
</span>
<!--span class="number">
26
</span-->
<ul>
<li><ul>
<li><span class="title">
<a href="#1.-让-run_experiments_bcnn_train-跑起来" title="1. 让 run_experiments_bcnn_train 跑起来">1. 让 run_experiments_bcnn_train 跑起来</a>
</span>
<!--span class="number">
27
</span-->
</li>
<li><span class="title">
<a href="#2.-解决源代码自带-bug-的过程" title="2. 解决源代码自带 Bug 的过程">2. 解决源代码自带 Bug 的过程</a>
</span>
<!--span class="number">
28
</span-->
</li>
</ul>
</li>
</ul>
</li>
<li><span class="title">
<a href="#附录-4-深入-b-cnn-源码" title="附录-4 深入 B-CNN 源码">附录-4 深入 B-CNN 源码</a>
</span>
<!--span class="number">
29
</span-->
<ul>
<li><ul>
<li><span class="title">
<a href="#1.-having-a-quick-overview." title="1. Having a quick overview.">1. Having a quick overview.</a>
</span>
<!--span class="number">
30
</span-->
</li>
<li><span class="title">
<a href="#2.-analysizing-some-typical-functions-in-`bcnn-package`-which-implement-layers-of-a-`b-cnn`-model." title="2. Analysizing some typical functions in bcnn-package which implement layers of a B-CNN model.">2. Analysizing some typical functions in bcnn-package which implement layers of a B-CNN model.</a>
</span>
<!--span class="number">
31
</span-->
</li>
<li><span class="title">
<a href="#3.-looking-into-the-code-of-preparing-dataset." title="3. Looking into the code of preparing dataset.">3. Looking into the code of preparing dataset.</a>
</span>
<!--span class="number">
32
</span-->
</li>
<li><span class="title">
<a href="#4.-inspecting-the-code-of-building-up-a-b-cnn-model." title="4. Inspecting the code of building up a B-CNN model.">4. Inspecting the code of building up a B-CNN model.</a>
</span>
<!--span class="number">
33
</span-->
</li>
<li><span class="title">
<a href="#5.-analysizing-the-code-of-training-step-1." title="5. Analysizing the code of training step 1.">5. Analysizing the code of training step 1.</a>
</span>
<!--span class="number">
34
</span-->
</li>
<li><span class="title">
<a href="#6.-the-code-of-training-step-2." title="6. The code of training step 2.">6. The code of training step 2.</a>
</span>
<!--span class="number">
35
</span-->
</li>
<li><span class="title">
<a href="#7.-additional-training-step." title="7. Additional training step.">7. Additional training step.</a>
</span>
<!--span class="number">
36
</span-->
</li>
<li><span class="title">
<a href="#8.-miscellaneous" title="8. Miscellaneous">8. Miscellaneous</a>
</span>
<!--span class="number">
37
</span-->
</li>
</ul>
</li>
</ul>
</li>
<li><span class="title">
<a href="#附录-5-修改-b-cnn，尝试改进" title="附录-5 修改 B-CNN，尝试改进">附录-5 修改 B-CNN，尝试改进</a>
</span>
<!--span class="number">
38
</span-->
<ul>
<li><ul>
<li><span class="title">
<a href="#5.1-motivation." title="5.1 Motivation.">5.1 Motivation.</a>
</span>
<!--span class="number">
39
</span-->
</li>
<li><span class="title">
<a href="#5.2-revised-bilinear-model." title="5.2 Revised bilinear model.">5.2 Revised bilinear model.</a>
</span>
<!--span class="number">
40
</span-->
</li>
<li><span class="title">
<a href="#5.3-application" title="5.3 Application">5.3 Application</a>
</span>
<!--span class="number">
41
</span-->
</li>
<li><span class="title">
<a href="#5.4-add-a-self-defined-layer-`vl_weightedbilinearpool`-to-`matconvnet`" title="5.4 Add a self-defined layer vl_weightedbilinearpool to matconvnet">5.4 Add a self-defined layer vl_weightedbilinearpool to matconvnet</a>
</span>
<!--span class="number">
42
</span-->
</li>
<li><span class="title">
<a href="#5.5-build-our-`wb-cnn`-model-for-training." title="5.5 Build our WB-CNN model for training.">5.5 Build our WB-CNN model for training.</a>
</span>
<!--span class="number">
43
</span-->
</li>
<li><span class="title">
<a href="#5.6-experimental-results." title="5.6 Experimental results.">5.6 Experimental results.</a>
</span>
<!--span class="number">
44
</span-->
</li>
<li><span class="title">
<a href="#5.7-other-variations-of-revision" title="5.7 Other variations of revision">5.7 Other variations of revision</a>
</span>
<!--span class="number">
45
</span-->
</li>
<li><span class="title">
<a href="#5.7-conclusion" title="5.7 Conclusion">5.7 Conclusion</a>
</span>
<!--span class="number">
46
</span-->
</li>
</ul>
</li>
</ul>
</li>
<li><span class="title">
<a href="#附录-6-深入探究-bilinear-与-covariance-的关系-(2016-12-25,-sunday@-fudan-library,-zhang-jiang)" title="附录-6 深入探究 Bilinear 与 Covariance 的关系 (2016-12-25, Sunday@ Fudan Library, Zhang Jiang)">附录-6 深入探究 Bilinear 与 Covariance 的关系 (2016-12-25, Sunday@ Fudan Library, Zhang Jiang)</a>
</span>
<!--span class="number">
47
</span-->
</li>
<li><span class="title">
<a href="#附录-7-bovw,-fisher-vector-和-vlad-简介" title="附录-7 BoVW, Fisher Vector 和 VLAD 简介">附录-7 BoVW, Fisher Vector 和 VLAD 简介</a>
</span>
<!--span class="number">
48
</span-->
<ul>
<li><ul>
<li><span class="title">
<a href="#7.1-bovw-(bag-of-visual-word-[6])" title="7.1 BoVW (bag-of-visual-word [6])">7.1 BoVW (bag-of-visual-word [6])</a>
</span>
<!--span class="number">
49
</span-->
</li>
<li><span class="title">
<a href="#7.2-fv-(fisher-vector-[12])" title="7.2 FV (Fisher Vector [12])">7.2 FV (Fisher Vector [12])</a>
</span>
<!--span class="number">
50
</span-->
<ul>
<li><span class="title">
<a href="#7.2.1-fisher-vector" title="7.2.1 Fisher Vector">7.2.1 Fisher Vector</a>
</span>
<!--span class="number">
51
</span-->
</li>
<li><span class="title">
<a href="#7.2.2-深入理解-fisher-information-matrix-(fim)" title="7.2.2 深入理解 Fisher Information Matrix (FIM)">7.2.2 深入理解 Fisher Information Matrix (FIM)</a>
</span>
<!--span class="number">
52
</span-->
</li>
<li><span class="title">
<a href="#7.2.3-fisher-vector-应用于图像分类" title="7.2.3 Fisher Vector 应用于图像分类">7.2.3 Fisher Vector 应用于图像分类</a>
</span>
<!--span class="number">
53
</span-->
</li>
</ul>
</li>
<li><span class="title">
<a href="#7.3-vlad-(vector-of-locally-aggregated-descriptor-[13])" title="7.3 VLAD (vector of locally aggregated descriptor [13])">7.3 VLAD (vector of locally aggregated descriptor [13])</a>
</span>
<!--span class="number">
54
</span-->
</li>
<li><span class="title">
<a href="#7.4-bov,-fv-和-vlad-的关系" title="7.4 BoV, FV 和 VLAD 的关系">7.4 BoV, FV 和 VLAD 的关系</a>
</span>
<!--span class="number">
55
</span-->
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>

</ul>
<p></p><div style="text-align:center"><img src="images/bcnn.png" align="middle"></div><h2 id="0-摘要"><a name="0-摘要" href="#0-摘要"></a>0 摘要</h2><p>本文是针对 Tsung-Yu Lin 在 <em>ICCV2015</em> 上发表的 <em>Bilinear CNN Models for Fine-Grained Visual Recognition</em> 的一个调研报告. 本次调研主要完成的工作:</p><ol>
<li>对文章的技术细节, 涉及的数学公式进行了推导和分析.</li><li>在<code>CUB-100-2011</code>数据集上, 成功复现模型B-CNN[M,M], B-CNN[D,D] 和 B-CNN[M,D].</li><li>评估了B-CNN模型在<code>Hikvision car1000_data</code>数据集上的性能(待结果).</li><li>对 B-CNN 模型进行了多个维度的思考.</li><li>对源代码进行了深入的剖析 (见附录).</li><li>对 MatConvNet 深度学习框架进行了学习 (见附录).</li><li>成功往 MatConvNet 中加入自定义网络层 (见附录)</li><li>尝试对 B-CNN 模型进行了一些小改进, 效果不明显 (见附录).</li><li>深入分析了论文中对称双线性模型(symmetric bilinear model) 和 方差的关系(见附录, 待实验结果).</li><li>学习并总结了图像细分类领域的相关技术(BoVW, Fisher Vector, 和 VLAD) (见附录.</li></ol><h2 id="1-引言"><a name="1-引言" href="#1-引言"></a>1 引言</h2><h4 id="1.1-背景"><a name="1.1-背景" href="#1.1-背景"></a>1.1 背景</h4><p>目前，应用于物体细分类任务的计算机视觉技术大概可以分为两大类: <code>part-based</code> 模型和 <code>holistic</code>(整体)模型.</p><p><code>part-based</code> 模型通过定位物体的各个部分(localize parts)，并从中提取出特征来刻画图像(constructing image representation)，从而消除了位置、姿势和视角变化的影响，提高了分类的性能. 这些物体的部位通常是手动进行定位.</p><p><code>holistic</code> 模型则直接刻画整幅图像. 这些方法包括 BoVW (bag-of-visual-word), FV (fisher vector) 和 VLAD (vector-of-locally-aggregated), 还有一些基于CNN的方法.</p><p><code>part-based</code> 模型通常更准确，在数据有限的情况下泛化(generalize)能力更强， 缺点是需要手动进行 part 标注. </p><p><code>holistic</code> 模型通常是先提取图像的SIFT特征 [5]，然后用 BoVW, FV 或者 VLAD 的方式对这些SIFT特征进行编码，不需要part标注. 由于 SIFT 特征对光照、位置、视角和姿势等的变化具有较强的抵御能力，所构造的图像表示(image representation)也具有较强的鲁棒性(Robustness). Cimpoi M. 等人将 SIFT 特征替换为从在<strong>ImageNet</strong>预训练好的深度网络的卷积层提取的特征，在多个分类人物上取得了state-of-the-art (2009). 然而这些模型的性能仍然没有 <code>part-based</code> 模型的好.</p><p>这篇文章提出了 bilinear CNN 模型，该模型利用在<strong>ImageNet</strong>预训练好的深度网络的卷积网络进行特征提取，然后进行双线性编码，取得了state-of-the-art(2015, 2016).</p><h4 id="1.2-相关工作"><a name="1.2-相关工作" href="#1.2-相关工作"></a>1.2 相关工作</h4><p>从纵向看，双线性模型最初是被 Tanenbaum 和 Freeman [2]于2000年提出的，用来对两个因子之间的相互作用进行建模，比如字体的风格(style) 和内容(content)之间的相互作用. M. Alex O 等人对此进行扩展，于 2002 年提出了多线性模型[3]，用于对人脸进行建模，提出了 TensorFace. 基于双线性模型，H. Perronnin等人于2009年提出了双线性分类器[4]，该方法直接对SVM分类器的目标函数进行双线性改造，从而得到了双线性分类器.</p><p>从横向看，用于物体细分类任务的模型有 part-based [16, 17, 18, 19]， BoVW [6, 7, 8], FV [9, 10, 11, 12] 和 VLAD [13, 14]等.</p><h4 id="1.3-参考文献"><a name="1.3-参考文献" href="#1.3-参考文献"></a>1.3 参考文献</h4><p>[1] [<strong>B-CNN</strong>] Lin T Y, Roychowdhury A, Maji S. Bilinear CNN Models for Fine-Grained Visual Recognition[C]. <em>IEEE International Conference on Computer Vision</em>. IEEE, 2015:1449-1457.<br>[2] [<strong>Bilinear</strong>] Tenenbaum J B, Freeman W T. Separating Style and Content with Bilinear Models[J]. <em>Neural Computation</em>, 2000, 12(6):1247-1283.<br>[3] [<strong>Mutilinear</strong>] Vasilescu M A O, Terzopoulos D. Multilinear Analysis of Image Ensembles: TensorFaces[J]. <em>Lecture Notes in Computer Science</em>, 2002, 2350:447—460.<br>[4] [<strong>BilinearClassifier</strong>] Pirsiavash H, Ramanan D, Fowlkes C. Bilinear classifiers for visual recognition[C]. In <em>NIPS</em> 2009:1482-1490.<br>[5] [<strong>SIFT</strong>] Lowe D G, Lowe D G. Distinctive Image Features from Scale-Invariant Keypoints[J]. International Journal of Computer Vision, 2004, 60(2):91-110.<br>[6] [<strong>BoVW</strong>] Csurka G, Dance C R, Fan L, et al. Visual categorization with bags of keypoints[J]. Workshop on Statistical Learning in Computer Vision Eccv, 2004:1—22.<br>[7] [<strong>BoVW</strong>] Farquhar J D R, Szedmak S, Meng H, et al. Improving “bag-of-keypoints” image categorisation: Generative Models and PDF-Kernels[J]. University of Southampton, 2005, 68(s 3–4):673-683.<br>[8] [<strong>BoVW</strong>] Perronnin F, Dance C, Csurka G, et al. Adapted vocabularies for generic visual categorization[C]// Computer Vision - ECCV 2006, European Conference on Computer Vision, Graz, Austria, May 7-13, 2006, Proceedings. 2006:464-475.<br>[9] [<strong>FV</strong>] Perronnin F, Dance C. Fisher Kernels on Visual Vocabularies for Image Categorization[J]. 2007:1-8.<br>[10] [<strong>FV</strong>] Perronnin F, Sánchez J, Mensink T. Improving the Fisher Kernel for Large-Scale Image Classification[C]// Computer Vision - ECCV 2010, European Conference on Computer Vision, Heraklion, Crete, Greece, September 5-11, 2010, Proceedings. 2010:119-133.<br>[11] [<strong>FV</strong>] Sanchez J, Perronnin F. High-dimensional signature compression for large-scale image classification[J]. 2011, 42(7):1665-1672.<br>[12] [<strong>FV</strong>]Sánchez J, Perronnin F, Mensink T, et al. Image Classification with the Fisher Vector: Theory and Practice[J]. International Journal of Computer Vision, 2013, 105(3):222-245.<br>[13] [<strong>VLAD</strong>] Jegou H, Douze M, Schmid C, et al. Aggregating local descriptors into a compact image representation[J]. 2010, 238(6):3304-3311.<br>[14] [<strong>netVLAD</strong>] Arandjelović R, Gronat P, Torii A, et al. NetVLAD: CNN architecture for weakly supervised place recognition[J]. Computer Science, 2016.<br>[15] [<strong>DeepFilterBanks</strong>] Cimpoi M. Deep filter banks for texture recognition and segmentation[J]. International Journal of Computer Vision, 2016, 118(1):65-94.<br>[16] [<strong>part-based</strong>] Bourdev L, Maji S, Malik J. Describing People: A Poselet-Based Approach to Attribute Classification ∗[C]. IEEE International Conference on Computer Vision. IEEE, 2011:1543-1550.<br>[17] [<strong>part-based</strong>] Zhang N, Farrell R, Darrell T. Pose pooling kernels for sub-category recognition[J]. 2012, 157(10):3665-3672.<br>[18] [<strong>part-based</strong>] Branson S, Horn G V, Belongie S, et al. Bird Species Categorization Using Pose Normalized Deep Convolutional Nets[J]. Eprint Arxiv, 2014.<br>[19] [<strong>part-based</strong>] Zhang N, Donahue J, Girshick R, et al. Part-Based R-CNNs for Fine-Grained Category Detection[J]. 2014, 8689:834-849.<br>[20] [<strong>M-Net</strong>] Chatfield K, Simonyan K, Vedaldi A, et al. Return of the Devil in the Details: Delving Deep into Convolutional Nets[J]. Computer Science, 2014.<br>[21] [<strong>D-Net</strong>] Simonyan K, Zisserman A. Very Deep Convolutional Networks for Large-Scale Image Recognition[J]. Computer Science, 2014.<br>[22] Gao Y, Beijbom O, Zhang N, et al. Compact Bilinear Pooling[J]. CVPR 2016.</p><h4 id="1.4-术语"><a name="1.4-术语" href="#1.4-术语"></a>1.4 术语</h4><p>图像表示 (<em>image representation</em>)<br>鲁棒性 (<em>Robustness</em>)<br>双线性卷积网络 (<em>Bilinear-CNN or B-CNN</em>)<br>双线性模型 (<em>Bilinear model</em>)<br>双线性特征 (<em>Bilinear feature</em>)<br>双线性向量 (<em>Bilinear vector</em>)<br>双线性编码 (<em>Bilinear encoding</em>)<br>池化双线性 (<em>Bilinear-pool</em>)<br>特征提取器 (<em>feature extractor</em>)<br>平方根标准化 (<em>square root normalization</em>)<br>2-范数标准化 (<em><span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-1" style="width: 1.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.328em 1000em 2.5em -0.454em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="msubsup" id="MathJax-Span-3"><span style="display: inline-block; position: relative; width: 0.785em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.454em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-4" style="font-family: MathJax_Math; font-style: italic;">l</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.328em;"><span class="mn" id="MathJax-Span-5" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.163em; vertical-align: -0.25em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">l_2</script></span> normalization</em>)<br>全共享 (<em>fully-shared</em>)<br>部分共享 (<em>partially-shared</em>)<br>四元组 (<em>Quadruple</em>)<br>特征图 (<em>feature map</em>)<br>细调 (<em>fine-tuning</em>)<br>截断卷积网 (<em>truncated CNN</em>)<br>下采样 (<em>downsampling</em>)</p><h2 id="2-b-cnn-模型-[1]"><a name="2-b-cnn-模型-[1]" href="#2-b-cnn-模型-[1]"></a>2 B-CNN 模型 [1]</h2><h4 id="2.1-b-cnn-概览"><a name="2.1-b-cnn-概览" href="#2.1-b-cnn-概览"></a>2.1 B-CNN 概览</h4><p>B-CNN (<em>Bilinear-CNN</em>) 模型将从两个特征提取器 (<em>feature extractor</em>) 提取所得的特征按位置作外积 (<em>outer product at each location</em>)， 然后将所有位置的外积累加起来，这个累加过程称为 <strong>sum-pooling</strong> 操作. <strong>sum-pooling</strong> 的结果被 <strong>reshape</strong> 成为一个向量，然后依次进行平方根标准化 (<em>square root normalization</em>) 和<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-2-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-6" style="width: 1.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.328em 1000em 2.5em -0.454em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-7"><span class="msubsup" id="MathJax-Span-8"><span style="display: inline-block; position: relative; width: 0.785em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.454em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Math; font-style: italic;">l</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.328em;"><span class="mn" id="MathJax-Span-10" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.163em; vertical-align: -0.25em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">l_2</script></span> 标准化 (<em><span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11" style="width: 1.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.328em 1000em 2.5em -0.454em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-12"><span class="msubsup" id="MathJax-Span-13"><span style="display: inline-block; position: relative; width: 0.785em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.454em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-14" style="font-family: MathJax_Math; font-style: italic;">l</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.328em;"><span class="mn" id="MathJax-Span-15" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.163em; vertical-align: -0.25em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">l_2</script></span> normalization</em>). 标准化后的向量称为双线性 (<em>bilinear feature</em>). 最后再针对这些双线性特征训练一个 <strong>softmax</strong> 分类器或者一组线性SVM分类器进行分类。因此一个 <strong>B-CNN</strong> 模型由三个部分组成：特征提取器、双线性编码和分类器。</p><p>两个特征提取器通常采用在 <strong>ImageNet</strong> 数据集上训练好的模型，并在最后一个卷积层之后截断并丢弃后面的结构。这两个模型可以是全部共享 (<em>fully-shared</em>), 部分共享 (<em>partially-shared</em>) 或者 无共享(<em>no sharing</em>).</p><p>B-CNN 模型<strong>训练过程只需要类别标签 (category labels)</strong>，在多个数据集(<a href="http://www.vision.caltech.edu/visipedia/CUB-200-2011.html"><code>CUB-200-2011 dataset</code></a>, <a href="http://www.robots.ox.ac.uk/~vgg/data/oid/"><code>FGVC aircraft dataset</code></a>, 和 <a href="http://ai.stanford.edu/~jkrause/cars/car_dataset.html"><code>Stanford cars dataset</code></a>) 上达到了 <strong>state-of-the-art</strong> (2015).</p><h4 id="2.2-**bilinear**-模型技术细节"><a name="2.2-**bilinear**-模型技术细节" href="#2.2-**bilinear**-模型技术细节"></a>2.2 <strong>Bilinear</strong> 模型技术细节</h4><p>一个用于图像分类的双线性模型被定义为一个四元组<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-16" style="width: 1.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.929em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.863em 1000em 2.918em -0.492em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-17"><span class="mtext" id="MathJax-Span-18" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-19"><span class="mrow" id="MathJax-Span-20"><span class="mi" id="MathJax-Span-21" style="font-family: MathJax_Caligraphic;">B<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.02em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">~\mathcal{B}</script></span>:</p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-5-Frame"><nobr><span class="math" id="MathJax-Span-22" style="width: 9.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.978em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.46em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-23"><span class="texatom" id="MathJax-Span-24"><span class="mrow" id="MathJax-Span-25"><span class="mi" id="MathJax-Span-26" style="font-family: MathJax_Caligraphic;">B<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-27" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-28" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="msubsup" id="MathJax-Span-29"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.883em -0.437em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-30" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2em; left: 0.541em;"><span class="mi" id="MathJax-Span-31" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-32" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-33" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.883em -0.437em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-34" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2em; left: 0.541em;"><span class="mi" id="MathJax-Span-35" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">B</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-36" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-37" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-38"><span class="mi" id="MathJax-Span-39" style="font-family: MathJax_Caligraphic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.037em;"></span></span></span></span><span class="mo" id="MathJax-Span-40" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-41" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-42"><span class="mi" id="MathJax-Span-43" style="font-family: MathJax_Caligraphic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span></span><span class="mo" id="MathJax-Span-44" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-45" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-5">\mathcal{B} = (f_A, f_B, \mathcal{P}, \mathcal{C}).</script><p></p><p>其中，</p><ul>
<li><p><span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-46" style="width: 3.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.787em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.863em 1000em 3.137em -0.437em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-47"><span class="msubsup" id="MathJax-Span-48"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.883em -0.437em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-49" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2em; left: 0.541em;"><span class="mi" id="MathJax-Span-50" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-51" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-52" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.883em -0.437em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-53" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2em; left: 0.541em;"><span class="mi" id="MathJax-Span-54" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">B</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.287em; vertical-align: -0.36em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">f_A, f_B</script></span> 是特征提取函数 (feature extractor function): <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-55" style="width: 9.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.923em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.676em 1000em 3.101em -0.437em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-56"><span class="mi" id="MathJax-Span-57" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-58" style="font-family: MathJax_Main; padding-left: 0.278em;">:</span><span class="texatom" id="MathJax-Span-59" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-60"><span class="mi" id="MathJax-Span-61" style="font-family: MathJax_Caligraphic;">L</span></span></span><span class="mo" id="MathJax-Span-62" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="texatom" id="MathJax-Span-63" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-64"><span class="mi" id="MathJax-Span-65" style="font-family: MathJax_Caligraphic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.097em;"></span></span></span></span><span class="mo" id="MathJax-Span-66" style="font-family: MathJax_Main; padding-left: 0.278em;">→</span><span class="msubsup" id="MathJax-Span-67" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 2.425em; height: 0px;"><span style="position: absolute; clip: rect(1.722em 1000em 2.754em -0.473em); top: -2.568em; left: 0em;"><span class="texatom" id="MathJax-Span-68"><span class="mrow" id="MathJax-Span-69"><span class="mi" id="MathJax-Span-70" style="font-family: MathJax_Caligraphic;">R</span></span></span><span style="display: inline-block; width: 0px; height: 2.568em;"></span></span><span style="position: absolute; top: -2.704em; left: 0.874em;"><span class="texatom" id="MathJax-Span-71"><span class="mrow" id="MathJax-Span-72"><span class="mi" id="MathJax-Span-73" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span class="mo" id="MathJax-Span-74" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-75" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">D</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.472em; vertical-align: -0.317em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">f: \mathcal{L}\times\mathcal{I} \rightarrow \mathcal{R}^{c\times D}</script></span>, 其中，</p>
<ul>
<li><span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-8-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-76" style="width: 0.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.656em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.721em 1000em 2.732em -0.522em); top: -2.568em; left: 0em;"><span class="mrow" id="MathJax-Span-77"><span class="texatom" id="MathJax-Span-78"><span class="mrow" id="MathJax-Span-79"><span class="mi" id="MathJax-Span-80" style="font-family: MathJax_Caligraphic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.097em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.568em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8">\mathcal{I}</script></span>: 可以是输入图像,</li><li><span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-9-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-81" style="width: 0.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.71em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.699em 1000em 2.754em -0.46em); top: -2.568em; left: 0em;"><span class="mrow" id="MathJax-Span-82"><span class="texatom" id="MathJax-Span-83"><span class="mrow" id="MathJax-Span-84"><span class="mi" id="MathJax-Span-85" style="font-family: MathJax_Caligraphic;">L</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.568em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.02em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">\mathcal{L}</script></span>: 可以是一组位置 (location),</li><li><span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-10-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-86" style="width: 1.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.874em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.722em 1000em 2.754em -0.473em); top: -2.568em; left: 0em;"><span class="mrow" id="MathJax-Span-87"><span class="texatom" id="MathJax-Span-88"><span class="mrow" id="MathJax-Span-89"><span class="mi" id="MathJax-Span-90" style="font-family: MathJax_Caligraphic;">R</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.568em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.992em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">\mathcal{R}</script></span>: 可以是一组大小为 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-11-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-91" style="width: 3.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.514em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.885em 1000em 2.907em -0.458em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-92"><span class="mi" id="MathJax-Span-93" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mo" id="MathJax-Span-94" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mi" id="MathJax-Span-95" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">D</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.98em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">c\times D</script></span> 的特征,</li></ul>
</li><li><p><span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-12-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-96" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.721em 1000em 2.789em -0.473em); top: -2.568em; left: 0em;"><span class="mrow" id="MathJax-Span-97"><span class="texatom" id="MathJax-Span-98"><span class="mrow" id="MathJax-Span-99"><span class="mi" id="MathJax-Span-100" style="font-family: MathJax_Caligraphic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.037em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.568em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.036em; vertical-align: -0.136em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">\mathcal{P}</script></span> 是池化函数 (pooling function),</p>
</li><li><span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-13-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-101" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.699em 1000em 2.757em -0.48em); top: -2.568em; left: 0em;"><span class="mrow" id="MathJax-Span-102"><span class="texatom" id="MathJax-Span-103"><span class="mrow" id="MathJax-Span-104"><span class="mi" id="MathJax-Span-105" style="font-family: MathJax_Caligraphic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.568em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.024em; vertical-align: -0.097em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">\mathcal{C}</script></span> is 是分类函数 (classification function).</li></ul><p>将特征提取函数得到的输出在每一个位置上作外积得到双线性特征 (<em>bilinear feature</em>), 即特征 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-14-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-106" style="width: 1.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.317em 1000em 2.59em -0.437em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-107"><span class="msubsup" id="MathJax-Span-108"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.883em -0.437em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-109" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2em; left: 0.541em;"><span class="mi" id="MathJax-Span-110" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.287em; vertical-align: -0.36em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-14">f_A</script></span> 和 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-15-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-111" style="width: 1.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.317em 1000em 2.59em -0.437em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-112"><span class="msubsup" id="MathJax-Span-113"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.883em -0.437em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-114" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2em; left: 0.541em;"><span class="mi" id="MathJax-Span-115" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">B</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.287em; vertical-align: -0.36em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">f_B</script></span> 在位置 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-16-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-116" style="width: 0.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.328em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.454em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-117"><span class="mi" id="MathJax-Span-118" style="font-family: MathJax_Math; font-style: italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-16">l</script></span> 的双线性特征由下式给出：</p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-17-Frame"><nobr><span class="math" id="MathJax-Span-119" style="width: 21.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.705em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.613em 1000em 3.146em -0.452em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-120"><span class="mi" id="MathJax-Span-121" style="font-family: MathJax_Math; font-style: italic;">b</span><span class="mi" id="MathJax-Span-122" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-123" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-124" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-125" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-126" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-127" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-128" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mo" id="MathJax-Span-129" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-130" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-131" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-132" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-133"><span class="mi" id="MathJax-Span-134" style="font-family: MathJax_Caligraphic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.097em;"></span></span></span></span><span class="mo" id="MathJax-Span-135" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-136" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.883em -0.437em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-137" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2em; left: 0.541em;"><span class="mi" id="MathJax-Span-138" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-139" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-140" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.883em -0.437em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-141" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2em; left: 0.541em;"><span class="mi" id="MathJax-Span-142" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">B</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-143" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-144" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-145" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.883em -0.437em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-146" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2em; left: 0.541em;"><span class="mi" id="MathJax-Span-147" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-148" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-149" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-150" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-151" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-152"><span class="mi" id="MathJax-Span-153" style="font-family: MathJax_Caligraphic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.097em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-154"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-155" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-156" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-157"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.883em -0.437em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-158" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2em; left: 0.541em;"><span class="mi" id="MathJax-Span-159" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">B</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-160" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-161" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-162" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-163" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-164"><span class="mi" id="MathJax-Span-165" style="font-family: MathJax_Caligraphic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.097em;"></span></span></span></span><span class="mo" id="MathJax-Span-166" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-167" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.604em; vertical-align: -0.372em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-17">bilinear(l, \mathcal{I}, f_A, f_B) = f_A(l, \mathcal{I})^Tf_B(l, \mathcal{I}).</script><p></p><p>其中，<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-18-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-168" style="width: 4.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.333em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-169"><span class="msubsup" id="MathJax-Span-170"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.883em -0.437em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-171" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2em; left: 0.541em;"><span class="mi" id="MathJax-Span-172" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-173" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-174" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-175" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-176" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-177"><span class="mi" id="MathJax-Span-178" style="font-family: MathJax_Caligraphic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.097em;"></span></span></span></span><span class="mo" id="MathJax-Span-179" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-18">f_A(l, \mathcal{I})</script></span> 和 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-19-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-180" style="width: 4.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.333em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-181"><span class="msubsup" id="MathJax-Span-182"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.883em -0.437em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-183" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2em; left: 0.541em;"><span class="mi" id="MathJax-Span-184" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">B</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-185" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-186" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-187" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-188" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-189"><span class="mi" id="MathJax-Span-190" style="font-family: MathJax_Caligraphic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.097em;"></span></span></span></span><span class="mo" id="MathJax-Span-191" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-19">f_B(l, \mathcal{I})</script></span> 必须具有相同的特征维度<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-20-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-192" style="width: 0.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.437em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.458em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-193"><span class="mi" id="MathJax-Span-194" style="font-family: MathJax_Math; font-style: italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.686em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-20">c</script></span>，所得 <strong>bilinear feature</strong> 的大小为 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-195" style="width: 2.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.131em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.077em 1000em 2.907em -0.458em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-196"><span class="mi" id="MathJax-Span-197" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mo" id="MathJax-Span-198" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mi" id="MathJax-Span-199" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">c</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.746em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21">c\times c</script></span>.</p><p>紧接外积之后就是池化函数 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-200" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.721em 1000em 2.789em -0.473em); top: -2.568em; left: 0em;"><span class="mrow" id="MathJax-Span-201"><span class="texatom" id="MathJax-Span-202"><span class="mrow" id="MathJax-Span-203"><span class="mi" id="MathJax-Span-204" style="font-family: MathJax_Caligraphic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.037em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.568em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.036em; vertical-align: -0.136em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22">\mathcal{P}</script></span>，在双线性模型中，该池化函数定义为将所有位置<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-23-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-205" style="width: 2.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.24em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.863em 1000em 2.936em -0.454em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-206"><span class="mi" id="MathJax-Span-207" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-208" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="texatom" id="MathJax-Span-209" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-210"><span class="mi" id="MathJax-Span-211" style="font-family: MathJax_Caligraphic;">L</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.042em; vertical-align: -0.115em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-23">l\in\mathcal{L}</script></span>上的 <strong>bilinear feature</strong> 进行累加，即 <strong>sum-pooling</strong>:</p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-24-Frame"><nobr><span class="math" id="MathJax-Span-212" style="width: 19.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.175em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.618em 1000em 4.14em -0.473em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-213"><span class="texatom" id="MathJax-Span-214"><span class="mrow" id="MathJax-Span-215"><span class="mi" id="MathJax-Span-216" style="font-family: MathJax_Caligraphic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.037em;"></span></span></span></span><span class="mo" id="MathJax-Span-217" style="font-family: MathJax_Main; padding-left: 0.278em;">:</span><span class="mtext" id="MathJax-Span-218" style="font-family: MathJax_Main; padding-left: 0.278em;">&nbsp;</span><span class="mtext" id="MathJax-Span-219" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-220" style="font-family: MathJax_Math; font-style: italic;">ϕ</span><span class="mo" id="MathJax-Span-221" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-222"><span class="mrow" id="MathJax-Span-223"><span class="mi" id="MathJax-Span-224" style="font-family: MathJax_Caligraphic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.097em;"></span></span></span></span><span class="mo" id="MathJax-Span-225" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-226" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="munderover" id="MathJax-Span-227" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.475em; height: 0px;"><span style="position: absolute; clip: rect(2.657em 1000em 4.384em -0.437em); top: -3.77em; left: 0em;"><span class="mo" id="MathJax-Span-228" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.77em;"></span></span><span style="position: absolute; clip: rect(1.633em 1000em 2.587em -0.465em); top: -1.18em; left: 0.137em;"><span class="texatom" id="MathJax-Span-229"><span class="mrow" id="MathJax-Span-230"><span class="mi" id="MathJax-Span-231" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-232" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-233"><span class="mrow" id="MathJax-Span-234"><span class="mi" id="MathJax-Span-235" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">L</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mi" id="MathJax-Span-236" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">b</span><span class="mi" id="MathJax-Span-237" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-238" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-239" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-240" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-241" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-242" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-243" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mo" id="MathJax-Span-244" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-245" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-246" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-247" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-248"><span class="mi" id="MathJax-Span-249" style="font-family: MathJax_Caligraphic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.097em;"></span></span></span></span><span class="mo" id="MathJax-Span-250" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-251" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.883em -0.437em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-252" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2em; left: 0.541em;"><span class="mi" id="MathJax-Span-253" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-254" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-255" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.883em -0.437em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-256" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2em; left: 0.541em;"><span class="mi" id="MathJax-Span-257" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">B</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-258" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-259" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.809em; vertical-align: -1.584em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-24">\mathcal{P}:~~\phi(\mathcal{I}) = \sum_{l\in \mathcal{L}}bilinear(l, \mathcal{I}, f_A, f_B).</script><p></p><p>然后 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-25-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-260" style="width: 2.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.022em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.449em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-261"><span class="mi" id="MathJax-Span-262" style="font-family: MathJax_Math; font-style: italic;">ϕ</span><span class="mo" id="MathJax-Span-263" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-264"><span class="mrow" id="MathJax-Span-265"><span class="mi" id="MathJax-Span-266" style="font-family: MathJax_Caligraphic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.097em;"></span></span></span></span><span class="mo" id="MathJax-Span-267" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-25">\phi(\mathcal{I})</script></span> 被重塑为 (reshape) 一个大小为 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-26-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-268" style="width: 4.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.661em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.885em 1000em 2.896em -0.457em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-269"><span class="mi" id="MathJax-Span-270" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-271" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span class="mo" id="MathJax-Span-272" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mn" id="MathJax-Span-273" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-26">MN\times 1</script></span>的向量，称为双线性向量 (<em>bilinear vector</em>) <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-27-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-274" style="width: 2.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.295em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.492em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-275"><span class="mtext" id="MathJax-Span-276" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-277" style="font-family: MathJax_Math; font-style: italic;">ϕ</span><span class="mo" id="MathJax-Span-278" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-279"><span class="mrow" id="MathJax-Span-280"><span class="mi" id="MathJax-Span-281" style="font-family: MathJax_Caligraphic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.097em;"></span></span></span></span><span class="mo" id="MathJax-Span-282" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-27">~\phi(\mathcal{I})</script></span>:</p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-28-Frame"><nobr><span class="math" id="MathJax-Span-283" style="width: 16.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.77em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.449em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-284"><span class="mi" id="MathJax-Span-285" style="font-family: MathJax_Math; font-style: italic;">ϕ</span><span class="mo" id="MathJax-Span-286" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-287"><span class="mrow" id="MathJax-Span-288"><span class="mi" id="MathJax-Span-289" style="font-family: MathJax_Caligraphic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.097em;"></span></span></span></span><span class="mo" id="MathJax-Span-290" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-291" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-292" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">r</span><span class="mi" id="MathJax-Span-293" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-294" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-295" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-296" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-297" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-298" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mo" id="MathJax-Span-299" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-300" style="font-family: MathJax_Math; font-style: italic;">ϕ</span><span class="mo" id="MathJax-Span-301" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-302"><span class="mrow" id="MathJax-Span-303"><span class="mi" id="MathJax-Span-304" style="font-family: MathJax_Caligraphic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.097em;"></span></span></span></span><span class="mo" id="MathJax-Span-305" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-306" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-307" style="font-family: MathJax_Main; padding-left: 0.167em;">[</span><span class="mi" id="MathJax-Span-308" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-309" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span class="mo" id="MathJax-Span-310" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-311" style="font-family: MathJax_Main; padding-left: 0.167em;">1</span><span class="mo" id="MathJax-Span-312" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-313" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-314" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-28">\phi(\mathcal{I}) = reshape(\phi(\mathcal{I}) , [MN, 1]).</script><p></p><p>该过程看起来似乎有点复杂，实际上它可以通过简单的矩阵相乘来实现。假设现在从两个 CNN 的最后一个卷积层之后分别取得两组特征，一组为 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-29-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-315" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.872em -0.531em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-316"><span class="mi" id="MathJax-Span-317" style="font-family: MathJax_Math; font-style: italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.909em; vertical-align: -0.303em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-29">p</script></span> 个特征图 (<em>feature maps</em>), 每个特征图大小为<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-30-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-318" style="width: 3.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.005em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.077em 1000em 2.907em -0.471em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-319"><span class="mi" id="MathJax-Span-320" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mo" id="MathJax-Span-321" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mi" id="MathJax-Span-322" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">m</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.746em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-30">m\times m</script></span>, 另一组为 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-31-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323" style="width: 0.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.492em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.872em -0.459em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-324"><span class="mi" id="MathJax-Span-325" style="font-family: MathJax_Math; font-style: italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.909em; vertical-align: -0.303em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-31">q</script></span> 个特征图, 每个特征图大小也为<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-32-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-326" style="width: 3.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.005em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.077em 1000em 2.907em -0.471em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-327"><span class="mi" id="MathJax-Span-328" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mo" id="MathJax-Span-329" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mi" id="MathJax-Span-330" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">m</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.746em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-32">m\times m</script></span>. 第一步, 分别将两组特征重塑 (<em>reshape</em>) 为 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-33-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-331" style="width: 6.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.191em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-332"><span class="mo" id="MathJax-Span-333" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-334" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mo" id="MathJax-Span-335" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mi" id="MathJax-Span-336" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">m</span><span class="mo" id="MathJax-Span-337" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-338" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mi" id="MathJax-Span-339" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">p</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-33">(m*m)\times p</script></span> 维和 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-340" style="width: 6.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.191em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-341"><span class="mo" id="MathJax-Span-342" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-343" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mo" id="MathJax-Span-344" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mi" id="MathJax-Span-345" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">m</span><span class="mo" id="MathJax-Span-346" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-347" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mi" id="MathJax-Span-348" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34">(m*m)\times q</script></span> 维的两个矩阵, 分别记为 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-35-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-349" style="width: 4.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.989em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.339em 1000em 2.712em -0.466em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-350"><span class="msubsup" id="MathJax-Span-351"><span style="display: inline-block; position: relative; width: 3.985em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-352" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.109em; left: 0.85em;"><span class="texatom" id="MathJax-Span-353"><span class="mrow" id="MathJax-Span-354"><span class="mo" id="MathJax-Span-355" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-356" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span class="mo" id="MathJax-Span-357" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span class="mi" id="MathJax-Span-358" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span class="mo" id="MathJax-Span-359" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-360" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-361" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">p</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.409em; vertical-align: -0.509em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-35">X_{(m*m)\times p}</script></span> 和 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-36-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-362" style="width: 4.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.77em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.339em 1000em 2.712em -0.462em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-363"><span class="msubsup" id="MathJax-Span-364"><span style="display: inline-block; position: relative; width: 3.718em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.677em -0.462em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-365" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.109em; left: 0.583em;"><span class="texatom" id="MathJax-Span-366"><span class="mrow" id="MathJax-Span-367"><span class="mo" id="MathJax-Span-368" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-369" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span class="mo" id="MathJax-Span-370" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span class="mi" id="MathJax-Span-371" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span class="mo" id="MathJax-Span-372" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-373" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-374" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.409em; vertical-align: -0.509em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-36">Y_{(m*m)\times q}</script></span>. 第二步, 计算矩阵乘积<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-37-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-375" style="width: 2.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.295em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.461em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-376"><span class="msubsup" id="MathJax-Span-377"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-378" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.65em; left: 0.932em;"><span class="mi" id="MathJax-Span-379" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-380" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.218em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-37">X^TY</script></span> 并 <strong>reshape</strong> 成一个 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-38-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-381" style="width: 2.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.186em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.103em 1000em 2.907em -0.471em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-382"><span class="mi" id="MathJax-Span-383" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-384" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mi" id="MathJax-Span-385" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">n</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.714em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-38">n*n</script></span> 维的向量。这个向量就是所谓的 <strong>bilinear vector</strong><span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-39-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-386" style="width: 2.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.295em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.492em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-387"><span class="mtext" id="MathJax-Span-388" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-389" style="font-family: MathJax_Math; font-style: italic;">ϕ</span><span class="mo" id="MathJax-Span-390" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-391"><span class="mrow" id="MathJax-Span-392"><span class="mi" id="MathJax-Span-393" style="font-family: MathJax_Caligraphic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.097em;"></span></span></span></span><span class="mo" id="MathJax-Span-394" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-39">~\phi(\mathcal{I})</script></span>.</p><p>对于全共享结构，只采用一个CNN网络，最后得到的特征自己跟自己进行矩阵相乘即 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-40-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-395" style="width: 2.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.35em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.461em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-396"><span class="msubsup" id="MathJax-Span-397"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-398" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.65em; left: 0.932em;"><span class="mi" id="MathJax-Span-399" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-400" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.218em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-40">X^TX</script></span>.</p><h4 id="2.3-bilinear-cnn-模型"><a name="2.3-bilinear-cnn-模型" href="#2.3-bilinear-cnn-模型"></a>2.3 Bilinear-CNN 模型</h4><pre><code class="mermaid" data-origin="<pre><code class=&quot;mermaid&quot;>graph TD
    subgraph PretrainedCNNs
    A[truncated_CNNs]
    end
    style A fill: #6c4, stroke: #6d5;
    A-- \ --&amp;gt;B[vl_nnbilinearpool/vl_nnbilinearclpool]
    subgraph BilinearModel
    B--&amp;gt;C[sqrt&amp;amp;l2 normalization]
    end
    style B fill: #6c4, stroke: #6d5;
    style C fill: #6c4, stroke: #6d5;
    C-- \ --&amp;gt;D[conv_classifier]
    style D fill: #6c4, stroke: #6d5;
    subgraph LinearClassifer
    D--&amp;gt;E[softmaxloss]
    end
    style E fill: #6c4, stroke: #6d5;
</code></pre>" data-processed="true"><svg id="mermaidChart0" width="349" xmlns="http://www.w3.org/2000/svg" height="567" viewBox="0 0 349 567"><style type="text/css" title="mermaid-svg-internal-css">/*  */
#mermaidChart0 .node { fill:#ffa; stroke:#666; stroke-width:3px; }
#mermaidChart0 .node text  { fill:#000; stroke:none; font-weight:300; font-family:"Helvetica Neue",Helvetica,Arial,sans-serf; font-size:14px; }
#mermaidChart0 .edgeLabel text  { fill:#000; stroke:none; font-weight:300; font-family:"Helvetica Neue",Helvetica,Arial,sans-serf; font-size:14px; }
.mermaid .label { color: rgb(51, 51, 51); }
.node circle, .node polygon, .node rect { fill: rgb(236, 236, 255); stroke: rgb(204, 204, 255); stroke-width: 1px; }
.edgePath .path { stroke: rgb(51, 51, 51); }
.cluster rect { fill: rgb(255, 255, 222); stroke: rgb(170, 170, 51); stroke-width: 1px; }
.mermaid .label { color: rgb(51, 51, 51); }
.node circle, .node polygon, .node rect { fill: rgb(205, 228, 152); stroke: rgb(19, 84, 12); stroke-width: 1px; }
.edgePath .path { stroke: rgb(0, 128, 0); stroke-width: 1.5px; }
.cluster rect { fill: rgb(205, 255, 178); stroke: rgb(110, 170, 73); stroke-width: 1px; }
/*  */
</style><g><g class="output"><g class="clusters"><g class="cluster" style="opacity: 1;"><rect width="173" height="81" x="88" y="20"></rect><text x="174.5" y="34" fill="black" stroke="none" id="mermaidChart0Text" style="text-anchor: middle;"> PretrainedCNNs</text></g><g class="cluster" style="opacity: 1;"><rect width="309" height="162" x="20" y="162"></rect><text x="174.5" y="176" fill="black" stroke="none" id="mermaidChart0Text" style="text-anchor: middle;"> BilinearModel</text></g><g class="cluster" style="opacity: 1;"><rect width="179" height="162" x="85" y="385"></rect><text x="174.5" y="399" fill="black" stroke="none" id="mermaidChart0Text" style="text-anchor: middle;"> LinearClassifer</text></g></g><g class="edgePaths"><g class="edgePath" style="opacity: 1;"><path class="path" d="M174.5,76L174.5,101L174.5,131.5L174.5,162L174.5,187" marker-end="url(#arrowhead72)" style="fill:none"></path><defs><marker id="arrowhead72" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="fill: #333"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M174.5,218L174.5,243L174.5,268" marker-end="url(#arrowhead73)" style="fill:none"></path><defs><marker id="arrowhead73" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="fill: #333"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M174.5,299L174.5,324L174.5,354.5L174.5,385L174.5,410" marker-end="url(#arrowhead74)" style="fill:none"></path><defs><marker id="arrowhead74" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="fill: #333"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M174.5,441L174.5,466L174.5,491" marker-end="url(#arrowhead75)" style="fill:none"></path><defs><marker id="arrowhead75" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="fill: #333"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="translate(174.5,131.5)" style="opacity: 1;"><g transform="translate(-3,-5.5)" class="label"><foreignObject width="6" height="11"><div style="display: inline-block; white-space: nowrap;"><span style="background:#e8e8e8">\</span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div style="display: inline-block; white-space: nowrap;"><span style="background:#e8e8e8"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(174.5,354.5)" style="opacity: 1;"><g transform="translate(-3,-5.5)" class="label"><foreignObject width="6" height="11"><div style="display: inline-block; white-space: nowrap;"><span style="background:#e8e8e8">\</span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div style="display: inline-block; white-space: nowrap;"><span style="background:#e8e8e8"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node" id="A" transform="translate(174.5,60.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-51.5" y="-15.5" width="103" height="31" style="fill: #6c4; stroke: #6d5;"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-41.5,-5.5)"><foreignObject width="83" height="11"><div style="display: inline-block; white-space: nowrap;">truncated_CNNs</div></foreignObject></g></g></g><g class="node" id="B" transform="translate(174.5,202.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-119.5" y="-15.5" width="239" height="31" style="fill: #6c4; stroke: #6d5;"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-109.5,-5.5)"><foreignObject width="219" height="11"><div style="display: inline-block; white-space: nowrap;">vl_nnbilinearpool/vl_nnbilinearclpool</div></foreignObject></g></g></g><g class="node" id="C" transform="translate(174.5,283.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-72" y="-15.5" width="144" height="31" style="fill: #6c4; stroke: #6d5;"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-62,-5.5)"><foreignObject width="124" height="11"><div style="display: inline-block; white-space: nowrap;">sqrt&amp;l2 normalization</div></foreignObject></g></g></g><g class="node" id="D" transform="translate(174.5,425.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-54.5" y="-15.5" width="109" height="31" style="fill: #6c4; stroke: #6d5;"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-44.5,-5.5)"><foreignObject width="89" height="11"><div style="display: inline-block; white-space: nowrap;">conv_classifier</div></foreignObject></g></g></g><g class="node" id="E" transform="translate(174.5,506.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-42.5" y="-15.5" width="85" height="31" style="fill: #6c4; stroke: #6d5;"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-32.5,-5.5)"><foreignObject width="65" height="11"><div style="display: inline-block; white-space: nowrap;">softmaxloss</div></foreignObject></g></g></g></g></g></g></svg></code></pre><ol>
<li><p>将两个在 <strong>ImageNet</strong> 数据集上预训练过的 CNN 模型砍掉最后一个卷积层之后的结构 (保留非线性函数 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-41-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-401" style="width: 2.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.803em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-402"><span class="mi" id="MathJax-Span-403" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-404" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-405" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-406" style="font-family: MathJax_Math; font-style: italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-41">relu</script></span>), 剩余的部分用作特征提取器。</p>
<p> 文章中采用了 <a href="http://www.vlfeat.org/matconvnet/models/imagenet-vgg-m.mat"><code>imagenet-vgg-m.mat</code></a>, 在第 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-42-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-407" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.891em 1000em 2.896em -0.409em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-408"><span class="mn" id="MathJax-Span-409" style="font-family: MathJax_Main;">14</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.959em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-42">14</script></span> 层 (<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-43-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-410" style="width: 6.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.519em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.874em 1000em 3.062em -0.458em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-411"><span class="mi" id="MathJax-Span-412" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-413" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-414" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="msubsup" id="MathJax-Span-415"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-416" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="mn" id="MathJax-Span-417" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-418" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-419" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">r</span><span class="mi" id="MathJax-Span-420" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-421" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-422" style="font-family: MathJax_Math; font-style: italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.182em; vertical-align: -0.269em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-43">conv_5+relu</script></span>)之后截断，称为 <code>M-Net</code>, 以及 <a href="http://www.vlfeat.org/matconvnet/models/imagenet-vgg-verydeep-16.mat"><code>imagenet-vgg-verydeep-16.mat</code></a>, 在第30层 (<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-44-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-423" style="width: 7.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.23em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.874em 1000em 3.09em -0.458em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-424"><span class="mi" id="MathJax-Span-425" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-426" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-427" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="msubsup" id="MathJax-Span-428"><span style="display: inline-block; position: relative; width: 1.66em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-429" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="texatom" id="MathJax-Span-430"><span class="mrow" id="MathJax-Span-431"><span class="mn" id="MathJax-Span-432" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span class="mi" id="MathJax-Span-433" style="font-size: 70.7%; font-family: MathJax_Main;">_</span><span class="mn" id="MathJax-Span-434" style="font-size: 70.7%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-435" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-436" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">r</span><span class="mi" id="MathJax-Span-437" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-438" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-439" style="font-family: MathJax_Math; font-style: italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.216em; vertical-align: -0.303em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-44">conv_{5\_3} + relu</script></span>) 之后截断, 称为 <code>D-Net</code>, 这两个作为特征提取器。</p>
<ul>
<li><p><a href="https://arxiv.org/pdf/1405.3531v4"><code>M-Net</code></a> 即是下表中的 <strong>CNN-M</strong></p>
  <div style="text-align:center"><img src="images/vgg-s-m-f.png" align="middle"></div>
</li><li><p><a href="https://arxiv.org/pdf/1409.1556v6"><code>D-Net</code></a> 即是下表中的 <strong>VGG-16</strong></p>
  <div style="text-align:center"><img src="images/vgg-16.png" align="middle"></div>
</li></ul>
</li><li><p>应用 <em>2.2</em> 节介绍的双线性模型，计算双线性向量 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-45-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-440" style="width: 4.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.934em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.457em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-441"><span class="mi" id="MathJax-Span-442" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-443" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-444" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">ϕ</span><span class="mo" id="MathJax-Span-445" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-446"><span class="mrow" id="MathJax-Span-447"><span class="mi" id="MathJax-Span-448" style="font-family: MathJax_Caligraphic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.097em;"></span></span></span></span><span class="mo" id="MathJax-Span-449" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-45">x = \phi(\mathcal{I})</script></span>.</p>
</li><li><p>将该向量依次进行平方根标准化和 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-46-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-450" style="width: 1.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.53em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.902em 1000em 2.896em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-451"><span class="mn" id="MathJax-Span-452" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-453" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.946em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-46">2-</script></span>范数标准化：</p>
<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-47-Frame"><nobr><span class="math" id="MathJax-Span-454" style="width: 9.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.541em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.429em 1000em 3.569em -0.471em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-455"><span class="mi" id="MathJax-Span-456" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-457" style="font-family: MathJax_Main; padding-left: 0.278em;">←</span><span class="mi" id="MathJax-Span-458" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">s</span><span class="mi" id="MathJax-Span-459" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-460" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-461" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-462" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-463" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-464" style="font-family: MathJax_Main;">)</span><span class="msqrt" id="MathJax-Span-465"><span style="display: inline-block; position: relative; width: 2.24em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.145em -0.373em); top: -2.732em; left: 0.984em;"><span class="mrow" id="MathJax-Span-466"><span class="texatom" id="MathJax-Span-467"><span class="mrow" id="MathJax-Span-468"><span class="mo" id="MathJax-Span-469" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-470" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="texatom" id="MathJax-Span-471"><span class="mrow" id="MathJax-Span-472"><span class="mo" id="MathJax-Span-473" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(3.555em 1000em 4.023em -0.492em); top: -4.858em; left: 0.984em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.989em; left: -0.084em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.989em; left: 0.563em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(2.675em 1000em 4.803em -0.381em); top: -3.966em; left: 0em;"><span style="font-family: MathJax_Size2;">√</span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.344em; vertical-align: -0.888em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-47">y \leftarrow sign(x)\sqrt{|x|}</script><p></p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-48-Frame"><nobr><span class="math" id="MathJax-Span-474" style="width: 5.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.536em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.445em 1000em 3.907em -0.457em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-475"><span class="mi" id="MathJax-Span-476" style="font-family: MathJax_Math; font-style: italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-477" style="font-family: MathJax_Main; padding-left: 0.278em;">←</span><span class="mfrac" id="MathJax-Span-478" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 2.251em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.908em 1000em 2.883em -0.471em); top: -3.195em; left: 50%; margin-left: -0.273em;"><span class="mi" id="MathJax-Span-479" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.818em 1000em 3.181em -0.373em); top: -2.006em; left: 50%; margin-left: -1.066em;"><span class="mrow" id="MathJax-Span-480"><span class="texatom" id="MathJax-Span-481"><span class="mrow" id="MathJax-Span-482"><span class="mo" id="MathJax-Span-483" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-484"><span class="mrow" id="MathJax-Span-485"><span class="mo" id="MathJax-Span-486" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-487" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="texatom" id="MathJax-Span-488"><span class="mrow" id="MathJax-Span-489"><span class="mo" id="MathJax-Span-490" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-491"><span style="display: inline-block; position: relative; width: 0.785em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.145em -0.373em); top: -2.732em; left: 0em;"><span class="texatom" id="MathJax-Span-492"><span class="mrow" id="MathJax-Span-493"><span class="mo" id="MathJax-Span-494" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.011em; left: 0.328em;"><span class="mn" id="MathJax-Span-495" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 2.251em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.738em; vertical-align: -1.3em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-48">z \leftarrow \frac{y}{||y||_2}</script><p></p></li><li><p>利用 softmax 或者 SVM 作为分类函数 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-49-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-496" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.863em 1000em 2.921em -0.492em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-497"><span class="mtext" id="MathJax-Span-498" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-499"><span class="mrow" id="MathJax-Span-500"><span class="mi" id="MathJax-Span-501" style="font-family: MathJax_Caligraphic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span></span><span class="mtext" id="MathJax-Span-502" style="font-family: MathJax_Main;">&nbsp;</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.024em; vertical-align: -0.097em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-49">~\mathcal{C}~</script></span>. 文章中用了一组线性SVM作为最后的分类器.</p>
</li></ol><h4 id="2.4-梯度计算&amp;编程细节"><a name="2.4-梯度计算&amp;编程细节" href="#2.4-梯度计算&amp;编程细节"></a>2.4 梯度计算&amp;编程细节</h4><p>在训练网络时，通常每次处理一小批样本。为了方便，这里假设只有一个样本，<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-50-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-503" style="width: 1.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.093em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.58em 1000em 2.5em -0.457em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-504"><span class="msubsup" id="MathJax-Span-505"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-506" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-507" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.856em; vertical-align: -0.25em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-50">x_1</script></span> 和 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-51-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-508" style="width: 1.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.093em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.58em 1000em 2.5em -0.457em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-509"><span class="msubsup" id="MathJax-Span-510"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-511" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-512" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.856em; vertical-align: -0.25em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-51">x_2</script></span> 为两个截断卷积网提取的特征。注意，当两个卷积网相同时，有<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-52-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-513" style="width: 4.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.443em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.126em 1000em 3.046em -0.457em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-514"><span class="msubsup" id="MathJax-Span-515"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-516" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-517" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-518" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-519" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-520" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-521" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.856em; vertical-align: -0.25em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-52">x_1 = x_2</script></span>.</p><ol>
<li><p>池化双线性 (Bilinear-pool): <code>y = vl_nnbilinearclpool(x1, x2, varargin)</code><br> <strong>输入</strong>: 两组特征图 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-53-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-522" style="width: 3.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.568em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.126em 1000em 3.09em -0.457em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-523"><span class="msubsup" id="MathJax-Span-524"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-525" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-526" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-527" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-528" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-529" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-530" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.909em; vertical-align: -0.303em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-53">x_1, x_2</script></span>, 大小分别为 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-54-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-531" style="width: 6.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.246em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.374em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-532"><span class="mo" id="MathJax-Span-533" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-534"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.444em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-535" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-536" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-537" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-538" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.223em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-539" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.765em;"><span class="mn" id="MathJax-Span-540" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-541" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-542" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">c</span><span class="msubsup" id="MathJax-Span-543"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.444em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-544" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-545" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-546" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-54">[h_1, w_1, ch_1]</script></span> 和 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-55-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-547" style="width: 6.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.246em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.374em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-548"><span class="mo" id="MathJax-Span-549" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-550"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.444em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-551" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-552" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-553" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-554" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.223em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-555" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.765em;"><span class="mn" id="MathJax-Span-556" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-557" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-558" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">c</span><span class="msubsup" id="MathJax-Span-559"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.444em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-560" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-561" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-562" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-55">[h_2, w_2, ch_2]</script></span>， 对应高度, 宽度和通道数.  <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-56-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-563" style="width: 2.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.24em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.827em -0.446em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-564"><span class="msubsup" id="MathJax-Span-565"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-566" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-567" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-568" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.149em; vertical-align: -0.249em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-56">\nabla_YZ</script></span> (<code>dzdy</code>) 表示损失函数 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-57-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-569" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.434em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-570"><span class="mi" id="MathJax-Span-571" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-57">Z</script></span> 对 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-58-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-572" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.883em -0.471em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-573"><span class="mi" id="MathJax-Span-574" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.923em; vertical-align: -0.317em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-58">y</script></span> 的梯度.<br> <strong>输出</strong>: 双线性向量 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-59-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-575" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.883em -0.471em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-576"><span class="mi" id="MathJax-Span-577" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.923em; vertical-align: -0.317em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-59">y</script></span>，大小为 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-60-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-578" style="width: 6.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.464em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.374em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-579"><span class="mo" id="MathJax-Span-580" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-581" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-582" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mn" id="MathJax-Span-583" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-584" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mi" id="MathJax-Span-585" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">c</span><span class="mi" id="MathJax-Span-586" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mn" id="MathJax-Span-587" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-588" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-589" style="font-family: MathJax_Main; padding-left: 0.167em;">1</span><span class="mo" id="MathJax-Span-590" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-60">[ch1*ch2, 1]</script></span>.</p>
<ul>
<li><p><strong>正向传播</strong></p>
<ul>
<li>把 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-61-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-591" style="width: 3.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.568em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.126em 1000em 3.09em -0.457em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-592"><span class="msubsup" id="MathJax-Span-593"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-594" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-595" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-596" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-597" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-598" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-599" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.909em; vertical-align: -0.303em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-61">x_1, x_2</script></span> <code>reshape</code> 为同样的大小, i.e., 对其中较大的一个进行下采样 (downsampling) 使得 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-62-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-600" style="width: 10.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.579em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.874em 1000em 3.046em -0.444em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-601"><span class="msubsup" id="MathJax-Span-602"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.444em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-603" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-604" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-605" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="msubsup" id="MathJax-Span-606" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.223em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-607" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.765em;"><span class="mn" id="MathJax-Span-608" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-609" style="font-family: MathJax_Main; padding-left: 0.278em;">=<span style="font-family: MathJax_Main; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-610" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.444em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-611" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-612" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-613" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="msubsup" id="MathJax-Span-614" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.223em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-615" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.765em;"><span class="mn" id="MathJax-Span-616" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.163em; vertical-align: -0.25em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-62"> h_1 * w_1 == h_2 * w_2</script></span>:<pre><code data-origin="<pre><code>resize_image(x1, x2)
</code></pre>">resize_image(x1, x2)
</code></pre></li><li>Reshape <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-63-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-617" style="width: 3.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.568em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.126em 1000em 3.09em -0.457em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-618"><span class="msubsup" id="MathJax-Span-619"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-620" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-621" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-622" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-623" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-624" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-625" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.909em; vertical-align: -0.303em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-63">x_1, x_2</script></span> to <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-64-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-626" style="width: 3.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.005em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.885em 1000em 3.09em -0.466em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-627"><span class="msubsup" id="MathJax-Span-628"><span style="display: inline-block; position: relative; width: 1.308em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-629" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-630" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-631" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-632" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-633" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-634" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.303em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-64">X_a, X_b</script></span> with sizes <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-65-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-635" style="width: 7.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.738em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.374em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-636"><span class="mo" id="MathJax-Span-637" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-638"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.444em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-639" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-640" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-641" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="msubsup" id="MathJax-Span-642" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.223em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-643" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.765em;"><span class="mn" id="MathJax-Span-644" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-645" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-646" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">c</span><span class="msubsup" id="MathJax-Span-647"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.444em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-648" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-649" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-650" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-65">[h_1 * w_1, ch_1]</script></span> and <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-66-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-651" style="width: 7.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.738em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.374em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-652"><span class="mo" id="MathJax-Span-653" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-654"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.444em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-655" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-656" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-657" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="msubsup" id="MathJax-Span-658" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.223em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-659" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.765em;"><span class="mn" id="MathJax-Span-660" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-661" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-662" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">c</span><span class="msubsup" id="MathJax-Span-663"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.444em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-664" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-665" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-666" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-66">[h_2 * w_2, ch_2]</script></span> respectively:<pre><code data-origin="<pre><code>Xa = reshape(x1, [h1*w1, ch1])
Xb = reshape(x2, [h2*w2, ch2])
</code></pre>">Xa = reshape(x1, [h1*w1, ch1])
Xb = reshape(x2, [h2*w2, ch2])
</code></pre></li><li>Cacultate their outer product:<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-67-Frame"><nobr><span class="math" id="MathJax-Span-667" style="width: 5.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.863em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.68em 1000em 3.15em -0.462em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-668"><span class="mi" id="MathJax-Span-669" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-670" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-671" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-672" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.598em 1000em 2.404em -0.477em); top: -2.65em; left: 0.932em;"><span class="mi" id="MathJax-Span-673" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.765em 1000em 2.411em -0.468em); top: -1.993em; left: 0.85em;"><span class="mi" id="MathJax-Span-674" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-675"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-676" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-677" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.528em; vertical-align: -0.377em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-67">Y = X_a^T X_b</script><p></p><pre><code data-origin="<pre><code>  Y = Xa' * Xb
</code></pre>">  Y = Xa' * Xb
</code></pre></li><li>Reshape <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-68-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-678" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.883em -0.471em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-679"><span class="mi" id="MathJax-Span-680" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.923em; vertical-align: -0.317em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-68">y</script></span> to a vector with size <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-69-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-681" style="width: 6.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.464em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.374em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-682"><span class="mo" id="MathJax-Span-683" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-684" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="msubsup" id="MathJax-Span-685"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.444em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-686" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-687" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-688" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mi" id="MathJax-Span-689" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">c</span><span class="msubsup" id="MathJax-Span-690"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.444em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-691" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-692" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-693" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-694" style="font-family: MathJax_Main; padding-left: 0.167em;">1</span><span class="mo" id="MathJax-Span-695" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-69">[ch_1 * ch_2, 1]</script></span>.<pre><code data-origin="<pre><code>y = reshape(Y, [ch1 * ch2, 1])
</code></pre>">y = reshape(Y, [ch1 * ch2, 1])
</code></pre></li></ul>
</li><li><p><strong>反向传播</strong><br>Since <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-70-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-696" style="width: 5.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.863em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.68em 1000em 3.15em -0.462em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-697"><span class="mi" id="MathJax-Span-698" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-699" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-700" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-701" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.598em 1000em 2.404em -0.477em); top: -2.65em; left: 0.932em;"><span class="mi" id="MathJax-Span-702" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.765em 1000em 2.411em -0.468em); top: -1.993em; left: 0.85em;"><span class="mi" id="MathJax-Span-703" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-704"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-705" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-706" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.528em; vertical-align: -0.377em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-70">Y = X_a^TX_b</script></span>, calculate <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-71-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-707" style="width: 3.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.623em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.939em -0.446em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-708"><span class="msubsup" id="MathJax-Span-709"><span style="display: inline-block; position: relative; width: 1.86em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-710" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.874em;"><span class="texatom" id="MathJax-Span-711"><span class="mrow" id="MathJax-Span-712"><span class="msubsup" id="MathJax-Span-713"><span style="display: inline-block; position: relative; width: 0.91em; height: 0px;"><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.473em); top: -2.24em; left: 0em;"><span class="mi" id="MathJax-Span-714" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; top: -2.08em; left: 0.584em;"><span class="mi" id="MathJax-Span-715" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span></span><span class="mi" id="MathJax-Span-716" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.285em; vertical-align: -0.385em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-71">\nabla_{X_a}Z</script></span> is easy (<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-72-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-717" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.434em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-718"><span class="mi" id="MathJax-Span-719" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-72">Z</script></span> denotes the cost function):</p>
<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-73-Frame"><nobr><span class="math" id="MathJax-Span-720" style="width: 20.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.995em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(0.483em 1000em 3.389em -0.325em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-721"><span class="mtable" id="MathJax-Span-722" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 16.667em; height: 0px;"><span style="position: absolute; clip: rect(3.242em 1000em 4.931em -0.492em); top: -3.989em; left: 0em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.825em 1000em 4.153em -0.492em); top: -4.573em; right: 0em;"><span class="mtd" id="MathJax-Span-723"><span class="mrow" id="MathJax-Span-724"></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(3.825em 1000em 4.153em -0.492em); top: -3.211em; right: 0em;"><span class="mtd" id="MathJax-Span-763"><span class="mrow" id="MathJax-Span-764"></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(2.286em 1000em 5.192em -0.446em); top: -3.989em; left: 0em;"><span style="display: inline-block; position: relative; width: 16.667em; height: 0px;"><span style="position: absolute; clip: rect(1.613em 1000em 3.157em -0.446em); top: -3.316em; left: 0em;"><span class="mtd" id="MathJax-Span-725"><span class="mrow" id="MathJax-Span-726"><span class="msubsup" id="MathJax-Span-727"><span style="display: inline-block; position: relative; width: 1.86em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-728" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.874em;"><span class="texatom" id="MathJax-Span-729"><span class="mrow" id="MathJax-Span-730"><span class="msubsup" id="MathJax-Span-731"><span style="display: inline-block; position: relative; width: 0.91em; height: 0px;"><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.473em); top: -2.24em; left: 0em;"><span class="mi" id="MathJax-Span-732" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; top: -2.08em; left: 0.584em;"><span class="mi" id="MathJax-Span-733" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span></span><span class="mi" id="MathJax-Span-734" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-735" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-736" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.86em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-737" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.874em;"><span class="texatom" id="MathJax-Span-738"><span class="mrow" id="MathJax-Span-739"><span class="msubsup" id="MathJax-Span-740"><span style="display: inline-block; position: relative; width: 0.91em; height: 0px;"><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.473em); top: -2.24em; left: 0em;"><span class="mi" id="MathJax-Span-741" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; top: -2.08em; left: 0.584em;"><span class="mi" id="MathJax-Span-742" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span></span><span class="mi" id="MathJax-Span-743" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-744" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="msubsup" id="MathJax-Span-745" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-746" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-747" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-748" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-749" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-750" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-751" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-752" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-753" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="mo" id="MathJax-Span-754" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="msubsup" id="MathJax-Span-755"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-756" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-757" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-758" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="msubsup" id="MathJax-Span-759"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-760" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-761" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-762" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.818em 1000em 3.158em -0.446em); top: -1.955em; left: 0em;"><span class="mtd" id="MathJax-Span-765"><span class="mrow" id="MathJax-Span-766"><span class="msubsup" id="MathJax-Span-767"><span style="display: inline-block; position: relative; width: 1.805em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-768" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.874em;"><span class="texatom" id="MathJax-Span-769"><span class="mrow" id="MathJax-Span-770"><span class="msubsup" id="MathJax-Span-771"><span style="display: inline-block; position: relative; width: 0.856em; height: 0px;"><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.473em); top: -2.24em; left: 0em;"><span class="mi" id="MathJax-Span-772" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; top: -2.08em; left: 0.584em;"><span class="mi" id="MathJax-Span-773" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span></span><span class="mi" id="MathJax-Span-774" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-775" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-776" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.805em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-777" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.874em;"><span class="texatom" id="MathJax-Span-778"><span class="mrow" id="MathJax-Span-779"><span class="msubsup" id="MathJax-Span-780"><span style="display: inline-block; position: relative; width: 0.856em; height: 0px;"><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.473em); top: -2.24em; left: 0em;"><span class="mi" id="MathJax-Span-781" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; top: -2.08em; left: 0.584em;"><span class="mi" id="MathJax-Span-782" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span></span><span class="mi" id="MathJax-Span-783" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-784" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="msubsup" id="MathJax-Span-785" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-786" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-787" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-788" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-789" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-790" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.308em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-791" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-792" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-793" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="mo" id="MathJax-Span-794" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="msubsup" id="MathJax-Span-795"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-796" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-797" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-798" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-799" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-800" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.279em; vertical-align: -1.334em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-73">
\begin{align}
& \nabla_{X_a}Z = \nabla_{X_a}Y\cdot\nabla_YZ = X_b\cdot(\nabla_YZ)^T,\\
& \nabla_{X_b}Z = \nabla_{X_b}Y\cdot\nabla_YZ = X_a\cdot(\nabla_YZ).\\
\end{align}</script><p></p><ul>
<li>Reshape <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-74-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-801" style="width: 3.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.568em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.126em 1000em 3.09em -0.457em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-802"><span class="msubsup" id="MathJax-Span-803"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-804" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-805" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-806" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-807" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-808" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-809" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.909em; vertical-align: -0.303em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-74">x_1, x_2</script></span> to <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-75-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-810" style="width: 3.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.005em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.885em 1000em 3.09em -0.466em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-811"><span class="msubsup" id="MathJax-Span-812"><span style="display: inline-block; position: relative; width: 1.308em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-813" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-814" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-815" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-816" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-817" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-818" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.303em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-75">X_a, X_b</script></span> with sizes <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-76-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-819" style="width: 7.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.738em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.374em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-820"><span class="mo" id="MathJax-Span-821" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-822"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.444em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-823" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-824" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-825" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="msubsup" id="MathJax-Span-826" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.223em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-827" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.765em;"><span class="mn" id="MathJax-Span-828" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-829" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-830" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">c</span><span class="msubsup" id="MathJax-Span-831"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.444em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-832" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-833" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-834" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-76">[h_1 * w_1, ch_1]</script></span> and <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-77-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-835" style="width: 7.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.738em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.374em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-836"><span class="mo" id="MathJax-Span-837" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-838"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.444em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-839" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-840" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-841" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="msubsup" id="MathJax-Span-842" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.223em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-843" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.765em;"><span class="mn" id="MathJax-Span-844" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-845" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-846" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">c</span><span class="msubsup" id="MathJax-Span-847"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.444em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-848" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-849" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-850" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-77">[h_2 * w_2, ch_2]</script></span> respectively:<pre><code data-origin="<pre><code>  Xa = reshape(x1, [h1*w1, ch1])
  Xb = reshape(x2, [h2*w2, ch2])
</code></pre>">  Xa = reshape(x1, [h1*w1, ch1])
  Xb = reshape(x2, [h2*w2, ch2])
</code></pre></li><li>Reshape input <code>dzdy</code> to size <code>[ch1, ch2]</code>.<pre><code data-origin="<pre><code>  Delta = reshape(dzdy, [ch1, ch2]
</code></pre>">  Delta = reshape(dzdy, [ch1, ch2]
</code></pre></li><li>Calculate <code>dzdxa</code> and <code>dzdxb</code><pre><code data-origin="<pre><code>  dzdxa = Xb * Delta'
  dzdxb = Xa * Delta
</code></pre>">  dzdxa = Xb * Delta'
  dzdxb = Xa * Delta
</code></pre></li><li>Reshape <code>dzdxa</code> and <code>dzdxb</code> to sizes as with <code>x1</code> and <code>x2</code>.<pre><code data-origin="<pre><code>  dzdx1 = reshape(dzdxa, [h1, w1, ch1])
  dzdx2 = reshape(dzdxb, [h2, w2, ch2])
</code></pre>">  dzdx1 = reshape(dzdxa, [h1, w1, ch1])
  dzdx2 = reshape(dzdxb, [h2, w2, ch2])
</code></pre></li></ul>
<p>Note that when <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-78-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-851" style="width: 1.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.311em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.339em 1000em 2.507em -0.466em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-852"><span class="msubsup" id="MathJax-Span-853"><span style="display: inline-block; position: relative; width: 1.308em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-854" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-855" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.158em; vertical-align: -0.258em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-78">X_a</script></span> equals <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-79-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-856" style="width: 1.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.339em 1000em 2.508em -0.466em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-857"><span class="msubsup" id="MathJax-Span-858"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-859" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-860" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.159em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-79">X_b</script></span>, i.e. <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-80-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-861" style="width: 7.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.066em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.885em 1000em 3.054em -0.466em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-862"><span class="msubsup" id="MathJax-Span-863"><span style="display: inline-block; position: relative; width: 1.308em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-864" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-865" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-866" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-867" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-868" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-869" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-870" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-871" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.159em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-80">X_a = X_b = X</script></span>,</p>
<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-81-Frame"><nobr><span class="math" id="MathJax-Span-872" style="width: 19.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.339em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.613em 1000em 3.146em -0.446em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-873"><span class="msubsup" id="MathJax-Span-874"><span style="display: inline-block; position: relative; width: 1.55em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-875" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="texatom" id="MathJax-Span-876"><span class="mrow" id="MathJax-Span-877"><span class="mi" id="MathJax-Span-878" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-879" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-880" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-881" style="font-family: MathJax_Main; padding-left: 0.278em;">2</span><span class="msubsup" id="MathJax-Span-882"><span style="display: inline-block; position: relative; width: 1.55em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-883" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="texatom" id="MathJax-Span-884"><span class="mrow" id="MathJax-Span-885"><span class="mi" id="MathJax-Span-886" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-887" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-888" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="msubsup" id="MathJax-Span-889" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-890" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-891" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-892" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-893" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-894" style="font-family: MathJax_Main; padding-left: 0.278em;">2</span><span class="mi" id="MathJax-Span-895" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-896" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="mo" id="MathJax-Span-897" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="msubsup" id="MathJax-Span-898"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-899" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-900" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-901" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="msubsup" id="MathJax-Span-902"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-903" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-904" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.604em; vertical-align: -0.372em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-81">\nabla_{X}Z = 2\nabla_{X}Y\cdot\nabla_YZ = 2X\cdot(\nabla_YZ)^T</script><p></p><p>In fact, this is just a special case of <code>y = vl_nnbilinearclpool(x1, x2, varargin)</code>. Assume <code>y{1} = dzdx1</code> and <code>y{2} = dzdx2</code>, we can reuse this function by taking <code>dzdx = dzdx1 + dzdx2 = y{1} + y{2}</code>.</p>
</li></ul>
</li></ol><ol>
<li><p>平方根标准化: <code>y = vl_nnsqrt(x, param, varargin)</code></p>
<ul>
<li><p><strong>正向传播</strong> (element-wise operation):</p>
<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-82-Frame"><nobr><span class="math" id="MathJax-Span-905" style="width: 12.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.328em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.43em 1000em 3.57em -0.471em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-906"><span class="mi" id="MathJax-Span-907" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-908" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-909" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">s</span><span class="mi" id="MathJax-Span-910" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-911" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-912" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-913" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-914" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-915" style="font-family: MathJax_Main;">)</span><span class="mtext" id="MathJax-Span-916" style="font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-917" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-918" style="font-family: MathJax_Main; padding-left: 0.167em;">∗</span><span class="mtext" id="MathJax-Span-919" style="font-family: MathJax_Main;">&nbsp;</span><span class="msqrt" id="MathJax-Span-920"><span style="display: inline-block; position: relative; width: 3.795em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.459em); top: -2.732em; left: 0.984em;"><span class="mrow" id="MathJax-Span-921"><span class="mi" id="MathJax-Span-922" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-923" style="font-family: MathJax_Math; font-style: italic;">b</span><span class="mi" id="MathJax-Span-924" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-925" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-926" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-927" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(3.555em 1000em 4.023em -0.492em); top: -4.858em; left: 0.984em;"><span style="display: inline-block; position: relative; width: 2.812em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.989em; left: -0.084em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.989em; left: 2.118em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 0.448em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 1.004em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 1.561em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(2.675em 1000em 4.803em -0.381em); top: -3.965em; left: 0em;"><span style="font-family: MathJax_Size2;">√</span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.344em; vertical-align: -0.889em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-82">y = sign(x)~ .* ~\sqrt{abs(x)}</script><p></p><p>  Note that <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-83-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-928" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.883em -0.471em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-929"><span class="mi" id="MathJax-Span-930" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.923em; vertical-align: -0.317em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-83">y</script></span> is with the same size as <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-84-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-931" style="width: 0.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.601em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-932"><span class="mi" id="MathJax-Span-933" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.686em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-84">x</script></span>.</p>
</li><li><p><strong>反向传播</strong> (element-wise operation):</p>
<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-85-Frame"><nobr><span class="math" id="MathJax-Span-934" style="width: 17.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.536em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.193em 1000em 4.082em -0.492em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-935"><span class="mfrac" id="MathJax-Span-936"><span style="display: inline-block; position: relative; width: 1.268em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.656em 1000em 2.883em -0.459em); top: -3.195em; left: 50%; margin-left: -0.519em;"><span class="mrow" id="MathJax-Span-937"><span class="mi" id="MathJax-Span-938" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-939" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.459em); top: -1.828em; left: 50%; margin-left: -0.574em;"><span class="mrow" id="MathJax-Span-940"><span class="mi" id="MathJax-Span-941" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-942" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 1.268em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-943" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-944" style="font-family: MathJax_Main; padding-left: 0.278em;">0.5</span><span class="mtext" id="MathJax-Span-945" style="font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-946" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-947" style="font-family: MathJax_Main; padding-left: 0.167em;">∗</span><span class="mtext" id="MathJax-Span-948" style="font-family: MathJax_Main;">&nbsp;</span><span class="mfrac" id="MathJax-Span-949" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 8.56em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.902em 1000em 2.896em -0.409em); top: -3.409em; left: 50%; margin-left: -0.273em;"><span class="mn" id="MathJax-Span-950" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(2.957em 1000em 4.494em -0.381em); top: -3.144em; left: 50%; margin-left: -4.22em;"><span class="msqrt" id="MathJax-Span-951"><span style="display: inline-block; position: relative; width: 8.44em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.459em); top: -2.732em; left: 0.984em;"><span class="mrow" id="MathJax-Span-952"><span class="mi" id="MathJax-Span-953" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-954" style="font-family: MathJax_Math; font-style: italic;">b</span><span class="mi" id="MathJax-Span-955" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-956" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-957" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-958" style="font-family: MathJax_Main;">)</span><span class="mtext" id="MathJax-Span-959" style="font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-960" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-961" style="font-family: MathJax_Main; padding-left: 0.167em;">+</span><span class="mtext" id="MathJax-Span-962" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-963" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-964" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-965" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-966" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-967" style="font-family: MathJax_Math; font-style: italic;">m</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(3.555em 1000em 4.023em -0.492em); top: -4.587em; left: 0.984em;"><span style="display: inline-block; position: relative; width: 7.457em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.989em; left: -0.084em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.989em; left: 6.763em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 0.42em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 0.948em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 1.477em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 2.005em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 2.534em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 3.063em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 3.591em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 4.12em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 4.648em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 5.177em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 5.706em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 6.234em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(2.975em 1000em 4.503em -0.381em); top: -3.998em; left: 0em;"><span style="font-family: MathJax_Size1;">√</span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 8.56em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.259em; vertical-align: -1.514em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-85">\frac{dy}{dx} = 0.5 ~.*~\frac{1}{\sqrt{abs(x) ~.+ ~param}}</script><p></p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-86-Frame"><nobr><span class="math" id="MathJax-Span-968" style="width: 9.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.541em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.193em 1000em 3.787em -0.492em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-969"><span class="mfrac" id="MathJax-Span-970"><span style="display: inline-block; position: relative; width: 1.268em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.459em); top: -3.19em; left: 50%; margin-left: -0.519em;"><span class="mrow" id="MathJax-Span-971"><span class="mi" id="MathJax-Span-972" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-973" style="font-family: MathJax_Math; font-style: italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.459em); top: -1.828em; left: 50%; margin-left: -0.574em;"><span class="mrow" id="MathJax-Span-974"><span class="mi" id="MathJax-Span-975" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-976" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 1.268em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-977" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-978" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.268em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.656em 1000em 2.883em -0.459em); top: -3.195em; left: 50%; margin-left: -0.519em;"><span class="mrow" id="MathJax-Span-979"><span class="mi" id="MathJax-Span-980" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-981" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.459em); top: -1.828em; left: 50%; margin-left: -0.574em;"><span class="mrow" id="MathJax-Span-982"><span class="mi" id="MathJax-Span-983" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-984" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 1.268em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mtext" id="MathJax-Span-985" style="font-family: MathJax_Main; padding-left: 0.167em;">&nbsp;</span><span class="mo" id="MathJax-Span-986" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-987" style="font-family: MathJax_Main; padding-left: 0.167em;">∗</span><span class="mtext" id="MathJax-Span-988" style="font-family: MathJax_Main;">&nbsp;</span><span class="mfrac" id="MathJax-Span-989" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.158em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.459em); top: -3.19em; left: 50%; margin-left: -0.519em;"><span class="mrow" id="MathJax-Span-990"><span class="mi" id="MathJax-Span-991" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-992" style="font-family: MathJax_Math; font-style: italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.656em 1000em 2.883em -0.459em); top: -1.828em; left: 50%; margin-left: -0.519em;"><span class="mrow" id="MathJax-Span-993"><span class="mi" id="MathJax-Span-994" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-995" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 1.158em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.899em; vertical-align: -1.154em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-86">\frac{dz}{dx} = \frac{dy}{dx}~.*~ \frac{dz}{dy}</script><p></p><p>  where <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-87-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-996" style="width: 11.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.344em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.49em 1000em 3.411em -0.492em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-997"><span class="mfrac" id="MathJax-Span-998"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.586em 1000em 2.549em -0.468em); top: -2.798em; left: 50%; margin-left: -0.383em;"><span class="mrow" id="MathJax-Span-999"><span class="mi" id="MathJax-Span-1000" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1001" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.586em 1000em 2.412em -0.468em); top: -1.837em; left: 50%; margin-left: -0.41em;"><span class="mrow" id="MathJax-Span-1002"><span class="mi" id="MathJax-Span-1003" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1004" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 0.94em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-1005" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-1006" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="mfrac" id="MathJax-Span-1007"><span style="display: inline-block; position: relative; width: 1.268em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.586em 1000em 2.574em -0.468em); top: -2.823em; left: 50%; margin-left: -0.546em;"><span class="mrow" id="MathJax-Span-1008"><span class="mi" id="MathJax-Span-1009" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="msubsup" id="MathJax-Span-1010"><span style="display: inline-block; position: relative; width: 0.705em; height: 0px;"><span style="position: absolute; clip: rect(1.764em 1000em 2.549em -0.477em); top: -2.24em; left: 0em;"><span class="mi" id="MathJax-Span-1011" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; top: -2.016em; left: 0.378em;"><span class="mn" id="MathJax-Span-1012" style="font-size: 50%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.586em 1000em 2.51em -0.468em); top: -1.837em; left: 50%; margin-left: -0.574em;"><span class="mrow" id="MathJax-Span-1013"><span class="mi" id="MathJax-Span-1014" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="msubsup" id="MathJax-Span-1015"><span style="display: inline-block; position: relative; width: 0.763em; height: 0px;"><span style="position: absolute; clip: rect(1.764em 1000em 2.412em -0.467em); top: -2.24em; left: 0em;"><span class="mi" id="MathJax-Span-1016" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; top: -2.08em; left: 0.437em;"><span class="mn" id="MathJax-Span-1017" style="font-size: 50%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 1.268em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-1018" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="mo" id="MathJax-Span-1019" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-1020" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-1021" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-1022" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="mfrac" id="MathJax-Span-1023" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.322em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.586em 1000em 2.58em -0.468em); top: -2.828em; left: 50%; margin-left: -0.574em;"><span class="mrow" id="MathJax-Span-1024"><span class="mi" id="MathJax-Span-1025" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="msubsup" id="MathJax-Span-1026"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(1.764em 1000em 2.549em -0.477em); top: -2.24em; left: 0em;"><span class="mi" id="MathJax-Span-1027" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; top: -2.016em; left: 0.378em;"><span class="mi" id="MathJax-Span-1028" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.586em 1000em 2.516em -0.468em); top: -1.837em; left: 50%; margin-left: -0.601em;"><span class="mrow" id="MathJax-Span-1029"><span class="mi" id="MathJax-Span-1030" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="msubsup" id="MathJax-Span-1031"><span style="display: inline-block; position: relative; width: 0.818em; height: 0px;"><span style="position: absolute; clip: rect(1.764em 1000em 2.412em -0.467em); top: -2.24em; left: 0em;"><span class="mi" id="MathJax-Span-1032" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; top: -2.08em; left: 0.437em;"><span class="mi" id="MathJax-Span-1033" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 1.322em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1034"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-1035" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-1036" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.077em; vertical-align: -0.695em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-87">\frac{dy}{dx} = (\frac{dy_1}{dx_1}, ..., \frac{dy_n}{dx_n})^T</script></span>, and <code>param</code> is used for numeric stability.</p>
</li></ul>
</li><li><p>2-范数标准化: <code>y = vl_nnl2normalization(x, param, varargin)</code></p>
<ul>
<li><p><strong>正向传播</strong>:</p>
<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-88-Frame"><nobr><span class="math" id="MathJax-Span-1037" style="width: 5.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.426em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.45em 1000em 3.907em -0.471em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-1038"><span class="mi" id="MathJax-Span-1039" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-1040" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-1041" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 2.36em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -3.19em; left: 50%; margin-left: -0.301em;"><span class="mi" id="MathJax-Span-1042" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.818em 1000em 3.181em -0.373em); top: -2.006em; left: 50%; margin-left: -1.12em;"><span class="mrow" id="MathJax-Span-1043"><span class="texatom" id="MathJax-Span-1044"><span class="mrow" id="MathJax-Span-1045"><span class="mo" id="MathJax-Span-1046" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-1047"><span class="mrow" id="MathJax-Span-1048"><span class="mo" id="MathJax-Span-1049" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1050" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="texatom" id="MathJax-Span-1051"><span class="mrow" id="MathJax-Span-1052"><span class="mo" id="MathJax-Span-1053" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1054"><span style="display: inline-block; position: relative; width: 0.785em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.145em -0.373em); top: -2.732em; left: 0em;"><span class="texatom" id="MathJax-Span-1055"><span class="mrow" id="MathJax-Span-1056"><span class="mo" id="MathJax-Span-1057" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.011em; left: 0.328em;"><span class="mn" id="MathJax-Span-1058" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 2.36em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.731em; vertical-align: -1.3em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-88">y= \frac{x}{||x||_2}</script><p></p><p>  Note that <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-89-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-1059" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.883em -0.471em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-1060"><span class="mi" id="MathJax-Span-1061" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.923em; vertical-align: -0.317em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-89">y</script></span> is with the same size as <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-90-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-1062" style="width: 0.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.601em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-1063"><span class="mi" id="MathJax-Span-1064" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.686em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-90">x</script></span>.</p>
</li><li><p><strong>反向传播</strong>:</p>
<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-91-Frame"><nobr><span class="math" id="MathJax-Span-1065" style="width: 28.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 23.607em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(-1.141em 1000em 5.013em -0.325em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-1066"><span class="mtable" id="MathJax-Span-1067" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 23.279em; height: 0px;"><span style="position: absolute; clip: rect(2.301em 1000em 7.247em -0.492em); top: -5.628em; left: 0em;"><span style="display: inline-block; position: relative; width: 5.464em; height: 0px;"><span style="position: absolute; clip: rect(1.198em 1000em 3.907em -0.492em); top: -4.525em; right: 0em;"><span class="mtd" id="MathJax-Span-1068"><span class="mrow" id="MathJax-Span-1069"><span class="mfrac" id="MathJax-Span-1070"><span style="display: inline-block; position: relative; width: 1.65em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.656em 1000em 2.688em -0.459em); top: -3.19em; left: 50%; margin-left: -0.273em;"><span class="mi" id="MathJax-Span-1071" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.656em 1000em 2.972em -0.459em); top: -1.828em; left: 50%; margin-left: -0.765em;"><span class="mrow" id="MathJax-Span-1072"><span class="mi" id="MathJax-Span-1073" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-1074"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-1075" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-1076" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 1.65em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-1077" style="font-family: MathJax_Main; padding-left: 0.167em;">(</span><span class="mfrac" id="MathJax-Span-1078"><span style="display: inline-block; position: relative; width: 2.36em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -3.19em; left: 50%; margin-left: -0.301em;"><span class="mi" id="MathJax-Span-1079" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.818em 1000em 3.181em -0.373em); top: -2.006em; left: 50%; margin-left: -1.12em;"><span class="mrow" id="MathJax-Span-1080"><span class="texatom" id="MathJax-Span-1081"><span class="mrow" id="MathJax-Span-1082"><span class="mo" id="MathJax-Span-1083" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-1084"><span class="mrow" id="MathJax-Span-1085"><span class="mo" id="MathJax-Span-1086" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1087" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="texatom" id="MathJax-Span-1088"><span class="mrow" id="MathJax-Span-1089"><span class="mo" id="MathJax-Span-1090" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1091"><span style="display: inline-block; position: relative; width: 0.785em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.145em -0.373em); top: -2.732em; left: 0em;"><span class="texatom" id="MathJax-Span-1092"><span class="mrow" id="MathJax-Span-1093"><span class="mo" id="MathJax-Span-1094" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.011em; left: 0.328em;"><span class="mn" id="MathJax-Span-1095" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 2.36em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-1096" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(3.825em 1000em 4.153em -0.492em); top: -2.534em; right: 0em;"><span class="mtd" id="MathJax-Span-1156"><span class="mrow" id="MathJax-Span-1157"></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.628em;"></span></span><span style="position: absolute; clip: rect(3.477em 1000em 9.603em -0.214em); top: -6.776em; left: 5.464em;"><span style="display: inline-block; position: relative; width: 17.814em; height: 0px;"><span style="position: absolute; clip: rect(1.226em 1000em 4.104em -0.214em); top: -4.525em; left: 0em;"><span class="mtd" id="MathJax-Span-1097"><span class="mrow" id="MathJax-Span-1098"><span class="mo" id="MathJax-Span-1099" style="font-family: MathJax_Main; padding-left: 0.222em; padding-right: 0.333em;">=</span><span class="mfrac" id="MathJax-Span-1100"><span style="display: inline-block; position: relative; width: 2.36em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.902em 1000em 2.896em -0.409em); top: -3.409em; left: 50%; margin-left: -0.273em;"><span class="mn" id="MathJax-Span-1101" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.621em 1000em 3.181em -0.373em); top: -1.808em; left: 50%; margin-left: -1.12em;"><span class="mrow" id="MathJax-Span-1102"><span class="texatom" id="MathJax-Span-1103"><span class="mrow" id="MathJax-Span-1104"><span class="mo" id="MathJax-Span-1105" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-1106"><span class="mrow" id="MathJax-Span-1107"><span class="mo" id="MathJax-Span-1108" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1109" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="texatom" id="MathJax-Span-1110"><span class="mrow" id="MathJax-Span-1111"><span class="mo" id="MathJax-Span-1112" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1113"><span style="display: inline-block; position: relative; width: 0.785em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.145em -0.373em); top: -2.732em; left: 0em;"><span class="texatom" id="MathJax-Span-1114"><span class="mrow" id="MathJax-Span-1115"><span class="mo" id="MathJax-Span-1116" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.661em 1000em 2.475em -0.462em); top: -2.772em; left: 0.328em;"><span class="mn" id="MathJax-Span-1117" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.459em -0.456em); top: -2.011em; left: 0.328em;"><span class="mn" id="MathJax-Span-1118" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 2.36em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-1119" style="font-family: MathJax_Main; padding-left: 0.167em;">(</span><span class="msubsup" id="MathJax-Span-1120"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-1121" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.459em -0.456em); top: -2.64em; left: 0.601em;"><span class="mn" id="MathJax-Span-1122" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.459em -0.433em); top: -1.989em; left: 0.601em;"><span class="mn" id="MathJax-Span-1123" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-1124" style="font-family: MathJax_Main;">+</span><span class="mo" id="MathJax-Span-1125" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-1126" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-1127" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-1128" style="font-family: MathJax_Main; padding-left: 0.167em;">+</span><span class="msubsup" id="MathJax-Span-1129"><span style="display: inline-block; position: relative; width: 1.878em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-1130" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.459em -0.456em); top: -2.64em; left: 0.601em;"><span class="mn" id="MathJax-Span-1131" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.603em -0.5em); top: -1.989em; left: 0.601em;"><span class="texatom" id="MathJax-Span-1132"><span class="mrow" id="MathJax-Span-1133"><span class="mi" id="MathJax-Span-1134" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-1135" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1136" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-1137" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-1138" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.878em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-1139" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.459em -0.456em); top: -2.64em; left: 0.601em;"><span class="mn" id="MathJax-Span-1140" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.603em -0.5em); top: -1.989em; left: 0.601em;"><span class="texatom" id="MathJax-Span-1141"><span class="mrow" id="MathJax-Span-1142"><span class="mi" id="MathJax-Span-1143" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-1144" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1145" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-1146" style="font-family: MathJax_Main;">+</span><span class="mo" id="MathJax-Span-1147" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-1148" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-1149" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-1150" style="font-family: MathJax_Main; padding-left: 0.167em;">+</span><span class="msubsup" id="MathJax-Span-1151"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-1152" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.459em -0.456em); top: -2.64em; left: 0.601em;"><span class="mn" id="MathJax-Span-1153" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.764em 1000em 2.412em -0.477em); top: -2.092em; left: 0.601em;"><span class="mi" id="MathJax-Span-1154" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-1155" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(0.829em 1000em 4.104em -0.214em); top: -1.277em; left: 0em;"><span class="mtd" id="MathJax-Span-1158"><span class="mrow" id="MathJax-Span-1159"><span class="mo" id="MathJax-Span-1160" style="font-family: MathJax_Main; padding-left: 0.222em; padding-right: 0.333em;">=</span><span class="mfrac" id="MathJax-Span-1161"><span style="display: inline-block; position: relative; width: 2.36em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.902em 1000em 2.896em -0.409em); top: -3.409em; left: 50%; margin-left: -0.273em;"><span class="mn" id="MathJax-Span-1162" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.818em 1000em 3.181em -0.373em); top: -2.006em; left: 50%; margin-left: -1.12em;"><span class="mrow" id="MathJax-Span-1163"><span class="texatom" id="MathJax-Span-1164"><span class="mrow" id="MathJax-Span-1165"><span class="mo" id="MathJax-Span-1166" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-1167"><span class="mrow" id="MathJax-Span-1168"><span class="mo" id="MathJax-Span-1169" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1170" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="texatom" id="MathJax-Span-1171"><span class="mrow" id="MathJax-Span-1172"><span class="mo" id="MathJax-Span-1173" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1174"><span style="display: inline-block; position: relative; width: 0.785em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.145em -0.373em); top: -2.732em; left: 0em;"><span class="texatom" id="MathJax-Span-1175"><span class="mrow" id="MathJax-Span-1176"><span class="mo" id="MathJax-Span-1177" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.011em; left: 0.328em;"><span class="mn" id="MathJax-Span-1178" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 2.36em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-1179" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mfrac" id="MathJax-Span-1180" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 2.36em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.01em 1000em 4.6em -0.457em); top: -4.913em; left: 50%; margin-left: -0.529em;"><span class="msubsup" id="MathJax-Span-1181"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-1182" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.459em -0.456em); top: -2.64em; left: 0.601em;"><span class="mn" id="MathJax-Span-1183" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.609em 1000em 2.549em -0.5em); top: -1.937em; left: 0.601em;"><span class="mi" id="MathJax-Span-1184" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(1.621em 1000em 3.181em -0.373em); top: -1.808em; left: 50%; margin-left: -1.12em;"><span class="mrow" id="MathJax-Span-1185"><span class="texatom" id="MathJax-Span-1186"><span class="mrow" id="MathJax-Span-1187"><span class="mo" id="MathJax-Span-1188" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-1189"><span class="mrow" id="MathJax-Span-1190"><span class="mo" id="MathJax-Span-1191" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1192" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="texatom" id="MathJax-Span-1193"><span class="mrow" id="MathJax-Span-1194"><span class="mo" id="MathJax-Span-1195" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1196"><span style="display: inline-block; position: relative; width: 0.785em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.145em -0.373em); top: -2.732em; left: 0em;"><span class="texatom" id="MathJax-Span-1197"><span class="mrow" id="MathJax-Span-1198"><span class="mo" id="MathJax-Span-1199" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.661em 1000em 2.475em -0.462em); top: -2.772em; left: 0.328em;"><span class="mn" id="MathJax-Span-1200" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.459em -0.456em); top: -2.011em; left: 0.328em;"><span class="mn" id="MathJax-Span-1201" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 2.36em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.776em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 7.241em; vertical-align: -3.316em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-91">
  \begin{align}
  \frac{d}{dx_j}(\frac{x}{||x||_2}) & = \frac{1}{||x||_2^3}(x_1^2 + ... + x_{j-1}^2 + x_{j+1}^2 + ... + x_n^2)\\
  & = \frac{1}{||x||_2} - \frac{x_j^2} {||x||_2^ 3}

  \end{align}</script><p></p><p>  Which gives the vectorize form:</p>
<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-92-Frame"><nobr><span class="math" id="MathJax-Span-1202" style="width: 15.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.787em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.058em 1000em 4.104em -0.446em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-1203"><span class="mi" id="MathJax-Span-1204" style="font-family: MathJax_Main;">∇</span><span class="mo" id="MathJax-Span-1205" style="font-family: MathJax_Main;">(</span><span class="mfrac" id="MathJax-Span-1206"><span style="display: inline-block; position: relative; width: 2.36em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -3.19em; left: 50%; margin-left: -0.301em;"><span class="mi" id="MathJax-Span-1207" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.818em 1000em 3.181em -0.373em); top: -2.006em; left: 50%; margin-left: -1.12em;"><span class="mrow" id="MathJax-Span-1208"><span class="texatom" id="MathJax-Span-1209"><span class="mrow" id="MathJax-Span-1210"><span class="mo" id="MathJax-Span-1211" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-1212"><span class="mrow" id="MathJax-Span-1213"><span class="mo" id="MathJax-Span-1214" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1215" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="texatom" id="MathJax-Span-1216"><span class="mrow" id="MathJax-Span-1217"><span class="mo" id="MathJax-Span-1218" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1219"><span style="display: inline-block; position: relative; width: 0.785em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.145em -0.373em); top: -2.732em; left: 0em;"><span class="texatom" id="MathJax-Span-1220"><span class="mrow" id="MathJax-Span-1221"><span class="mo" id="MathJax-Span-1222" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.011em; left: 0.328em;"><span class="mn" id="MathJax-Span-1223" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 2.36em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-1224" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1225" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-1226" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 2.36em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.902em 1000em 2.896em -0.409em); top: -3.409em; left: 50%; margin-left: -0.273em;"><span class="mn" id="MathJax-Span-1227" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.818em 1000em 3.181em -0.373em); top: -2.006em; left: 50%; margin-left: -1.12em;"><span class="mrow" id="MathJax-Span-1228"><span class="texatom" id="MathJax-Span-1229"><span class="mrow" id="MathJax-Span-1230"><span class="mo" id="MathJax-Span-1231" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-1232"><span class="mrow" id="MathJax-Span-1233"><span class="mo" id="MathJax-Span-1234" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1235" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="texatom" id="MathJax-Span-1236"><span class="mrow" id="MathJax-Span-1237"><span class="mo" id="MathJax-Span-1238" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1239"><span style="display: inline-block; position: relative; width: 0.785em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.145em -0.373em); top: -2.732em; left: 0em;"><span class="texatom" id="MathJax-Span-1240"><span class="mrow" id="MathJax-Span-1241"><span class="mo" id="MathJax-Span-1242" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.011em; left: 0.328em;"><span class="mn" id="MathJax-Span-1243" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 2.36em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1244" style="font-family: MathJax_Main; padding-left: 0.167em;">&nbsp;</span><span class="mo" id="MathJax-Span-1245" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-1246" style="font-family: MathJax_Main; padding-left: 0.167em;">−</span><span class="mtext" id="MathJax-Span-1247" style="font-family: MathJax_Main;">&nbsp;</span><span class="mfrac" id="MathJax-Span-1248" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 2.36em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.516em 1000em 2.689em -0.457em); top: -3.19em; left: 50%; margin-left: -0.683em;"><span class="mrow" id="MathJax-Span-1249"><span class="mi" id="MathJax-Span-1250" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="msubsup" id="MathJax-Span-1251"><span style="display: inline-block; position: relative; width: 0.785em; height: 0px;"><span style="position: absolute; clip: rect(2.448em 1000em 2.896em -0.414em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-1252" style="font-family: MathJax_Main;">.</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.658em; left: 0.328em;"><span class="mn" id="MathJax-Span-1253" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.621em 1000em 3.181em -0.373em); top: -1.808em; left: 50%; margin-left: -1.12em;"><span class="mrow" id="MathJax-Span-1254"><span class="texatom" id="MathJax-Span-1255"><span class="mrow" id="MathJax-Span-1256"><span class="mo" id="MathJax-Span-1257" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-1258"><span class="mrow" id="MathJax-Span-1259"><span class="mo" id="MathJax-Span-1260" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1261" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="texatom" id="MathJax-Span-1262"><span class="mrow" id="MathJax-Span-1263"><span class="mo" id="MathJax-Span-1264" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1265"><span style="display: inline-block; position: relative; width: 0.785em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.145em -0.373em); top: -2.732em; left: 0em;"><span class="texatom" id="MathJax-Span-1266"><span class="mrow" id="MathJax-Span-1267"><span class="mo" id="MathJax-Span-1268" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.661em 1000em 2.475em -0.462em); top: -2.772em; left: 0.328em;"><span class="mn" id="MathJax-Span-1269" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.459em -0.456em); top: -2.011em; left: 0.328em;"><span class="mn" id="MathJax-Span-1270" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 2.36em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.45em; vertical-align: -1.541em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-92">
  \nabla(\frac{x}{||x||_2}) = \frac{1}{||x||_2} ~.-~ \frac{x.^2} {||x||_2^ 3}</script><p></p><p>  where <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-93-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-1271" style="width: 10.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.613em 1000em 3.203em -0.457em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-1272"><span class="mi" id="MathJax-Span-1273" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="msubsup" id="MathJax-Span-1274"><span style="display: inline-block; position: relative; width: 0.785em; height: 0px;"><span style="position: absolute; clip: rect(2.448em 1000em 2.896em -0.414em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-1275" style="font-family: MathJax_Main;">.</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.658em; left: 0.328em;"><span class="mn" id="MathJax-Span-1276" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-1277" style="font-family: MathJax_Main; padding-left: 0.167em;">=</span><span class="mo" id="MathJax-Span-1278" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="msubsup" id="MathJax-Span-1279"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-1280" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.459em -0.456em); top: -2.64em; left: 0.601em;"><span class="mn" id="MathJax-Span-1281" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.459em -0.433em); top: -1.989em; left: 0.601em;"><span class="mn" id="MathJax-Span-1282" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-1283" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1284" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-1285" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-1286" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-1287" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-1288" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-1289" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.459em -0.456em); top: -2.64em; left: 0.601em;"><span class="mn" id="MathJax-Span-1290" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.764em 1000em 2.412em -0.477em); top: -2.092em; left: 0.601em;"><span class="mi" id="MathJax-Span-1291" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1292"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-1293" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-1294" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.673em; vertical-align: -0.441em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-93">x.^2 = (x_1^2, ..., x_n^2)^T</script></span>.</p>
<pre><code data-origin="<pre><code>  To prevent large values and ensure numeric stability, it is recommended to preprocess ||x|| by adding a threshold:
</code></pre>">  To prevent large values and ensure numeric stability, it is recommended to preprocess ||x|| by adding a threshold:
</code></pre><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-94-Frame"><nobr><span class="math" id="MathJax-Span-1295" style="width: 13.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.148em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.181em -0.373em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-1296"><span class="texatom" id="MathJax-Span-1297"><span class="mrow" id="MathJax-Span-1298"><span class="mo" id="MathJax-Span-1299" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-1300"><span class="mrow" id="MathJax-Span-1301"><span class="mo" id="MathJax-Span-1302" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1303" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="texatom" id="MathJax-Span-1304"><span class="mrow" id="MathJax-Span-1305"><span class="mo" id="MathJax-Span-1306" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1307"><span style="display: inline-block; position: relative; width: 0.785em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.145em -0.373em); top: -2.732em; left: 0em;"><span class="texatom" id="MathJax-Span-1308"><span class="mrow" id="MathJax-Span-1309"><span class="mo" id="MathJax-Span-1310" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.011em; left: 0.328em;"><span class="mn" id="MathJax-Span-1311" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-1312" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="texatom" id="MathJax-Span-1313" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-1314"><span class="mo" id="MathJax-Span-1315" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-1316"><span class="mrow" id="MathJax-Span-1317"><span class="mo" id="MathJax-Span-1318" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1319" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="texatom" id="MathJax-Span-1320"><span class="mrow" id="MathJax-Span-1321"><span class="mo" id="MathJax-Span-1322" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1323"><span style="display: inline-block; position: relative; width: 0.785em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.145em -0.373em); top: -2.732em; left: 0em;"><span class="texatom" id="MathJax-Span-1324"><span class="mrow" id="MathJax-Span-1325"><span class="mo" id="MathJax-Span-1326" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.011em; left: 0.328em;"><span class="mn" id="MathJax-Span-1327" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-1328" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-1329" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">t</span><span class="mi" id="MathJax-Span-1330" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-1331" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-1332" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1333" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-1334" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-1335" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-1336" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-1337" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.395em; vertical-align: -0.414em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-94">||x||_2 = ||x||_2 + threshold</script><p></p></li></ul>
</li></ol><h4 id="2.5-训练方法"><a name="2.5-训练方法" href="#2.5-训练方法"></a>2.5 训练方法</h4><p>文章采用两步训练法:</p><ul>
<li><p><strong>第一步</strong>. 先用 双线性特征 训练一个 softmax 分类器。这实际上是一个凸优化问题，利用 SGD 算法可以很快得到最优解. 文章中将学习速率设为 <code>learningRate=0.001</code>, 训练了300个 <em>Epoch</em>. 实际上，将学习速率设为 <code>learningRate=0.06</code>, 可以在 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-95-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-1338" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.902em 1000em 2.918em -0.409em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-1339"><span class="mn" id="MathJax-Span-1340" style="font-family: MathJax_Main;">10</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.973em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-95">10</script></span> 个 <em>Epoch</em> 之内达到最优解。</p>
</li><li><p><strong>第二步</strong>. 在原始数据集上训练整个B-CNN模型, 即细调 (fine-tuning). 文章用 <code>learningRate=0.001</code> 训练100个<em>Epoch</em>.</p>
</li></ul><p><strong>注意</strong> 文章在第二步训练完成后，便将 softmax 分类器砍掉，重新训练一组SVM分类器.</p><h4 id="2.6-实验结果"><a name="2.6-实验结果" href="#2.6-实验结果"></a>2.6 实验结果</h4><ol>
<li><p><strong>细分类(fine-grained)数据集</strong></p>
<ul>
<li>鸟类: <a href="http://www.vision.caltech.edu/visipedia/CUB-200-2011.html">CUB-200-2011 dataset</a> 包含200类共11788张图片，其中接近一半的图片被划分为测试集. 具体参见该数据集下的 .txt 文件.</li><li>飞机: <a href="http://www.robots.ox.ac.uk/~vgg/data/oid/">FGVC aircraft dataset</a>包含100类共10000张图片。</li><li>汽车: <a href="http://ai.stanford.edu/~jkrause/cars/car_dataset.html">Stanford cars dataset</a> 包含196类共16185图片。<br>其中飞机和汽车两个数据集是 <strong>FGComp2013 challenge</strong> 的一部分.</li></ul>
</li><li><p><strong>参照组</strong></p>
<p> 文章中采用了 <a href="http://www.vlfeat.org/matconvnet/models/imagenet-vgg-m.mat"><code>imagenet-vgg-m.mat</code></a>, 在第 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-96-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-1341" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.891em 1000em 2.896em -0.409em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-1342"><span class="mn" id="MathJax-Span-1343" style="font-family: MathJax_Main;">14</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.959em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-96">14</script></span> 层 (<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-97-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-1344" style="width: 6.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.519em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.874em 1000em 3.062em -0.458em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-1345"><span class="mi" id="MathJax-Span-1346" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-1347" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-1348" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="msubsup" id="MathJax-Span-1349"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-1350" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="mn" id="MathJax-Span-1351" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-1352" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-1353" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">r</span><span class="mi" id="MathJax-Span-1354" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1355" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-1356" style="font-family: MathJax_Math; font-style: italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.182em; vertical-align: -0.269em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-97">conv_5+relu</script></span>)之后截断，称为 <code>M-Net</code>, 以及 <a href="http://www.vlfeat.org/matconvnet/models/imagenet-vgg-verydeep-16.mat"><code>imagenet-vgg-verydeep-16.mat</code></a>, 在第30层 (<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-98-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-1357" style="width: 7.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.23em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.874em 1000em 3.09em -0.458em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-1358"><span class="mi" id="MathJax-Span-1359" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-1360" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-1361" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="msubsup" id="MathJax-Span-1362"><span style="display: inline-block; position: relative; width: 1.66em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-1363" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="texatom" id="MathJax-Span-1364"><span class="mrow" id="MathJax-Span-1365"><span class="mn" id="MathJax-Span-1366" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span class="mi" id="MathJax-Span-1367" style="font-size: 70.7%; font-family: MathJax_Main;">_</span><span class="mn" id="MathJax-Span-1368" style="font-size: 70.7%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-1369" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-1370" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">r</span><span class="mi" id="MathJax-Span-1371" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-1372" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-1373" style="font-family: MathJax_Math; font-style: italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.216em; vertical-align: -0.303em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-98">conv_{5\_3} + relu</script></span>) 之后截断, 称为 <code>D-Net</code>, 这两个作为特征提取器。</p>
<ul>
<li><strong>Baseline</strong>, FC-CNN (Full-Connected CNN): FC-CNN[M], FC-CNN[D]</li><li>不同的特征提取器 + 不同的编码方式:<ul>
<li>特征提取器: SIFT, VGG-M (M-Net) 和 VGG-D (D-Net)</li><li>编码方式: FC, NetBoVW, VLAD, NetVLAD, FV, NetFV 和 BCNN.</li></ul>
</li><li>以前的文章</li></ul>
</li><li><p><strong>实验结果</strong></p>
<p> 实验结果见下图. 其中 <code>w/o ft</code> 表示 without fine-tuning， 即仅仅训练了第一步，而没有对整个B-CNN模型进行整体细调(fine-tuning)的结果. <code>w/ ft</code> 则表示细调之后的结果.</p>
<ul>
<li>对比 SIFT + FV 和 VGG-M/D + FV 的结果可以推断，这三个数据集上， CNN特征的性能明显比 SIFT 特征好. </li><li>对于同样的特征提取器来说，不同的编码方式，最终得到的结果之间差距十分巨大; 而对于同样的编码方式，特征提取器的重要性不亚于编码方式. 可以看到，特征提取器和编码方式可能互为瓶颈，从另一个方面来说，它们也是相辅相成，互相增益的.</li><li><p>对于多种编码方式，Bilinear-pool 的表现十分突出. 因此双线性编码似乎是目前表现最优的编码方式. 然而并没有理由表明, 双线性编码是最好的编码方式, 或许可以通过深入理解双线性编码来找到更好的编码方式. </p>
<div style="text-align:center"><img src="images/bcnn_results.png" align="middle"></div>

</li></ul>
</li></ol><h2 id="3.-b-cnn-模型复现&amp;评估"><a name="3.-b-cnn-模型复现&amp;评估" href="#3.-b-cnn-模型复现&amp;评估"></a>3. B-CNN 模型复现&amp;评估</h2><h4 id="3.1-b-cnn-模型复现情况"><a name="3.1-b-cnn-模型复现情况" href="#3.1-b-cnn-模型复现情况"></a>3.1 B-CNN 模型复现情况</h4><ol>
<li><strong>数据集</strong> <code>CUB-100-2011</code></li><li><strong>复现模型</strong> <code>B-CNN[M,M]</code>, <code>B-CNN[M,D]</code>, <code>B-CNN[D,D]</code></li><li><p><strong>复现情况</strong></p>
<table>
<thead>
<tr>
<th style="text-align:center">模型</th>
<th style="text-align:center">文章准确率</th>
<th style="text-align:center">复现准确率</th>
<th style="text-align:center">速度(X TITAN)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">B-CNN[M, M]</td>
<td style="text-align:center">78.1%</td>
<td style="text-align:center">77.56%</td>
<td style="text-align:center">37.5 fps</td>
</tr>
<tr>
<td style="text-align:center">B-CNN[D, D]</td>
<td style="text-align:center">84.0%</td>
<td style="text-align:center">83.90%</td>
<td style="text-align:center">6.7 fps</td>
</tr>
<tr>
<td style="text-align:center">B-CNN[M, D]</td>
<td style="text-align:center">84.1%</td>
<td style="text-align:center">83.83%</td>
<td style="text-align:center">6.7 fps</td>
</tr>
</tbody>
</table>
</li></ol><h4 id="3.2-b-cnn-模型在-`hikvision-car1000_data`-数据集上的表现"><a name="3.2-b-cnn-模型在-`hikvision-car1000_data`-数据集上的表现" href="#3.2-b-cnn-模型在-`hikvision-car1000_data`-数据集上的表现"></a>3.2 B-CNN 模型在 <code>Hikvision car1000_data</code> 数据集上的表现</h4><ol>
<li><p><strong>数据集</strong>. <code>car1000_data</code> 数据集包含1000类超过300,000张图片，测试集包含2946张图片，每张图片大小不一.</p>
</li><li><p><strong>评估方式</strong>. 为了评估B-CNN模型在我们车类数据集上的表现，本次评估选取了3中模型进行比较: FC-CNN[M], B-CNN[M], 和 B-CNN[D]. 输入到FC-CNN的图片被resize为<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-517-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-7482" style="width: 5.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.262em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.891em 1000em 2.896em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-7483"><span class="mn" id="MathJax-Span-7484" style="font-family: MathJax_Main;">224</span><span class="mo" id="MathJax-Span-7485" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mn" id="MathJax-Span-7486" style="font-family: MathJax_Main; padding-left: 0.222em;">224</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.959em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-517">224\times 224</script></span>大小， 输入到B-CNN[M/D]的图片则被resize为<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-518-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-7487" style="width: 5.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.262em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.891em 1000em 2.918em -0.464em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-7488"><span class="mn" id="MathJax-Span-7489" style="font-family: MathJax_Main;">448</span><span class="mo" id="MathJax-Span-7490" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mn" id="MathJax-Span-7491" style="font-family: MathJax_Main; padding-left: 0.222em;">448</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.986em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-518">448\times 448</script></span>的大小. VGG-M 提取的特征大小为 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-519-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-7492" style="width: 7.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.956em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.892em 1000em 2.918em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-7493"><span class="mn" id="MathJax-Span-7494" style="font-family: MathJax_Main;">27</span><span class="mo" id="MathJax-Span-7495" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mn" id="MathJax-Span-7496" style="font-family: MathJax_Main; padding-left: 0.222em;">27</span><span class="mo" id="MathJax-Span-7497" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mn" id="MathJax-Span-7498" style="font-family: MathJax_Main; padding-left: 0.222em;">512</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.985em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-519">27\times 27\times 512</script></span>, 而 VGG-D 提取的特征大小为 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-520-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-7499" style="width: 7.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.956em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.902em 1000em 2.918em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-7500"><span class="mn" id="MathJax-Span-7501" style="font-family: MathJax_Main;">28</span><span class="mo" id="MathJax-Span-7502" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mn" id="MathJax-Span-7503" style="font-family: MathJax_Main; padding-left: 0.222em;">28</span><span class="mo" id="MathJax-Span-7504" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mn" id="MathJax-Span-7505" style="font-family: MathJax_Main; padding-left: 0.222em;">512</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.973em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-520">28\times 28\times 512</script></span>. 最终编码后得到的双线性向量(bilinear vector)大小为 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-521-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-7506" style="width: 13.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.202em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-7507"><span class="mo" id="MathJax-Span-7508" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-7509" style="font-family: MathJax_Main;">512</span><span class="mo" id="MathJax-Span-7510" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mn" id="MathJax-Span-7511" style="font-family: MathJax_Main; padding-left: 0.222em;">512</span><span class="mo" id="MathJax-Span-7512" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-7513" style="font-family: MathJax_Main; padding-left: 0.278em;">262</span><span class="mo" id="MathJax-Span-7514" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-7515" style="font-family: MathJax_Main; padding-left: 0.167em;">144</span><span class="mo" id="MathJax-Span-7516" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-7517" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mn" id="MathJax-Span-7518" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-521">(512*512=262,144)\times 1</script></span>.</p>
</li><li><p><strong>训练方式</strong>. 训练的第一步(即先单独对softmax分类器进行训练)需要对所有的图片提取CNN特征并编码为262,144维的双线性向量并全部保存下来作为数据集，<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-522-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-7519" style="width: 17.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.699em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.863em 1000em 3.09em -0.45em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-7520"><span class="mn" id="MathJax-Span-7521" style="font-family: MathJax_Main;">300</span><span class="mo" id="MathJax-Span-7522" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-7523" style="font-family: MathJax_Main; padding-left: 0.167em;">000</span><span class="mo" id="MathJax-Span-7524" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mn" id="MathJax-Span-7525" style="font-family: MathJax_Main; padding-left: 0.222em;">262</span><span class="mo" id="MathJax-Span-7526" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-7527" style="font-family: MathJax_Main; padding-left: 0.167em;">144</span><span class="mo" id="MathJax-Span-7528" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mn" id="MathJax-Span-7529" style="font-family: MathJax_Main; padding-left: 0.222em;">32</span><span class="mo" id="MathJax-Span-7530" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-7531" style="font-family: MathJax_Main; padding-left: 0.278em;">300</span><span class="mi" id="MathJax-Span-7532" style="font-family: MathJax_Math; font-style: italic;">G</span><span class="mi" id="MathJax-Span-7533" style="font-family: MathJax_Math; font-style: italic;">B</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.23em; vertical-align: -0.303em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-522">300,000\times 262,144 \times 32 = 300 GB</script></span>, 也就是先构造一个300GB大小的数据集，并且在训练过程中，B-CNN 还会保存许多中间数据，这使得在我的工作站上无法进行训练(我的工作站/home目录当时只剩不到400GB).因此舍弃第一步。直接对softmax分类器的权重进行高斯随机初始化，然后执行训练的第二步.</p>
</li><li><p><strong>评估结果</strong>.</p>
<table>
<thead>
<tr>
<th style="text-align:center">模型</th>
<th style="text-align:center">训练方式</th>
<th style="text-align:center">准确率</th>
<th style="text-align:center">速度(X TITAN)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">F-CNN[M]</td>
<td style="text-align:center">lr0.001+20, lr0.0005+10</td>
<td style="text-align:center">92.27%</td>
<td style="text-align:center">55 fps</td>
</tr>
<tr>
<td style="text-align:center">B-CNN[M, M]</td>
<td style="text-align:center">lr0.001+10, lr0.0005+10</td>
<td style="text-align:center">96.xx%</td>
<td style="text-align:center">22 fps</td>
</tr>
<tr>
<td style="text-align:center">B-CNN[D, D]</td>
<td style="text-align:center">lr0.001+9, lr0.0001+</td>
<td style="text-align:center">9x.xx%</td>
<td style="text-align:center">6 fps</td>
</tr>
</tbody>
</table>
</li></ol><div style="text-align:center"><img src="images/car1000_error.png" align="middle"></div><h2 id="4-反思"><a name="4-反思" href="#4-反思"></a>4 反思</h2><h4 id="4.1-直观解释(intuition)"><a name="4.1-直观解释(intuition)" href="#4.1-直观解释(intuition)"></a>4.1 直观解释(intuition)</h4><p>直觉上，双线性类似于二次核的展开<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-729-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10562" style="width: 20.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.104em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.62em 1000em 3.326em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-10563"><span class="mo" id="MathJax-Span-10564" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-10565" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-10566"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10567" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-10568" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-10569" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-10570" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10571" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-10572" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-10573" style="font-family: MathJax_Main;">+</span><span class="mo" id="MathJax-Span-10574" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-10575" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-10576" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-10577" style="font-family: MathJax_Main; padding-left: 0.167em;">+</span><span class="msubsup" id="MathJax-Span-10578"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10579" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-10580" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-10581"><span style="display: inline-block; position: relative; width: 0.895em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-10582" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.772em; left: 0.437em;"><span class="mn" id="MathJax-Span-10583" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-10584" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="munderover" id="MathJax-Span-10585" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 4.228em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.436em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-10586" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.01em; left: 1.093em;"><span class="texatom" id="MathJax-Span-10587"><span class="mrow" id="MathJax-Span-10588"><span class="mi" id="MathJax-Span-10589" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-10590" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-10591" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-10592" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-10593" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-10594" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-10595" style="font-size: 70.7%; font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-10596" style="font-size: 70.7%; font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-10597" style="font-size: 70.7%; font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-10598" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-10599" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-10600" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10601" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-10602" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-10603"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10604" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-10605" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-10606" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.814em; vertical-align: -0.591em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-729">((x_1 + x_2 + ... + x_n)^2 = \sum_{i,j = 1, ...,n} x_ix_j)</script></span>, 通过考虑所有因子两两之间的相互作用，使得特征提取器 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-730-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10607" style="width: 1.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.317em 1000em 2.59em -0.437em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-10608"><span class="msubsup" id="MathJax-Span-10609"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.883em -0.437em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10610" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2em; left: 0.541em;"><span class="mi" id="MathJax-Span-10611" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.287em; vertical-align: -0.36em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-730">f_A</script></span> 和 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-731-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10612" style="width: 1.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.317em 1000em 2.59em -0.437em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-10613"><span class="msubsup" id="MathJax-Span-10614"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.883em -0.437em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10615" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2em; left: 0.541em;"><span class="mi" id="MathJax-Span-10616" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">B</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.287em; vertical-align: -0.36em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-731">f_B</script></span> 的输出互为条件.<br>(Intuitively, the bilinear form allows the outputs of the feature extractors <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-732-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10617" style="width: 1.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.317em 1000em 2.59em -0.437em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-10618"><span class="msubsup" id="MathJax-Span-10619"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.883em -0.437em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10620" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2em; left: 0.541em;"><span class="mi" id="MathJax-Span-10621" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.287em; vertical-align: -0.36em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-732">f_A</script></span> and <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-733-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10622" style="width: 1.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.317em 1000em 2.59em -0.437em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-10623"><span class="msubsup" id="MathJax-Span-10624"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.883em -0.437em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10625" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2em; left: 0.541em;"><span class="mi" id="MathJax-Span-10626" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">B</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.287em; vertical-align: -0.36em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-733">f_B</script></span> to be conditioned on each other by considering all their paire-wise interactions similar to a quadratic kernel expansion.)</p><p>考虑性别识别任务. 一种方法是首先训练一个 gender-neutral 的人脸探测器, 随后用一个性别分类器进行分类. 然而，更好的方法也许是直接训练一个 gender-specific 的人脸探测器. 双线性模型就是这样一种方法. 通过特征提取器 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-734-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10627" style="width: 1.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.317em 1000em 2.59em -0.437em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-10628"><span class="msubsup" id="MathJax-Span-10629"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.883em -0.437em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10630" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2em; left: 0.541em;"><span class="mi" id="MathJax-Span-10631" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.287em; vertical-align: -0.36em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-734">f_A</script></span> 和 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-735-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10632" style="width: 1.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.317em 1000em 2.59em -0.437em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-10633"><span class="msubsup" id="MathJax-Span-10634"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.883em -0.437em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10635" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2em; left: 0.541em;"><span class="mi" id="MathJax-Span-10636" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">B</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.287em; vertical-align: -0.36em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-735">f_B</script></span> 的联合训练 (jointly training)， 双线性模型可以基于训练数据对这些特征的表达进行有效的折中.<br>(Considering the task of gender recognition. One approach is to first train a gender-neutral face detector and followed by a gender classifier. However, it may be better to train a gender-specific face detector instead. By jointly training <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-736-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10637" style="width: 1.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.317em 1000em 2.59em -0.437em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-10638"><span class="msubsup" id="MathJax-Span-10639"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.883em -0.437em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10640" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2em; left: 0.541em;"><span class="mi" id="MathJax-Span-10641" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.287em; vertical-align: -0.36em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-736">f_A</script></span> and <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-737-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10642" style="width: 1.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.317em 1000em 2.59em -0.437em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-10643"><span class="msubsup" id="MathJax-Span-10644"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.883em -0.437em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10645" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2em; left: 0.541em;"><span class="mi" id="MathJax-Span-10646" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">B</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.287em; vertical-align: -0.36em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-737">f_B</script></span> the bilinear model can effectly trade-off the representation power of the features based on the data.)</p><h4 id="4.2-从训练的过程看双线性模型"><a name="4.2-从训练的过程看双线性模型" href="#4.2-从训练的过程看双线性模型"></a>4.2 从训练的过程看双线性模型</h4><p>双线性模型对两个因子之间的相互作用进行建模, 即对于两个因子<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-738-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10647" style="width: 1.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.093em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.58em 1000em 2.5em -0.457em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-10648"><span class="msubsup" id="MathJax-Span-10649"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10650" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-10651" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.856em; vertical-align: -0.25em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-738">x_1</script></span> 和 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-739-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10652" style="width: 1.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.093em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.58em 1000em 2.5em -0.457em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-10653"><span class="msubsup" id="MathJax-Span-10654"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10655" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-10656" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.856em; vertical-align: -0.25em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-739">x_2</script></span>, 考虑它们的乘子 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-740-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10657" style="width: 2.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.131em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.58em 1000em 2.5em -0.457em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-10658"><span class="msubsup" id="MathJax-Span-10659"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10660" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-10661" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-10662"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10663" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-10664" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.856em; vertical-align: -0.25em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-740">x_1x_2</script></span>, 给定其中一个因子, 该乘子对另一个因子呈线性关系.</p><p>在进行分类时, softmax分类器赋予每一个乘子 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-741-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10665" style="width: 2.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.967em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.58em 1000em 2.644em -0.457em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-10666"><span class="msubsup" id="MathJax-Span-10667"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10668" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-10669" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-10670"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10671" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-10672" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.032em; vertical-align: -0.426em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-741">x_ix_j</script></span> 一个权重 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-742-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10673" style="width: 1.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.421em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.579em 1000em 2.644em -0.471em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-10674"><span class="msubsup" id="MathJax-Span-10675"><span style="display: inline-block; position: relative; width: 1.386em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10676" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.765em;"><span class="texatom" id="MathJax-Span-10677"><span class="mrow" id="MathJax-Span-10678"><span class="mi" id="MathJax-Span-10679" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-10680" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.033em; vertical-align: -0.426em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-742">w_{ij}</script></span> 并全部相加, 根据相加的结果决定最终的类别. 由于 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-743-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10681" style="width: 1.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.58em 1000em 2.508em -0.457em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-10682"><span class="msubsup" id="MathJax-Span-10683"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10684" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-10685" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.865em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-743">x_i</script></span> 和 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-744-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10686" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.58em 1000em 2.644em -0.457em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-10687"><span class="msubsup" id="MathJax-Span-10688"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10689" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-10690" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.032em; vertical-align: -0.426em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-744">x_j</script></span> 的相互作用, 在训练阶段, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-745-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10691" style="width: 1.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.421em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.579em 1000em 2.644em -0.471em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-10692"><span class="msubsup" id="MathJax-Span-10693"><span style="display: inline-block; position: relative; width: 1.386em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10694" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.765em;"><span class="texatom" id="MathJax-Span-10695"><span class="mrow" id="MathJax-Span-10696"><span class="mi" id="MathJax-Span-10697" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-10698" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.033em; vertical-align: -0.426em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-745">w_{ij}</script></span> 同时受这两个因子影响, 最终学习到一个折中值. </p><p>考虑单个神经元(neuron), 它接受输入 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-746-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10699" style="width: 1.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.58em 1000em 2.508em -0.457em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-10700"><span class="msubsup" id="MathJax-Span-10701"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10702" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-10703" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.865em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-746">x_i</script></span> 和 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-747-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10704" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.58em 1000em 2.644em -0.457em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-10705"><span class="msubsup" id="MathJax-Span-10706"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10707" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-10708" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.032em; vertical-align: -0.426em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-747">x_j</script></span>, 并输出 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-748-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10709" style="width: 7.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.503em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.19em -0.471em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-10710"><span class="mi" id="MathJax-Span-10711" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-10712" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-10713" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-10714" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-10715"><span style="display: inline-block; position: relative; width: 1.386em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10716" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.765em;"><span class="texatom" id="MathJax-Span-10717"><span class="mrow" id="MathJax-Span-10718"><span class="mi" id="MathJax-Span-10719" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-10720" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-10721"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10722" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-10723" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-10724"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10725" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-10726" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-10727" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.407em; vertical-align: -0.426em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-748">y = f(w_{ij}x_ix_j)</script></span>. 对应的梯度为 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-749-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10728" style="width: 12.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.109em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.52em 1000em 3.507em -0.492em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-10729"><span class="mfrac" id="MathJax-Span-10730"><span style="display: inline-block; position: relative; width: 1.486em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.586em 1000em 2.549em -0.468em); top: -2.798em; left: 50%; margin-left: -0.383em;"><span class="mrow" id="MathJax-Span-10731"><span class="mi" id="MathJax-Span-10732" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-10733" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.586em 1000em 2.612em -0.468em); top: -1.837em; left: 50%; margin-left: -0.683em;"><span class="mrow" id="MathJax-Span-10734"><span class="mi" id="MathJax-Span-10735" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="msubsup" id="MathJax-Span-10736"><span style="display: inline-block; position: relative; width: 0.982em; height: 0px;"><span style="position: absolute; clip: rect(1.763em 1000em 2.412em -0.477em); top: -2.24em; left: 0em;"><span class="mi" id="MathJax-Span-10737" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; top: -2.08em; left: 0.546em;"><span class="texatom" id="MathJax-Span-10738"><span class="mrow" id="MathJax-Span-10739"><span class="mi" id="MathJax-Span-10740" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-10741" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 1.486em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-10742" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-10743" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10744" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-10745" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-10746"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10747" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-10748" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-10749"><span style="display: inline-block; position: relative; width: 0.963em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.883em -0.437em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10750" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.727em; left: 0.669em;"><span class="texatom" id="MathJax-Span-10751"><span class="mrow" id="MathJax-Span-10752"><span class="mi" id="MathJax-Span-10753" style="font-size: 70.7%; font-family: MathJax_Main;">′</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-10754" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-10755"><span style="display: inline-block; position: relative; width: 1.386em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10756" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.765em;"><span class="texatom" id="MathJax-Span-10757"><span class="mrow" id="MathJax-Span-10758"><span class="mi" id="MathJax-Span-10759" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-10760" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-10761"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10762" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-10763" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-10764"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10765" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-10766" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-10767" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.158em; vertical-align: -0.812em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-749">\frac{dy}{dw_{ij}} = x_ix_jf^{\prime}(w_{ij}x_ix_j)</script></span>. 在利用简单的SGD算法进行训练时, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-750-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10768" style="width: 1.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.421em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.579em 1000em 2.644em -0.471em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-10769"><span class="msubsup" id="MathJax-Span-10770"><span style="display: inline-block; position: relative; width: 1.386em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10771" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.765em;"><span class="texatom" id="MathJax-Span-10772"><span class="mrow" id="MathJax-Span-10773"><span class="mi" id="MathJax-Span-10774" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-10775" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.033em; vertical-align: -0.426em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-750">w_{ij}</script></span>根据<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-751-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10776" style="width: 9.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.033em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.52em 1000em 3.507em -0.471em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-10777"><span class="msubsup" id="MathJax-Span-10778"><span style="display: inline-block; position: relative; width: 1.386em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10779" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.765em;"><span class="texatom" id="MathJax-Span-10780"><span class="mrow" id="MathJax-Span-10781"><span class="mi" id="MathJax-Span-10782" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-10783" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-10784" style="font-family: MathJax_Main; padding-left: 0.278em;">:<span style="font-family: MathJax_Main; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-10785" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.386em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10786" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.765em;"><span class="texatom" id="MathJax-Span-10787"><span class="mrow" id="MathJax-Span-10788"><span class="mi" id="MathJax-Span-10789" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-10790" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-10791" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-10792" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="mfrac" id="MathJax-Span-10793" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.486em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.586em 1000em 2.549em -0.468em); top: -2.798em; left: 50%; margin-left: -0.383em;"><span class="mrow" id="MathJax-Span-10794"><span class="mi" id="MathJax-Span-10795" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-10796" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.586em 1000em 2.612em -0.468em); top: -1.837em; left: 50%; margin-left: -0.683em;"><span class="mrow" id="MathJax-Span-10797"><span class="mi" id="MathJax-Span-10798" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="msubsup" id="MathJax-Span-10799"><span style="display: inline-block; position: relative; width: 0.982em; height: 0px;"><span style="position: absolute; clip: rect(1.763em 1000em 2.412em -0.477em); top: -2.24em; left: 0em;"><span class="mi" id="MathJax-Span-10800" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; top: -2.08em; left: 0.546em;"><span class="texatom" id="MathJax-Span-10801"><span class="mrow" id="MathJax-Span-10802"><span class="mi" id="MathJax-Span-10803" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-10804" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 1.486em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.158em; vertical-align: -0.812em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-751">w_{ij}:=w_{ij} - \gamma\frac{dy}{dw_{ij}}</script></span> 进行更新. 可见, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-752-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10805" style="width: 1.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.58em 1000em 2.508em -0.457em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-10806"><span class="msubsup" id="MathJax-Span-10807"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10808" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-10809" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.865em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-752">x_i</script></span> 和 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-753-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10810" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.58em 1000em 2.644em -0.457em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-10811"><span class="msubsup" id="MathJax-Span-10812"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10813" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-10814" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.032em; vertical-align: -0.426em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-753">x_j</script></span> 中的任何一个发生变化, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-754-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10815" style="width: 1.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.421em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.579em 1000em 2.644em -0.471em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-10816"><span class="msubsup" id="MathJax-Span-10817"><span style="display: inline-block; position: relative; width: 1.386em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10818" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.765em;"><span class="texatom" id="MathJax-Span-10819"><span class="mrow" id="MathJax-Span-10820"><span class="mi" id="MathJax-Span-10821" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-10822" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.033em; vertical-align: -0.426em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-754">w_{ij}</script></span> 都会及时随之进行调整，从而同时向它们学习.</p><p>分析到这里, <strong>一个自然的问题是, 为什么是简单的线性相乘？ 是否可以用一个更高阶的非线性函数 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-755-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10823" style="width: 5.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.59em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.768em 1000em 3.19em -0.437em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-10824"><span class="mi" id="MathJax-Span-10825" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-10826" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-10827"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10828" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-10829" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-10830" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-10831" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10832" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-10833" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-10834" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-10835"><span class="mrow" id="MathJax-Span-10836"><span class="mo" id="MathJax-Span-10837"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 82%; font-style: normal; font-weight: normal;">对</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.468em; vertical-align: -0.426em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-755">f(x_i, x_j)对 </script></span>x_i<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-756-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10838" style="width: 1.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.222em 1000em 2.55em -0.492em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-10839"><span class="texatom" id="MathJax-Span-10840"><span class="mrow" id="MathJax-Span-10841"><span class="mo" id="MathJax-Span-10842"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 82%; font-style: normal; font-weight: normal;">和</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.311em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-756"> 和 </script></span>x_j$ 的相互作用进行建模</strong>?</p><p>我们看到, 该双线性模型中计算了所有因子两两之间的内积, 在这一点上, <strong>是否可以应用核技巧(kernel trick)</strong>?</p><h4 id="4.3-对称双线性模型(symmetric-bilinear-model)跟方差有什么关系？"><a name="4.3-对称双线性模型(symmetric-bilinear-model)跟方差有什么关系？" href="#4.3-对称双线性模型(symmetric-bilinear-model)跟方差有什么关系？"></a>4.3 对称双线性模型(symmetric bilinear model)跟方差有什么关系？</h4><p>对于对称双线性模型， 文章中的双线性模块不过是将经平方根标准化和2-范数标准化后的 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-757-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10843" style="width: 2.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.35em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.461em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-10844"><span class="msubsup" id="MathJax-Span-10845"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10846" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.65em; left: 0.932em;"><span class="mi" id="MathJax-Span-10847" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-10848" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.218em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-757">X^TX</script></span> 传递给后面的分类器. 注意到， 当矩阵 X 的行均值为零即 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-758-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10849" style="width: 6.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.973em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.326em -0.436em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-10850"><span class="munderover" id="MathJax-Span-10851"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.436em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-10852" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -1.955em; left: 1.093em;"><span class="mi" id="MathJax-Span-10853" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-10854" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.472em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10855" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="texatom" id="MathJax-Span-10856"><span class="mrow" id="MathJax-Span-10857"><span class="mi" id="MathJax-Span-10858" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-10859" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-10860" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-10861" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.572em; vertical-align: -0.591em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-758">\sum_jX_{ij} = 0</script></span> 时，<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-759-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10862" style="width: 2.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.35em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.461em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-10863"><span class="msubsup" id="MathJax-Span-10864"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10865" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.65em; left: 0.932em;"><span class="mi" id="MathJax-Span-10866" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-10867" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.218em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-759">X^TX</script></span> 实际上为矩阵 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-760-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10868" style="width: 1.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.53em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.133em 1000em 2.35em -0.466em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-10869"><span class="msubsup" id="MathJax-Span-10870"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10871" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.65em; left: 0.932em;"><span class="mi" id="MathJax-Span-10872" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.218em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-760">X^T</script></span> 的方差矩阵. 且看 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-761-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10873" style="width: 1.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.874em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-10874"><span class="mi" id="MathJax-Span-10875" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-761">X</script></span> 的方差矩阵公式: </p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-762-Frame"><nobr><span class="math" id="MathJax-Span-10876" style="width: 35.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 29.235em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(-0.418em 1000em 4.289em -0.325em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-10877"><span class="mtable" id="MathJax-Span-10878" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 28.907em; height: 0px;"><span style="position: absolute; clip: rect(2.1em 1000em 5.723em -0.492em); top: -4.317em; left: 0em;"><span style="display: inline-block; position: relative; width: 14.426em; height: 0px;"><span style="position: absolute; clip: rect(1.613em 1000em 3.146em -0.442em); top: -3.829em; right: 0em;"><span class="mtd" id="MathJax-Span-10879"><span class="mrow" id="MathJax-Span-10880"><span class="mi" id="MathJax-Span-10881" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="mi" id="MathJax-Span-10882" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-10883" style="font-family: MathJax_Math; font-style: italic;">v</span><span class="mo" id="MathJax-Span-10884" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-10885" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-10886" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-10887" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-10888" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-10889" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-10890" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="msubsup" id="MathJax-Span-10891"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10892" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.653em; left: 0.932em;"><span class="mi" id="MathJax-Span-10893" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-10894" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-10895" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-10896" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-10897" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-10898" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-10899" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-10900" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="msubsup" id="MathJax-Span-10901"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-10902" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-10903" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(3.825em 1000em 4.153em -0.492em); top: -2.747em; right: 0em;"><span class="mtd" id="MathJax-Span-10929"><span class="mrow" id="MathJax-Span-10930"></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.317em;"></span></span><span style="position: absolute; clip: rect(2.752em 1000em 7.459em -0.214em); top: -5.355em; left: 14.426em;"><span style="display: inline-block; position: relative; width: 14.481em; height: 0px;"><span style="position: absolute; clip: rect(1.226em 1000em 3.593em -0.214em); top: -3.829em; left: 0em;"><span class="mtd" id="MathJax-Span-10904"><span class="mrow" id="MathJax-Span-10905"><span class="mo" id="MathJax-Span-10906" style="font-family: MathJax_Main; padding-left: 0.222em; padding-right: 0.333em;">=</span><span class="mfrac" id="MathJax-Span-10907"><span style="display: inline-block; position: relative; width: 2.47em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.902em 1000em 2.896em -0.409em); top: -3.409em; left: 50%; margin-left: -0.273em;"><span class="mn" id="MathJax-Span-10908" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.902em 1000em 2.907em -0.471em); top: -2.046em; left: 50%; margin-left: -1.175em;"><span class="mrow" id="MathJax-Span-10909"><span class="mi" id="MathJax-Span-10910" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-10911" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mn" id="MathJax-Span-10912" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 2.47em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-10913" style="font-family: MathJax_Main; padding-left: 0.167em;">(</span><span class="mi" id="MathJax-Span-10914" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="msubsup" id="MathJax-Span-10915"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10916" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.653em; left: 0.932em;"><span class="mi" id="MathJax-Span-10917" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-10918" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-10919" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">n</span><span class="mi" id="MathJax-Span-10920" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-10921" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-10922" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-10923" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-10924" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="msubsup" id="MathJax-Span-10925"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-10926" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-10927" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-10928" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.226em 1000em 3.593em -0.214em); top: -1.49em; left: 0em;"><span class="mtd" id="MathJax-Span-10931"><span class="mrow" id="MathJax-Span-10932"><span class="mo" id="MathJax-Span-10933" style="font-family: MathJax_Main; padding-left: 0.222em; padding-right: 0.333em;">=</span><span class="mfrac" id="MathJax-Span-10934"><span style="display: inline-block; position: relative; width: 2.47em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.902em 1000em 2.896em -0.409em); top: -3.409em; left: 50%; margin-left: -0.273em;"><span class="mn" id="MathJax-Span-10935" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.902em 1000em 2.907em -0.471em); top: -2.046em; left: 50%; margin-left: -1.175em;"><span class="mrow" id="MathJax-Span-10936"><span class="mi" id="MathJax-Span-10937" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-10938" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mn" id="MathJax-Span-10939" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 2.47em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-10940" style="font-family: MathJax_Main; padding-left: 0.167em;">(</span><span class="mi" id="MathJax-Span-10941" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="msubsup" id="MathJax-Span-10942"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-10943" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.653em; left: 0.932em;"><span class="mi" id="MathJax-Span-10944" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-10945" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mfrac" id="MathJax-Span-10946" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.721em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.902em 1000em 2.896em -0.409em); top: -3.409em; left: 50%; margin-left: -0.273em;"><span class="mn" id="MathJax-Span-10947" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.471em); top: -1.828em; left: 50%; margin-left: -0.301em;"><span class="mi" id="MathJax-Span-10948" style="font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 0.721em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-10949" style="font-family: MathJax_Main; padding-left: 0.167em;">(</span><span class="mi" id="MathJax-Span-10950" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mi" id="MathJax-Span-10951" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mo" id="MathJax-Span-10952" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-10953" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-10954" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mi" id="MathJax-Span-10955" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="msubsup" id="MathJax-Span-10956"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-10957" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-10958" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-10959" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.355em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 5.476em; vertical-align: -2.433em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-762">
  \begin{align}
    Cov(X) = E(XX^T) - EX(EX)^T &= \frac{1}{n-1}(XX^T - nEX(EX)^T)\\
    &= \frac{1}{n-1}(XX^T - \frac{1}{n}(Xe)(Xe)^T)
  \end{align}</script><p></p><p>其中， <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-763-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10960" style="width: 0.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.601em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-10961"><span class="mi" id="MathJax-Span-10962" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.686em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-763">n</script></span>是矩阵 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-764-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10963" style="width: 1.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.874em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-10964"><span class="mi" id="MathJax-Span-10965" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-764">X</script></span> 的列数, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-765-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10966" style="width: 4.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.77em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.779em 1000em 3.146em -0.453em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-10967"><span class="mi" id="MathJax-Span-10968" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mo" id="MathJax-Span-10969" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="mo" id="MathJax-Span-10970" style="font-family: MathJax_Main; padding-left: 0.278em;">{</span><span class="mn" id="MathJax-Span-10971" style="font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-10972"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.427em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-10973" style="font-family: MathJax_Main;">}</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.546em;"><span class="mi" id="MathJax-Span-10974" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.402em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-765">e\in \{1\}^n</script></span>. 上式的第二个等号利用了方差的定义式<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-766-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10975" style="width: 38.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 31.585em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.613em 1000em 3.287em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-10976"><span class="mi" id="MathJax-Span-10977" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="mi" id="MathJax-Span-10978" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-10979" style="font-family: MathJax_Math; font-style: italic;">v</span><span class="mo" id="MathJax-Span-10980" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-10981" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-10982" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-10983" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-10984" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-10985" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-10986" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-10987" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-10988" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-10989" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-10990" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-10991" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-10992" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-10993" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-10994" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-10995" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="msubsup" id="MathJax-Span-10996"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-10997" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-10998" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-10999" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-11000" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.486em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.66em 1000em 2.459em -0.433em); top: -2.708em; left: 50%; margin-left: -0.191em;"><span class="mn" id="MathJax-Span-11001" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.467em -0.477em); top: -1.912em; left: 50%; margin-left: -0.683em;"><span class="mrow" id="MathJax-Span-11002"><span class="mi" id="MathJax-Span-11003" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-11004" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-11005" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 1.486em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="munderover" id="MathJax-Span-11006" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 2.479em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.436em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-11007" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.764em 1000em 2.412em -0.477em); top: -2.717em; left: 1.093em;"><span class="texatom" id="MathJax-Span-11008"><span class="mrow" id="MathJax-Span-11009"><span class="mi" id="MathJax-Span-11010" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.64em 1000em 2.467em -0.458em); top: -2.01em; left: 1.093em;"><span class="texatom" id="MathJax-Span-11011"><span class="mrow" id="MathJax-Span-11012"><span class="mi" id="MathJax-Span-11013" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-11014" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-11015" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-11016" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-11017"><span style="display: inline-block; position: relative; width: 1.526em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11018" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.85em;"><span class="texatom" id="MathJax-Span-11019"><span class="mrow" id="MathJax-Span-11020"><span class="mo" id="MathJax-Span-11021" style="font-size: 70.7%; font-family: MathJax_Main;">.</span><span class="mi" id="MathJax-Span-11022" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-11023" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-11024" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-11025" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-11026" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-11027" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-11028"><span style="display: inline-block; position: relative; width: 1.526em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11029" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.85em;"><span class="texatom" id="MathJax-Span-11030"><span class="mrow" id="MathJax-Span-11031"><span class="mo" id="MathJax-Span-11032" style="font-size: 70.7%; font-family: MathJax_Main;">.</span><span class="mi" id="MathJax-Span-11033" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-11034" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-11035" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-11036" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="msubsup" id="MathJax-Span-11037"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-11038" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-11039" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.777em; vertical-align: -0.544em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-766">Cov(X) = E(X-EX)(X-EX)^T = \frac{1}{n-1}\sum_{k=1}^{n} (X_{.k} - EX)(X_{.k}-EX)^T</script></span> 以及均值定义式 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-767-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11040" style="width: 9.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.087em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.685em 1000em 3.249em -0.461em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11041"><span class="mi" id="MathJax-Span-11042" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-11043" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-11044" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-11045" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.66em 1000em 2.459em -0.433em); top: -2.708em; left: 50%; margin-left: -0.191em;"><span class="mn" id="MathJax-Span-11046" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.764em 1000em 2.412em -0.477em); top: -1.896em; left: 50%; margin-left: -0.219em;"><span class="mi" id="MathJax-Span-11047" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 0.557em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="munderover" id="MathJax-Span-11048" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 2.479em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.436em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-11049" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.764em 1000em 2.412em -0.477em); top: -2.717em; left: 1.093em;"><span class="texatom" id="MathJax-Span-11050"><span class="mrow" id="MathJax-Span-11051"><span class="mi" id="MathJax-Span-11052" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.64em 1000em 2.467em -0.458em); top: -2.01em; left: 1.093em;"><span class="texatom" id="MathJax-Span-11053"><span class="mrow" id="MathJax-Span-11054"><span class="mi" id="MathJax-Span-11055" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-11056" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-11057" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-11058" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.526em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11059" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.85em;"><span class="texatom" id="MathJax-Span-11060"><span class="mrow" id="MathJax-Span-11061"><span class="mo" id="MathJax-Span-11062" style="font-size: 70.7%; font-family: MathJax_Main;">.</span><span class="mi" id="MathJax-Span-11063" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.641em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-767">EX = \frac{1}{n}\sum_{k=1}^{n} X_{.k}</script></span>. 第三个等号只利用了均值定义式.</p><p>可见当 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-768-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11064" style="width: 3.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.169em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.885em 1000em 2.918em -0.466em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11065"><span class="mi" id="MathJax-Span-11066" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mi" id="MathJax-Span-11067" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mo" id="MathJax-Span-11068" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-11069" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-768">Xe = 0</script></span>, 也就是矩阵<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-769-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11070" style="width: 1.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.874em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-11071"><span class="mi" id="MathJax-Span-11072" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-769">X</script></span> 的行和为0时， <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-770-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11073" style="width: 2.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.35em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.461em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-11074"><span class="msubsup" id="MathJax-Span-11075"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11076" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.65em; left: 0.932em;"><span class="mi" id="MathJax-Span-11077" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-11078" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.218em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-770">X^TX</script></span> 即为 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-771-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11079" style="width: 1.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.53em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.133em 1000em 2.35em -0.466em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-11080"><span class="msubsup" id="MathJax-Span-11081"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11082" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.65em; left: 0.932em;"><span class="mi" id="MathJax-Span-11083" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.218em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-771">X^T</script></span>的方差矩阵.</p><p>联系到文章中，<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-772-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11084" style="width: 1.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.874em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-11085"><span class="mi" id="MathJax-Span-11086" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-772">X</script></span> 是由卷积网络提取的特征矩阵, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-773-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11087" style="width: 1.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.874em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-11088"><span class="mi" id="MathJax-Span-11089" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-773">X</script></span> 的每一列是对应一个特征图(feature map) reshape后的列向量，<strong><span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-774-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11090" style="width: 1.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.53em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.133em 1000em 2.35em -0.466em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-11091"><span class="msubsup" id="MathJax-Span-11092"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11093" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.65em; left: 0.932em;"><span class="mi" id="MathJax-Span-11094" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.218em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-774">X^T</script></span>的方差的统计意义即是各个特征图之间的相关性</strong>.</p><p>那么问题来了,</p><ul>
<li>卷积网提取的特征是否隐含了这样一个性质: <strong>所有的特征图相加结果为0</strong>？</li></ul><p>亦或者,</p><ul>
<li>对称双线性模型是否隐含了这样一个约束： <strong>所有的特征图相加结果为0</strong>？</li></ul><p>稍加思考即可发现, X 是CNN网络最后一个卷积层经过 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-775-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11095" style="width: 2.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.803em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-11096"><span class="mi" id="MathJax-Span-11097" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-11098" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-11099" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-11100" style="font-family: MathJax_Math; font-style: italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-775">relu</script></span> 函数之后得到的. 这就意味着, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-776-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11101" style="width: 3.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.224em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.885em 1000em 3.034em -0.492em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11102"><span class="mtext" id="MathJax-Span-11103" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-11104" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-11105" style="font-family: MathJax_Main; padding-left: 0.278em;">≥</span><span class="mn" id="MathJax-Span-11106" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span><span class="mtext" id="MathJax-Span-11107" style="font-family: MathJax_Main;">&nbsp;</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.135em; vertical-align: -0.235em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-776">~X \ge 0~</script></span>, 这就否定了这两个问题. </p><p>那么,</p><ul>
<li><strong>如果把双线性编码方式直接替换为方差矩阵即 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-777-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11108" style="width: 14.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.022em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.613em 1000em 3.287em -0.492em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11109"><span class="mfrac" id="MathJax-Span-11110"><span style="display: inline-block; position: relative; width: 1.486em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.66em 1000em 2.459em -0.433em); top: -2.708em; left: 50%; margin-left: -0.191em;"><span class="mn" id="MathJax-Span-11111" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.467em -0.477em); top: -1.912em; left: 50%; margin-left: -0.683em;"><span class="mrow" id="MathJax-Span-11112"><span class="mi" id="MathJax-Span-11113" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-11114" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-11115" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 1.486em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-11116" style="font-family: MathJax_Main; padding-left: 0.167em;">(</span><span class="mi" id="MathJax-Span-11117" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="msubsup" id="MathJax-Span-11118"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11119" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.65em; left: 0.932em;"><span class="mi" id="MathJax-Span-11120" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11121" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mfrac" id="MathJax-Span-11122" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.66em 1000em 2.459em -0.433em); top: -2.708em; left: 50%; margin-left: -0.191em;"><span class="mn" id="MathJax-Span-11123" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.764em 1000em 2.412em -0.477em); top: -1.896em; left: 50%; margin-left: -0.219em;"><span class="mi" id="MathJax-Span-11124" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 0.557em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-11125" style="font-family: MathJax_Main; padding-left: 0.167em;">(</span><span class="mi" id="MathJax-Span-11126" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mi" id="MathJax-Span-11127" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mo" id="MathJax-Span-11128" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-11129" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-11130" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mi" id="MathJax-Span-11131" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="msubsup" id="MathJax-Span-11132"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-11133" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-11134" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11135" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.777em; vertical-align: -0.544em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-777">\frac{1}{n-1}(XX^T - \frac{1}{n}(Xe)(Xe)^T)</script></span>, 性能会有什么变化呢</strong>？ </li></ul><p>详见<strong>附录-6 深入探究 symmetric bilinear 和 Covariance 之间的关系</strong>.</p><h4 id="4.4-双线性模型参数复杂度"><a name="4.4-双线性模型参数复杂度" href="#4.4-双线性模型参数复杂度"></a>4.4 双线性模型参数复杂度</h4><p>文中的 bilinear 编码本身不引入任何参数. 对于 <code>B-CNN[M,M]</code> 模型, 待编码的是一个 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-778-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11136" style="width: 5.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.262em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.892em 1000em 2.918em -0.437em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11137"><span class="mn" id="MathJax-Span-11138" style="font-family: MathJax_Main;">729</span><span class="mo" id="MathJax-Span-11139" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mn" id="MathJax-Span-11140" style="font-family: MathJax_Main; padding-left: 0.222em;">512</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.985em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-778">729\times 512</script></span> 的矩阵 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-779-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11141" style="width: 1.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.874em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-11142"><span class="mi" id="MathJax-Span-11143" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-779">X</script></span>, 编码过程就是先计算 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-780-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11144" style="width: 2.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.35em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.461em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-11145"><span class="msubsup" id="MathJax-Span-11146"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11147" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.65em; left: 0.932em;"><span class="mi" id="MathJax-Span-11148" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-11149" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.218em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-780">X^TX</script></span> 得到一个 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-781-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11150" style="width: 5.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.262em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.902em 1000em 2.918em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11151"><span class="mn" id="MathJax-Span-11152" style="font-family: MathJax_Main;">512</span><span class="mo" id="MathJax-Span-11153" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mn" id="MathJax-Span-11154" style="font-family: MathJax_Main; padding-left: 0.222em;">512</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.973em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-781">512\times 512</script></span> 的矩阵, 然后 <code>reshape</code> 成一个<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-782-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11155" style="width: 3.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.005em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.891em 1000em 2.918em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11156"><span class="mn" id="MathJax-Span-11157" style="font-family: MathJax_Main;">262144</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.986em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-782">262144</script></span>维的双线性向量 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-783-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11158" style="width: 0.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.601em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-11159"><span class="mi" id="MathJax-Span-11160" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.686em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-783">x</script></span>. 随后经过平方根标准化<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-784-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11161" style="width: 9.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.541em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.7em 1000em 3.237em -0.471em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11162"><span class="mi" id="MathJax-Span-11163" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-11164" style="font-family: MathJax_Main; padding-left: 0.278em;">←</span><span class="mi" id="MathJax-Span-11165" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">s</span><span class="mi" id="MathJax-Span-11166" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-11167" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-11168" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-11169" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-11170" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-11171" style="font-family: MathJax_Main;">)</span><span class="msqrt" id="MathJax-Span-11172"><span style="display: inline-block; position: relative; width: 2.24em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.145em -0.373em); top: -2.732em; left: 0.984em;"><span class="mrow" id="MathJax-Span-11173"><span class="texatom" id="MathJax-Span-11174"><span class="mrow" id="MathJax-Span-11175"><span class="mo" id="MathJax-Span-11176" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-11177" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="texatom" id="MathJax-Span-11178"><span class="mrow" id="MathJax-Span-11179"><span class="mo" id="MathJax-Span-11180" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(3.555em 1000em 4.023em -0.492em); top: -4.588em; left: 0.984em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.989em; left: -0.084em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.989em; left: 0.563em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(2.975em 1000em 4.503em -0.381em); top: -3.998em; left: 0em;"><span style="font-family: MathJax_Size1;">√</span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.609em; vertical-align: -0.482em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-784">y \leftarrow sign(x)\sqrt{|x|} </script></span> 和 2-范数标准化<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-785-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11181" style="width: 4.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.934em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.698em 1000em 3.54em -0.457em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11182"><span class="mi" id="MathJax-Span-11183" style="font-family: MathJax_Math; font-style: italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-11184" style="font-family: MathJax_Main; padding-left: 0.278em;">←</span><span class="mfrac" id="MathJax-Span-11185" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.65em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.764em 1000em 2.549em -0.477em); top: -2.798em; left: 50%; margin-left: -0.191em;"><span class="mi" id="MathJax-Span-11186" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.601em 1000em 2.66em -0.408em); top: -1.852em; left: 50%; margin-left: -0.765em;"><span class="mrow" id="MathJax-Span-11187"><span class="texatom" id="MathJax-Span-11188"><span class="mrow" id="MathJax-Span-11189"><span class="mo" id="MathJax-Span-11190" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-11191"><span class="mrow" id="MathJax-Span-11192"><span class="mo" id="MathJax-Span-11193" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-11194" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="texatom" id="MathJax-Span-11195"><span class="mrow" id="MathJax-Span-11196"><span class="mo" id="MathJax-Span-11197" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-11198"><span style="display: inline-block; position: relative; width: 0.545em; height: 0px;"><span style="position: absolute; clip: rect(1.601em 1000em 2.635em -0.408em); top: -2.295em; left: 0em;"><span class="texatom" id="MathJax-Span-11199"><span class="mrow" id="MathJax-Span-11200"><span class="mo" id="MathJax-Span-11201" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; top: -1.985em; left: 0.219em;"><span class="mn" id="MathJax-Span-11202" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 1.65em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.98em; vertical-align: -0.852em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-785">z \leftarrow \frac{y}{||y||_2} </script></span>. 最后交给 softmax分类器进行分类.</p><p>问题在于, 输入到 softmax 分类器的是一个 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-786-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11203" style="width: 3.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.005em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.891em 1000em 2.918em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11204"><span class="mn" id="MathJax-Span-11205" style="font-family: MathJax_Main;">262144</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.986em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-786">262144</script></span> 维的向量, 对于鸟类数据集100类来说，将会是一个 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-787-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11206" style="width: 7.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.738em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.891em 1000em 2.918em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11207"><span class="mn" id="MathJax-Span-11208" style="font-family: MathJax_Main;">262144</span><span class="mo" id="MathJax-Span-11209" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mn" id="MathJax-Span-11210" style="font-family: MathJax_Main; padding-left: 0.222em;">100</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.986em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-787">262144\times 100</script></span> 的权重矩阵，即 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-788-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11211" style="width: 6.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.918em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.891em 1000em 3.09em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11212"><span class="mn" id="MathJax-Span-11213" style="font-family: MathJax_Main;">26</span><span class="mo" id="MathJax-Span-11214" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-11215" style="font-family: MathJax_Main; padding-left: 0.167em;">214</span><span class="mo" id="MathJax-Span-11216" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-11217" style="font-family: MathJax_Main; padding-left: 0.167em;">400</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.196em; vertical-align: -0.303em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-788">26,214,400</script></span>个参数(26个million)!</p><p>这么多的参数必然存在着大量的冗余. 针对这一点, Y.Gao等人于CVPR2016[22]发表的文章提出了一个紧凑的双线性编码方法(compact bilinear pooling).</p><p>考虑非对称情形，双线性特征是两个特征 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-789-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11218" style="width: 0.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.601em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-11219"><span class="mi" id="MathJax-Span-11220" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.686em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-789">x</script></span> 和 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-790-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11221" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.883em -0.471em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-11222"><span class="mi" id="MathJax-Span-11223" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.923em; vertical-align: -0.317em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-790">y</script></span> 的外积. 本文作者在随后的工作中，尝试了三种降维策略:</p><ul>
<li>先计算 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-791-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11224" style="width: 0.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.601em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-11225"><span class="mi" id="MathJax-Span-11226" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.686em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-791">x</script></span> 和 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-792-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11227" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.883em -0.471em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-11228"><span class="mi" id="MathJax-Span-11229" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.923em; vertical-align: -0.317em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-792">y</script></span> 的外积, 再把外积投射到低维空间.</li><li>先把 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-793-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11230" style="width: 0.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.601em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-11231"><span class="mi" id="MathJax-Span-11232" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.686em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-793">x</script></span> 和 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-794-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11233" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.883em -0.471em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-11234"><span class="mi" id="MathJax-Span-11235" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.923em; vertical-align: -0.317em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-794">y</script></span> 投射到低维空间, 再计算它们的外积.</li><li>只把 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-795-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11236" style="width: 0.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.601em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-11237"><span class="mi" id="MathJax-Span-11238" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.686em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-795">x</script></span> 和 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-796-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11239" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.883em -0.471em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-11240"><span class="mi" id="MathJax-Span-11241" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.923em; vertical-align: -0.317em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-796">y</script></span> 中的一个投射到低维空间，再计算它们的外积.</li></ul><p>投射矩阵采用 PCA 方法求得. 第一种方法计算复杂度太高, 因为 PCA 需要计算一个很高维的方差矩阵 (对于B-CNN[M,M], <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-797-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11242" style="width: 8.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.213em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.891em 1000em 2.918em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11243"><span class="mn" id="MathJax-Span-11244" style="font-family: MathJax_Main;">262144</span><span class="mo" id="MathJax-Span-11245" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mn" id="MathJax-Span-11246" style="font-family: MathJax_Main; padding-left: 0.222em;">262144</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.986em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-797">262144\times 262144</script></span>维). 第二种方法会计算复杂度低很多, 但是会带来明显的性能损失. 所幸第三种方法不会带来明显的性能损失, 甚至还可能稍微提升性能. 具体参见<a href="https://arxiv.org/pdf/1504.07889v4">本篇文章的最新版</a>.</p><h2 id="5-总结与展望"><a name="5-总结与展望" href="#5-总结与展望"></a>5 总结与展望</h2><h4 id="5.1-总结"><a name="5.1-总结" href="#5.1-总结"></a>5.1 总结</h4><p>本文是针对 Tsung-Yu Lin 在 <em>ICCV2015</em> 上发表的 <em>Bilinear CNN Models for Fine-Grained Visual Recognition</em> 的一个调研报告. 本次调研完成的主要工作:</p><ol>
<li>对文章的技术细节, 涉及的数学公式进行了论证.</li><li>在<code>CUB-100-2011</code>数据集上, 成功复现模型B-CNN[M,M], B-CNN[D,D] 和 B-CNN[M,D].</li><li>评估了B-CNN模型在<code>Hikvision car1000_data</code>数据集上的性能(待结果).</li><li>对 B-CNN 模型进行了多个维度的思考.</li><li>对源代码进行了深入的剖析 (见附录).</li><li>对 MatConvNet 深度学习框架进行了学习 (见附录).</li><li>成功往 MatConvNet 中加入自定义网络层 (见附录)</li><li>尝试对 B-CNN 模型进行了一些小改进, 效果不明显 (见附录).</li><li>深入分析了论文中对称双线性模型(symmetric bilinear model) 和 方差的关系(见附录, 待完成).</li><li>学习并总结了图像细分类领域的相关技术(BoVW, Fisher Vector, 和 VLAD) (见附录).</li></ol><h4 id="5.2-展望"><a name="5.2-展望" href="#5.2-展望"></a>5.2 展望</h4><p>从文章中可以看出，细分类任务的技术思路是: 特征提取器(CNN, SIFT) + 编码器(Bilinear, VLAD, FV, BoVW) + 分类器(softmax, SVM).</p><p>相关文章表明 CNN 提取的特征可以优于 SIFT 特征. 未来的工作可以是:</p><ul>
<li>寻找更好的特征提取器.</li><li>寻找更好的编码方式.</li><li>将 Bilinear 模型移植到 Caffe 上.</li></ul><hr class="section"><h2 id="附录-1-matconvnet-介绍"><a name="附录-1-matconvnet-介绍" href="#附录-1-matconvnet-介绍"></a>附录-1 MatConvNet 介绍</h2><p>The B-CNN model is implemented based on <a href="http://www.vlfeat.org/matconvnet/"><em>MatConvNet</em></a>.</p><p><strong>MatConvNet</strong> is a MATLAB toolbox implementing <em>Convolutional Neural Networks</em> (CNNs) for computer vision applications. It is simple, efficient, and can run and learn state-of-the-art CNNs. Many pre-trained CNNs for image classification, segmentation, face recognition, and text detection are available.</p><ul>
<li><p><a href="http://www.vlfeat.org/matconvnet/functions/"><strong>Main functions provided</strong></a>:</p>
<pre><code data-origin="<pre><code>  vl_nnbilinearsampler
  vl_nnconcat
  vl_nnspnorm
  vl_nnpdist
  vl_nnconv
  vl_nnconvt
  vl_nncrop
  vl_nndropout
  vl_nnloss
  vl_nnnoffset
  vl_nnnormalize
  vl_nnpool
  vl_nnrelu
  vl_nnroipool
  vl_nnsigmoid
  vl_nnsoftmax
  vl_nnsoftmaxloss
  DagNN wrapper
  vl_simplenn
  vl_simplenn_tidy
  vl_simplenn_diagnose
  vl_simplenn_display
  vl_simplenn_move
  vl_argparse
  vl_compilenn
  vl_rootnn
  vl_setupnn
  vl_imreadjpeg
  vl_taccum
</code></pre>">  vl_nnbilinearsampler
  vl_nnconcat
  vl_nnspnorm
  vl_nnpdist
  vl_nnconv
  vl_nnconvt
  vl_nncrop
  vl_nndropout
  vl_nnloss
  vl_nnnoffset
  vl_nnnormalize
  vl_nnpool
  vl_nnrelu
  vl_nnroipool
  vl_nnsigmoid
  vl_nnsoftmax
  vl_nnsoftmaxloss
  DagNN wrapper
  vl_simplenn
  vl_simplenn_tidy
  vl_simplenn_diagnose
  vl_simplenn_display
  vl_simplenn_move
  vl_argparse
  vl_compilenn
  vl_rootnn
  vl_setupnn
  vl_imreadjpeg
  vl_taccum
</code></pre></li><li><p><a href="http://www.vlfeat.org/matconvnet/pretrained/"><strong>Pretrained models</strong></a>:</p>
<ul>
<li><strong>Fast R-CNN</strong> for object detection</li><li><strong>VGG-Face</strong> for face recognition</li><li><strong>Fully-Convolutional Networks</strong> (FCN), <strong>BVLC FCN</strong> and <strong>Torr Vision Group FCN-8s</strong> for semantic segmentation</li><li><strong>ResNet</strong>, <strong>GoogLeNet</strong>, <strong>VGG-VD</strong>, <strong>VGG-S/M/F</strong>, <strong>Caffe reference model</strong>, and <strong>AlexNet</strong> for ImageNet ILSVRC classification.</li></ul>
</li><li><p><strong>Documentation</strong></p>
<ul>
<li><a href="http://www.vlfeat.org/matconvnet/matconvnet-manual.pdf">manual</a></li><li><a href="http://www.vlfeat.org/matconvnet/functions/">Function description</a></li><li><a href="http://www.robots.ox.ac.uk/~vgg/practicals/cnn/">CNN practical</a></li></ul>
</li></ul><h2 id="附录-2-b-cnn-实验平台搭建"><a name="附录-2-b-cnn-实验平台搭建" href="#附录-2-b-cnn-实验平台搭建"></a>附录-2 B-CNN 实验平台搭建</h2><ol>
<li><p>download bcnn: <code>git clone https://bitbucket.org/tsungyu/bcnn.git</code></p>
<pre><code data-origin="<pre><code> $ cd bcnn
</code></pre>"> $ cd bcnn
</code></pre><p>download bcnn-package: <code>git clone https://bitbucket.org/tsungyu/bcnn-package.git</code><br>download vlfeat: <code>git clone https://github.com/vlfeat/vlfeat.git</code><br>download matconvnet: <code>git clone https://github.com/vlfeat/matconvnet.git</code></p>
</li><li><p>keep <code>bcnn-package</code>, <code>vlfeat</code>, and <code>matconvnet</code> under <code>bcnn</code> directory:</p>
<pre><code data-origin="<pre><code> --bcnn
     --bcnn-package
     --vlfeat
     --matconvnet
     ...
</code></pre>"> --bcnn
     --bcnn-package
     --vlfeat
     --matconvnet
     ...
</code></pre></li><li><p>install <code>vlfeat</code>:</p>
<pre><code data-origin="<pre><code> $ cd /path/to/bcnn/vlfeat
 $ sudo make
 $ matlab
 &amp;gt; ./toolbox/vl_setup
 &amp;gt; vl_demo
</code></pre>"> $ cd /path/to/bcnn/vlfeat
 $ sudo make
 $ matlab
 &gt; ./toolbox/vl_setup
 &gt; vl_demo
</code></pre></li><li><p>install <code>matconvnet</code> (must already installed cuda):</p>
<pre><code data-origin="<pre><code> $ cd /path/to/bcnn/matconvnet
 $ matlab
 &amp;gt; vl_compilenn('enableGpu', true, 'cudaRoot', '/usr/local/cuda') %./matlab/vl_compilenn.m
</code></pre>"> $ cd /path/to/bcnn/matconvnet
 $ matlab
 &gt; vl_compilenn('enableGpu', true, 'cudaRoot', '/usr/local/cuda') %./matlab/vl_compilenn.m
</code></pre><p>info:</p>
<pre><code data-origin="<pre><code> A lot of complaints that `gcc/g++-4.8.3` are not supported. However, it said 'compile succeeded'.
</code></pre>"> A lot of complaints that `gcc/g++-4.8.3` are not supported. However, it said 'compile succeeded'.
</code></pre><p>setup <code>matconvnet</code>:</p>
<pre><code data-origin="<pre><code> &amp;gt; ./matlab/vl_setupnn
</code></pre>"> &gt; ./matlab/vl_setupnn
</code></pre></li><li><p>install <code>bcnn</code>:</p>
<pre><code data-origin="<pre><code> $ cd /path/to/bcnn
 $ matlab
 &amp;gt; ./setup
</code></pre>"> $ cd /path/to/bcnn
 $ matlab
 &gt; ./setup
</code></pre><p> download <code>bcnn-cub-dm.mat</code>, and put it under <code>/path/to/bcnn/data/ft_models</code>.<br> download <code>svm-cub-vdm.mat</code>, and put it under <code>/path/to/bcnn/data/models</code></p>
<pre><code data-origin="<pre><code> &amp;gt; ./bird_demo
</code></pre>"> &gt; ./bird_demo
</code></pre></li></ol><h2 id="附录-3-带-b-cnn-飞起来"><a name="附录-3-带-b-cnn-飞起来" href="#附录-3-带-b-cnn-飞起来"></a>附录-3 带 B-CNN 飞起来</h2><h4 id="1.-让-run_experiments_bcnn_train-跑起来"><a name="1.-让-run_experiments_bcnn_train-跑起来" href="#1.-让-run_experiments_bcnn_train-跑起来"></a>1. 让 run_experiments_bcnn_train 跑起来</h4><p>In summary, what should you do after installing the B-CNN package to run the training:</p><ul>
<li>download <code>imagenet-vgg-m.mat</code> and <code>imagenet-vgg-verydeep-16.mat</code>, and put it under <code>/path/to/bcnn_root/data/models</code></li><li>download datasets <code>CUB-200-2011</code>, and put it under <code>/path/to/bcnn_root/data</code> with a new name <code>cub</code></li><li><p>check the variables <code>setupNameList</code>, <code>encoderList</code>, and <code>datasetList</code> in <code>run_experiments_bcnn_train.m</code>, to use the <code>bcnnmm</code> model and <code>cub</code> dataset.</p>
</li><li><p><strong>NOTE: The B-CNN source code seems to have a built-in bug</strong>. To work around this bug, add one line to file <code>/path/to/bcnn/imdb_get_batch_bcnn.m</code>:</p>
</li></ul><pre class="matlab hljs"><code class="matlab" data-origin="<pre><code class=&quot;matlab&quot;>%/path/to/bcnn/imdb_get_batch_bcnn.m

    ...

    opts(i).prefetch = false;
    opts(i).scale = 1;
    opts(i).cropSize = 224/256; % adde this line
    opts(i) = vl_argparse(opts(i), {varargin{1}(i),varargin{2:end}});

    if(i==1)

    ...
</code></pre>"><span class="hljs-comment">%/path/to/bcnn/imdb_get_batch_bcnn.m</span>

    ...

    opts(<span class="hljs-built_in">i</span>).prefetch = false;
    opts(<span class="hljs-built_in">i</span>).scale = <span class="hljs-number">1</span>;
    opts(<span class="hljs-built_in">i</span>).cropSize = <span class="hljs-number">224</span>/<span class="hljs-number">256</span>; <span class="hljs-comment">% adde this line</span>
    opts(<span class="hljs-built_in">i</span>) = vl_argparse(opts(<span class="hljs-built_in">i</span>), <span class="hljs-cell">{varargin{<span class="hljs-number">1</span>}</span>(<span class="hljs-built_in">i</span>),varargin<span class="hljs-cell">{<span class="hljs-number">2</span>:end}</span>});

    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">i</span>==<span class="hljs-number">1</span>)

    ...
</code></pre><p>OK, Let the function <code>run_experiments_bcnn_train</code> run!</p><h4 id="2.-解决源代码自带-bug-的过程"><a name="2.-解决源代码自带-bug-的过程" href="#2.-解决源代码自带-bug-的过程"></a>2. 解决源代码自带 Bug 的过程</h4><p>Assume the line <code>opts(i).cropsize = 224/256</code> is not added to file <code>/path/to/bcnn/imdb_get_batch_bcnn.m</code> and run <code>run_experiments_bcnn_train</code>!</p><pre><code data-origin="<pre><code> 196:  196.House_Wren (train:    29, test:    30 total:    59)
 197:  197.Marsh_Wren (train:    30, test:    30 total:    60)
 198:   198.Rock_Wren (train:    30, test:    30 total:    60)
 199: 199.Winter_Wren (train:    30, test:    30 total:    60)
 200: 200.Common_Yellowthroat (train:    30, test:    30 total:    60)
 Inf:       **total** (train: 11788, test: 11788 total: 11788)
dataset: there are 11788 images (5994 trainval 5794 test)
collecting image stats: batch starting with image 2 ...Error using vl_argparse (line 101)
Unknown parameter 'cropSize'

Error in vl_argparse (line 80)
      opts = vl_argparse(opts, vertcat(params,values)) ;

Error in imdb_get_batch_bcnn (line 35)
    opts(i) = vl_argparse(opts(i), {varargin{1}(i),varargin{2:end}});

Error in getBatchSimpleNNWrapper&amp;gt;getBatchSimpleNN (line 10)
im = imdb_get_batch_bcnn(images, opts, ...

Error in getBatchSimpleNNWrapper&amp;gt;@(imdb,batch)getBatchSimpleNN(imdb,batch,opts) (line 4)
fn = @(imdb, batch) getBatchSimpleNN(imdb, batch, opts) ;

Error in imdb_bcnn_train_dag&amp;gt;getImageStats (line 213)
  temp = fn(imdb, batch) ;

Error in imdb_bcnn_train_dag (line 83)
  [averageImage, rgbMean, rgbCovariance] = getImageStats(imdb, bopts) ;

Error in run_experiments_bcnn_train (line 81)
          imdb_bcnn_train_dag(imdb, opts);
</code></pre>"> 196:  196.House_Wren (train:    29, test:    30 total:    59)
 197:  197.Marsh_Wren (train:    30, test:    30 total:    60)
 198:   198.Rock_Wren (train:    30, test:    30 total:    60)
 199: 199.Winter_Wren (train:    30, test:    30 total:    60)
 200: 200.Common_Yellowthroat (train:    30, test:    30 total:    60)
 Inf:       **total** (train: 11788, test: 11788 total: 11788)
dataset: there are 11788 images (5994 trainval 5794 test)
collecting image stats: batch starting with image 2 ...Error using vl_argparse (line 101)
Unknown parameter 'cropSize'

Error in vl_argparse (line 80)
      opts = vl_argparse(opts, vertcat(params,values)) ;

Error in imdb_get_batch_bcnn (line 35)
    opts(i) = vl_argparse(opts(i), {varargin{1}(i),varargin{2:end}});

Error in getBatchSimpleNNWrapper&gt;getBatchSimpleNN (line 10)
im = imdb_get_batch_bcnn(images, opts, ...

Error in getBatchSimpleNNWrapper&gt;@(imdb,batch)getBatchSimpleNN(imdb,batch,opts) (line 4)
fn = @(imdb, batch) getBatchSimpleNN(imdb, batch, opts) ;

Error in imdb_bcnn_train_dag&gt;getImageStats (line 213)
  temp = fn(imdb, batch) ;

Error in imdb_bcnn_train_dag (line 83)
  [averageImage, rgbMean, rgbCovariance] = getImageStats(imdb, bopts) ;

Error in run_experiments_bcnn_train (line 81)
          imdb_bcnn_train_dag(imdb, opts);
</code></pre><p>ERROR! …</p><p>Well, set some breakpoints, and locate the error (NOTE: although MATLAB gives lots of helpful error information to help us debug, chances are that the error location can be not that accurate. And it also helps a lot for understanding the code to trace back the execution stack.):</p><pre><code data-origin="<pre><code>**function run_experiments_bcnn_train():**
    -&amp;gt; imdb_bcnn_train_dag(imdb, opts);
**function imdb_bcnn_train_dag(imdb, opts, varargin):**
    -&amp;gt; [averageImage, rgbMean, rgbCovariance] = getImageStats(imdb, bopts);
**function [averageImage, rgbMean, rgbCovariance] = getImageStats(imdb, opts):**
    -&amp;gt; fn = getBatchSimpleNNWrapper(opts); temp = fn(imdb, batch);
**function fn = getBatchSimpleNNWrapper(opts):**
    -&amp;gt; fn = @(imdb, batch) getBatchSimpleNN(imdb, batch, opts);
**function [im,labels] = getBatchSimpleNN(imdb, batch, opts):**
    -&amp;gt; im = imdb_get_batch_bcnn(images, opts, ...
                        'prefetch', nargout == 0);
**function imo = imdb_get_batch_bcnn(images, varargin):**
    -&amp;gt; opts(i) = vl_argparse(opts(i), {varargin{1}(i),varargin{2:end}});
**function [opts, args] = vl_argparse(opts, args, varargin):**
    -&amp;gt;  if nargout == 1
            opts = vl_argparse(opts, vertcat(params,values)) ;
**function [opts, args] = vl_argparse(opts, args, varargin):**
    -&amp;gt;  if nargout == 1
            error('Unknown parameter ''%s''', param) ;
</code></pre>">**function run_experiments_bcnn_train():**
    -&gt; imdb_bcnn_train_dag(imdb, opts);
**function imdb_bcnn_train_dag(imdb, opts, varargin):**
    -&gt; [averageImage, rgbMean, rgbCovariance] = getImageStats(imdb, bopts);
**function [averageImage, rgbMean, rgbCovariance] = getImageStats(imdb, opts):**
    -&gt; fn = getBatchSimpleNNWrapper(opts); temp = fn(imdb, batch);
**function fn = getBatchSimpleNNWrapper(opts):**
    -&gt; fn = @(imdb, batch) getBatchSimpleNN(imdb, batch, opts);
**function [im,labels] = getBatchSimpleNN(imdb, batch, opts):**
    -&gt; im = imdb_get_batch_bcnn(images, opts, ...
                        'prefetch', nargout == 0);
**function imo = imdb_get_batch_bcnn(images, varargin):**
    -&gt; opts(i) = vl_argparse(opts(i), {varargin{1}(i),varargin{2:end}});
**function [opts, args] = vl_argparse(opts, args, varargin):**
    -&gt;  if nargout == 1
            opts = vl_argparse(opts, vertcat(params,values)) ;
**function [opts, args] = vl_argparse(opts, args, varargin):**
    -&gt;  if nargout == 1
            error('Unknown parameter ''%s''', param) ;
</code></pre><p><strong>What the hell is <code>cropSize</code>?</strong></p><p>After some tracing during debugging, I find that <code>cropSize</code> is introduced by <code>net.meta.normalization (imdb_bcnn_train_dag.m: line 71)</code> to <code>bopts</code> which will be passed to function call <code>getImageStats(imdb, bopts)</code> and further be passed to function <code>imdb_get_batch_bcmm(images, varargin)</code> via <code>bopts -&gt; opts -&gt; varargin</code>, and finally be passed to function <code>vl_argparse(opts, args, varargin)</code>.</p><p>Inspect a few more lines around <code>opts = vl_argparse(opts, vertcat(params,values))</code> in <code>vl_argparse.m</code>:</p><pre class="matlab hljs"><code class="matlab" data-origin="<pre><code class=&quot;matlab&quot;>% ./matconvnet/matlab/vl_argparse.m

if recursive &amp;amp;&amp;amp; isstruct(args{ai})
    params = fieldnames(args{ai})' ;
    values = struct2cell(args{ai})' ;
    if nargout == 1
        opts = vl_argparse(opts, vertcat(params,values)) ;
    else
        [opts, rest] = vl_argparse(opts, reshape(vertcat(params,values), 1, [])) ;
        args{ai} = cell2struct(rest(2:2:end), rest(1:2:end), 2) ;
        keep(ai) = true ;
    end
    ai = ai + 1 ;
    continue ;
 end
</code></pre>"><span class="hljs-comment">% ./matconvnet/matlab/vl_argparse.m</span>

<span class="hljs-keyword">if</span> recursive &amp;&amp; isstruct(args<span class="hljs-cell">{ai}</span>)
    params = fieldnames(args<span class="hljs-cell">{ai}</span>)<span class="hljs-operator">'</span> ;
    values = struct2cell(args<span class="hljs-cell">{ai}</span>)<span class="hljs-operator">'</span> ;
    <span class="hljs-keyword">if</span> nargout == <span class="hljs-number">1</span>
        opts = vl_argparse(opts, vertcat(params,values)) ;
    <span class="hljs-keyword">else</span>
        <span class="hljs-matrix">[opts, rest]</span> = vl_argparse(opts, <span class="hljs-built_in">reshape</span>(vertcat(params,values), <span class="hljs-number">1</span>, <span class="hljs-matrix">[]</span>)) ;
        args<span class="hljs-cell">{ai}</span> = cell2struct(rest(<span class="hljs-number">2</span>:<span class="hljs-number">2</span>:<span class="hljs-keyword">end</span>), rest(<span class="hljs-number">1</span>:<span class="hljs-number">2</span>:<span class="hljs-keyword">end</span>), <span class="hljs-number">2</span>) ;
        keep(ai) = true ;
    <span class="hljs-keyword">end</span>
    ai = ai + <span class="hljs-number">1</span> ;
    <span class="hljs-keyword">continue</span> ;
 <span class="hljs-keyword">end</span>
</code></pre><p>where <code>recursive</code> is set to <code>true</code>, and <code>args</code> is passed in as a pack <code>{varargin{1}(i),varargin{2:end}}</code>:</p><pre><code data-origin="<pre><code>**function imo = imdb_get_batch_bcnn(images, varargin):**
-&amp;gt; opts(i) = vl_argparse(opts(i), {varargin{1}(i),varargin{2:end}});
**function [opts, args] = vl_argparse(opts, args, varargin):**
</code></pre>">**function imo = imdb_get_batch_bcnn(images, varargin):**
-&gt; opts(i) = vl_argparse(opts(i), {varargin{1}(i),varargin{2:end}});
**function [opts, args] = vl_argparse(opts, args, varargin):**
</code></pre><p>Look one more wrapper outsider, the <code>varargin</code> in function <code>imdb_get_batch_bcnn()</code> is passed in via <code>opts,'prefetch', nargout == 0</code>:</p><pre><code data-origin="<pre><code>**function [im,labels] = getBatchSimpleNN(imdb, batch, opts):**
    -&amp;gt; im = imdb_get_batch_bcnn(images, opts, ...
                        'prefetch', nargout == 0);
</code></pre>">**function [im,labels] = getBatchSimpleNN(imdb, batch, opts):**
    -&gt; im = imdb_get_batch_bcnn(images, opts, ...
                        'prefetch', nargout == 0);
</code></pre><p>Bingo! <code>opts</code> is the first element of <code>args</code> in <code>vl_argparse</code>. Therefore, at the very beginning when <code>ai = 1</code>, <code>isstruct(args{ai})</code> will also be <code>true</code>. So the next sentence is going to proceed:</p><pre><code data-origin="<pre><code>    opts = vl_argparse(opts, vertcat(params,values)) ;
</code></pre>">    opts = vl_argparse(opts, vertcat(params,values)) ;
</code></pre><p>What are <code>opts</code>, <code>params</code> and <code>values</code> when program execution reaches here?</p><pre><code data-origin="<pre><code>opts =

         imageSize: [227 227]
            border: [0 0]
        keepAspect: 1
       numAugments: 1
    transformation: 'none'
      averageImage: []
       rgbVariance: [0x3 single]
     interpolation: 'bilinear'
        numThreads: 1
          prefetch: 0
             scale: 1

params =

    'imageSize'     'keepAspect'    'averageImage'    'border'        'cropSize'      'interpolation'    'numThreads'

values =

    [1x4 double]    [         1]                []    [1x2 double]    [1x2 double]    'bilinear'         [        12]
</code></pre>">opts =

         imageSize: [227 227]
            border: [0 0]
        keepAspect: 1
       numAugments: 1
    transformation: 'none'
      averageImage: []
       rgbVariance: [0x3 single]
     interpolation: 'bilinear'
        numThreads: 1
          prefetch: 0
             scale: 1

params =

    'imageSize'     'keepAspect'    'averageImage'    'border'        'cropSize'      'interpolation'    'numThreads'

values =

    [1x4 double]    [         1]                []    [1x2 double]    [1x2 double]    'bilinear'         [        12]
</code></pre><p>where <code>params</code> is the <code>fieldnames</code> of <code>args{1}</code>: <code>params = fieldnames(args{ai})</code> and <code>values</code> packs their correponding values: <code>values = struct2cell(args{ai})</code>.</p><p>So the function <code>vl_argparse(opts, args, varagin)</code> is executed for a second time with parameters the same <code>opts</code> and a new <code>args = vertcat(params,values)</code>.</p><p>Now none of the elements in <code>args</code> is a struct. The execution will then reach the code block, where the ERROR occurs:</p><pre class="matlab hljs"><code class="matlab" data-origin="<pre><code class=&quot;matlab&quot;>% ./matconvnet/matlab/vl_argparse.m

  param = args{ai} ;
  value = args{ai+1} ;
  p = find(strcmpi(param, optNames)) ;
  if numel(p) ~= 1
    if nargout == 1
        error('Unkno parameter ''%s''', param) ;
    else
      keep([ai,ai+1]) = true ;
      ai = ai + 2 ;
      continue ;
    end
  end
</code></pre>"><span class="hljs-comment">% ./matconvnet/matlab/vl_argparse.m</span>

  param = args<span class="hljs-cell">{ai}</span> ;
  value = args<span class="hljs-cell">{ai+<span class="hljs-number">1</span>}</span> ;
  p = <span class="hljs-built_in">find</span>(strcmpi(param, optNames)) ;
  <span class="hljs-keyword">if</span> <span class="hljs-built_in">numel</span>(p) ~= <span class="hljs-number">1</span>
    <span class="hljs-keyword">if</span> nargout == <span class="hljs-number">1</span>
        error(<span class="hljs-string">'Unkno parameter ''%s'''</span>, param) ;
    <span class="hljs-keyword">else</span>
      keep(<span class="hljs-matrix">[ai,ai+<span class="hljs-number">1</span>]</span>) = true ;
      ai = ai + <span class="hljs-number">2</span> ;
      <span class="hljs-keyword">continue</span> ;
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
</code></pre><p>This code block is in a <code>while</code> loop.  It finds the elements of <code>params</code> that appear in <code>optNames</code> at each iteration of the loop. So what is the <code>optNames</code>? It is a pack of all the fieldnames of <code>opts</code>. Having a comparison:</p><pre><code data-origin="<pre><code>params =

    'imageSize'     'keepAspect'    'averageImage'    'border'    'cropSize'      'interpolation'    'numThreads'

optNames =

    'imageSize'    'border'    'keepAspect'    'numAugments'    'transformation'    'averageImage'    'rgbVariance'    'interpolation'    'numThreads'    'prefetch'    'scale'
</code></pre>">params =

    'imageSize'     'keepAspect'    'averageImage'    'border'    'cropSize'      'interpolation'    'numThreads'

optNames =

    'imageSize'    'border'    'keepAspect'    'numAugments'    'transformation'    'averageImage'    'rgbVariance'    'interpolation'    'numThreads'    'prefetch'    'scale'
</code></pre><p>All elements but <code>cropSize</code> in <code>params</code> appear in <code>optNames</code> !!</p><p>That’s why this error occurs:</p><pre><code data-origin="<pre><code>Error: Unkown parameter 'cropSize'
</code></pre>">Error: Unkown parameter 'cropSize'
</code></pre><p>So the problem is two fold:</p><pre><code data-origin="<pre><code>`cropSize` should not appear in `net.meta.normalization`, or
`cropSize` should be made appear in `opts` of `vl_argparse`.
</code></pre>">`cropSize` should not appear in `net.meta.normalization`, or
`cropSize` should be made appear in `opts` of `vl_argparse`.
</code></pre><p>Since <code>net.meta.normalization</code> seems to be the last thing I should touch, I would try to set <code>cropSize</code> to <code>opts</code> firstly. To do this, let’s have a check where the <code>opts</code> of <code>vl_argparse</code> comes from, which means we should look into the execution stack to find out who calls the function <code>vl_argparse</code>.</p><p>It is <code>imo = imdb_get_batch_bcnn(images, varargin)</code>:</p><pre class="matlab hljs"><code class="matlab" data-origin="<pre><code class=&quot;matlab&quot;>% /bcnn/imdb_get_batch_bcnn.m
function imo = imdb_get_batch_bcnn(images, varargin)
% imdb_get_batch_bcnn  Load, preprocess, and pack images for BCNN evaluation
% For asymmetric model, the function preprocesses the images twice for two networks
% separately.

% OUTPUT
% imo: a cell array where each element is a cell array of images.
%       For symmetric bcnn model, numel(imo) will be 1 and imo{1} will be a
%       cell array of images
%       For asymmetric bcnn, numel(imo) will be 2. imo{1} is a cell array containing the preprocessed images for network A 
%       Similarly, imo{2} is a cell array containing the preprocessed images for network B

%
% Copyright (C) 2015 Tsung-Yu Lin, Aruni RoyChowdhury, Subhransu Maji.
% All rights reserved.
%
% This file is part of the BCNN and is made available under
% the terms of the BSD license (see the COPYING file).
%
% This file modified from CNN_IMAGENET_GET_BATCH of MatConvNet

for i=1:numel(varargin{1})
    opts(i).imageSize = [227, 227] ;
    opts(i).border = [0, 0] ;
    opts(i).keepAspect = true;
    opts(i).numAugments = 1 ;
    opts(i).transformation = 'none' ;
    opts(i).averageImage = [] ;
    opts(i).rgbVariance = zeros(0,3,'single') ;
    opts(i).interpolation = 'bilinear' ;
    opts(i).numThreads = 1 ;
    opts(i).prefetch = false;
    opts(i).scale = 1;
    opts(i) = vl_argparse(opts(i), {varargin{1}(i),varargin{2:end}});
</code></pre>"><span class="hljs-comment">% /bcnn/imdb_get_batch_bcnn.m</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">imo</span> = <span class="hljs-title">imdb_get_batch_bcnn</span><span class="hljs-params">(images, varargin)</span></span>
<span class="hljs-comment">% imdb_get_batch_bcnn  Load, preprocess, and pack images for BCNN evaluation</span>
<span class="hljs-comment">% For asymmetric model, the function preprocesses the images twice for two networks</span>
<span class="hljs-comment">% separately.</span>

<span class="hljs-comment">% OUTPUT</span>
<span class="hljs-comment">% imo: a cell array where each element is a cell array of images.</span>
<span class="hljs-comment">%       For symmetric bcnn model, numel(imo) will be 1 and imo{1} will be a</span>
<span class="hljs-comment">%       cell array of images</span>
<span class="hljs-comment">%       For asymmetric bcnn, numel(imo) will be 2. imo{1} is a cell array containing the preprocessed images for network A </span>
<span class="hljs-comment">%       Similarly, imo{2} is a cell array containing the preprocessed images for network B</span>

<span class="hljs-comment">%</span>
<span class="hljs-comment">% Copyright (C) 2015 Tsung-Yu Lin, Aruni RoyChowdhury, Subhransu Maji.</span>
<span class="hljs-comment">% All rights reserved.</span>
<span class="hljs-comment">%</span>
<span class="hljs-comment">% This file is part of the BCNN and is made available under</span>
<span class="hljs-comment">% the terms of the BSD license (see the COPYING file).</span>
<span class="hljs-comment">%</span>
<span class="hljs-comment">% This file modified from CNN_IMAGENET_GET_BATCH of MatConvNet</span>

<span class="hljs-keyword">for</span> <span class="hljs-built_in">i</span>=<span class="hljs-number">1</span>:<span class="hljs-built_in">numel</span>(varargin<span class="hljs-cell">{<span class="hljs-number">1</span>}</span>)
    opts(<span class="hljs-built_in">i</span>).imageSize = <span class="hljs-matrix">[<span class="hljs-number">227</span>, <span class="hljs-number">227</span>]</span> ;
    opts(<span class="hljs-built_in">i</span>).border = <span class="hljs-matrix">[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>]</span> ;
    opts(<span class="hljs-built_in">i</span>).keepAspect = true;
    opts(<span class="hljs-built_in">i</span>).numAugments = <span class="hljs-number">1</span> ;
    opts(<span class="hljs-built_in">i</span>).transformation = <span class="hljs-string">'none'</span> ;
    opts(<span class="hljs-built_in">i</span>).averageImage = <span class="hljs-matrix">[]</span> ;
    opts(<span class="hljs-built_in">i</span>).rgbVariance = <span class="hljs-built_in">zeros</span>(<span class="hljs-number">0</span>,<span class="hljs-number">3</span>,<span class="hljs-string">'single'</span>) ;
    opts(<span class="hljs-built_in">i</span>).interpolation = <span class="hljs-string">'bilinear'</span> ;
    opts(<span class="hljs-built_in">i</span>).numThreads = <span class="hljs-number">1</span> ;
    opts(<span class="hljs-built_in">i</span>).prefetch = false;
    opts(<span class="hljs-built_in">i</span>).scale = <span class="hljs-number">1</span>;
    opts(<span class="hljs-built_in">i</span>) = vl_argparse(opts(<span class="hljs-built_in">i</span>), <span class="hljs-cell">{varargin{<span class="hljs-number">1</span>}</span>(<span class="hljs-built_in">i</span>),varargin<span class="hljs-cell">{<span class="hljs-number">2</span>:end}</span>});
</code></pre><p>Oh — My — God !!<br>…<br>Sir, the source code is poisonous!!<br>…</p><p><strong>The code has built-in bugs!</strong></p><p>Anyway just add a line <code>opts(i).cropSize = 227/256;</code> and give it another shot.</p><pre><code data-origin="<pre><code>opts(i).scale = 1;
opts(i).cropSize = 227/256; % added by jcsu, 2016/11/16
opts(i) = vl_argparse(opts(i), {varargin{1}(i),varargin{2:end}});
</code></pre>">opts(i).scale = 1;
opts(i).cropSize = 227/256; % added by jcsu, 2016/11/16
opts(i) = vl_argparse(opts(i), {varargin{1}(i),varargin{2:end}});
</code></pre><p>OK, Let’s remove output directory <code>checkgpu</code> and see what will happen! ‘</p><pre><code data-origin="<pre><code>&amp;gt;&amp;gt; run_experiments_bcnn_train
</code></pre>">&gt;&gt; run_experiments_bcnn_train
</code></pre><p>Matlab standard outputs:</p><pre><code data-origin="<pre><code>dataset: classes: 200 in use. These are:
   1: 001.Black_footed_Albatross (train:    30, test:    30 total:    60)
   2: 002.Laysan_Albatross (train:    30, test:    30 total:    60)
   3: 003.Sooty_Albatross (train:    30, test:    28 total:    58)
   4: 004.Groove_billed_Ani (train:    30, test:    30 total:    60)
   ...
</code></pre>">dataset: classes: 200 in use. These are:
   1: 001.Black_footed_Albatross (train:    30, test:    30 total:    60)
   2: 002.Laysan_Albatross (train:    30, test:    30 total:    60)
   3: 003.Sooty_Albatross (train:    30, test:    28 total:    58)
   4: 004.Groove_billed_Ani (train:    30, test:    30 total:    60)
   ...
</code></pre><hr class="section"><pre><code data-origin="<pre><code>199: 199.Winter_Wren (train:    30, test:    30 total:    60)
 200: 200.Common_Yellowthroat (train:    30, test:    30 total:    60)
 Inf:       **total** (train: 11788, test: 11788 total: 11788)
dataset: there are 11788 images (5994 trainval 5794 test)
Initialization: extracting bcnn feature of batch 1/185
Initialization: extracting bcnn feature of batch 2/185
...
</code></pre>">199: 199.Winter_Wren (train:    30, test:    30 total:    60)
 200: 200.Common_Yellowthroat (train:    30, test:    30 total:    60)
 Inf:       **total** (train: 11788, test: 11788 total: 11788)
dataset: there are 11788 images (5994 trainval 5794 test)
Initialization: extracting bcnn feature of batch 1/185
Initialization: extracting bcnn feature of batch 2/185
...
</code></pre><hr class="section"><pre><code data-origin="<pre><code>Initialization: extracting bcnn feature of batch 184/185
Initialization: extracting bcnn feature of batch 185/185
     layer|      0|         1|      2|
      type|  input|      conv|softmxl|
      name|    n/a|classifier|   loss|
----------|-------|----------|-------|
   support|    n/a|         1|      1|
  filt dim|    n/a|    262144|    n/a|
filt dilat|    n/a|         1|    n/a|
 num filts|    n/a|       200|    n/a|
    stride|    n/a|         1|      1|
       pad|    n/a|         0|      0|
----------|-------|----------|-------|
   rf size|    n/a|         1|      1|
 rf offset|    n/a|         1|      1|
 rf stride|    n/a|         1|      1|
----------|-------|----------|-------|
 data size|NaNxNaN|   NaNxNaN|NaNxNaN|
data depth|    NaN|       200|      1|
  data num|    256|       256|      1|
----------|-------|----------|-------|
  data mem|    NaN|       NaN|    NaN|
 param mem|    n/a|     200MB|     0B|

parameter memory|200MB (5.2e+07 parameters)|
     data memory|  NaN (for batch size 256)|
</code></pre>">Initialization: extracting bcnn feature of batch 184/185
Initialization: extracting bcnn feature of batch 185/185
     layer|      0|         1|      2|
      type|  input|      conv|softmxl|
      name|    n/a|classifier|   loss|
----------|-------|----------|-------|
   support|    n/a|         1|      1|
  filt dim|    n/a|    262144|    n/a|
filt dilat|    n/a|         1|    n/a|
 num filts|    n/a|       200|    n/a|
    stride|    n/a|         1|      1|
       pad|    n/a|         0|      0|
----------|-------|----------|-------|
   rf size|    n/a|         1|      1|
 rf offset|    n/a|         1|      1|
 rf stride|    n/a|         1|      1|
----------|-------|----------|-------|
 data size|NaNxNaN|   NaNxNaN|NaNxNaN|
data depth|    NaN|       200|      1|
  data num|    256|       256|      1|
----------|-------|----------|-------|
  data mem|    NaN|       NaN|    NaN|
 param mem|    n/a|     200MB|     0B|

parameter memory|200MB (5.2e+07 parameters)|
     data memory|  NaN (for batch size 256)|
</code></pre><p>It works! But wait… Where is the <code>vl_nnbilinearpool</code>, <code>vl_nnsqrt</code> and <code>vl_nnl2norm</code> layers? Well, it is the first stage of training, i.e., training a softmax classifier.</p><h2 id="附录-4-深入-b-cnn-源码"><a name="附录-4-深入-b-cnn-源码" href="#附录-4-深入-b-cnn-源码"></a>附录-4 深入 B-CNN 源码</h2><h4 id="1.-having-a-quick-overview."><a name="1.-having-a-quick-overview." href="#1.-having-a-quick-overview."></a>1. Having a quick overview.</h4><p><code>run_experiments_bcnn_train.m</code> under <code>/path/to/bcnn/</code> is a top-level function that performs the <strong>two-step</strong> training of a <code>B-CNN</code> model. Having a look into this function can give us a quick overview of the source code.</p><ul>
<li><p><strong>Overview of <code>run_experiments_bcnn_train.m</code></strong>:</p>
<pre><code data-origin="<pre><code>           Entry :`run_experiments_bcnn_train()`
             |
   Set Pretrained CNN(s): `bcnnmm`, `bcnnvdm`, or `bcnnvdvd` or all three
             |
  Set Model Parameters and dataset: `[opts, imdb] = model_setup(/*parameter pairs*/)
             |
   Begin to train a bcnn model: `imdb_bcnn_train_dag(imdb, opts)`
             |
            End
</code></pre>">           Entry :`run_experiments_bcnn_train()`
             |
   Set Pretrained CNN(s): `bcnnmm`, `bcnnvdm`, or `bcnnvdvd` or all three
             |
  Set Model Parameters and dataset: `[opts, imdb] = model_setup(/*parameter pairs*/)
             |
   Begin to train a bcnn model: `imdb_bcnn_train_dag(imdb, opts)`
             |
            End
</code></pre><p>  The first job of this function is to set the <code>B-CNN</code> model (<code>B-CNN[M,M]</code>, <code>B-CNN[D,D]</code>, or <code>B-CNN[M,D]</code>) to be trained and set the dataset to be trained on via struct/variables <code>bcnnxx.opts</code>, <code>setupNameList</code>, <code>encoderList</code> and <code>datasetList</code>:</p>
<pre class="matlab hljs"><code class="matlab" data-origin="<pre><code class=&quot;matlab&quot;>  % run_experiments_bcnn_train.m

  bcnnmm.name = 'bcnnmm' ;
  bcnnmm.opts = {...
  'type', 'bcnn', ...
  'modela', 'data/models/imagenet-vgg-m.mat', ...     % intialize network A with pre-trained model
  'layera', 14,...                                    % specify the output of certain layer of network A to be bilinearly combined
  'modelb', 'data/models/imagenet-vgg-m.mat', ...     % intialize network B with pre-trained model
  'layerb', 14,...                                    % specify the output of certain layer of network B to be bilinearly combined
  'shareWeight', true,...                             % true: symmetric implementation where two networks are identical
  } ;

  bcnnvdm.name = 'bcnnvdm' ;
  bcnnvdm.opts = {...
  'type', 'bcnn', ...
  'modela', 'data/models/imagenet-vgg-verydeep-16.mat', ...
  'layera', 30,...
  'modelb', 'data/models/imagenet-vgg-m.mat', ...
  'layerb', 14,...
  'shareWeight', false,...                            % false: asymmetric implementation where two networks are distinct
  } ;

  bcnnvdvd.name = 'bcnnvdvd' ;
  bcnnvdvd.opts = {...
  'type', 'bcnn', ...
  'modela', 'data/models/imagenet-vgg-verydeep-16.mat', ...
  'layera', 30,...
  'modelb', 'data/models/imagenet-vgg-verydeep-16.mat', ...
  'layerb', 30,...
  'shareWeight', true,...
  };

  setupNameList = {'bcnnmm'};
  encoderList = {{bcnnmm}};
  % setupNameList = {'bcnnvdvd'};
  % encoderList = {{bcnnvdvd}};
  datasetList = {{'cub', 1}}
</code></pre>">  <span class="hljs-comment">% run_experiments_bcnn_train.m</span>

  bcnnmm.name = <span class="hljs-string">'bcnnmm'</span> ;
  bcnnmm.opts = <span class="hljs-cell">{...
  <span class="hljs-string">'type'</span>, <span class="hljs-string">'bcnn'</span>, ...
  <span class="hljs-string">'modela'</span>, <span class="hljs-string">'data/models/imagenet-vgg-m.mat'</span>, ...     % intialize network A with pre-trained model
  <span class="hljs-string">'layera'</span>, <span class="hljs-number">14</span>,...                                    % specify the output of certain layer of network A to be bilinearly combined
  <span class="hljs-string">'modelb'</span>, <span class="hljs-string">'data/models/imagenet-vgg-m.mat'</span>, ...     % intialize network B with pre-trained model
  <span class="hljs-string">'layerb'</span>, <span class="hljs-number">14</span>,...                                    % specify the output of certain layer of network B to be bilinearly combined
  <span class="hljs-string">'shareWeight'</span>, true,...                             % true: symmetric implementation where two networks are identical
  }</span> ;

  bcnnvdm.name = <span class="hljs-string">'bcnnvdm'</span> ;
  bcnnvdm.opts = <span class="hljs-cell">{...
  <span class="hljs-string">'type'</span>, <span class="hljs-string">'bcnn'</span>, ...
  <span class="hljs-string">'modela'</span>, <span class="hljs-string">'data/models/imagenet-vgg-verydeep-16.mat'</span>, ...
  <span class="hljs-string">'layera'</span>, <span class="hljs-number">30</span>,...
  <span class="hljs-string">'modelb'</span>, <span class="hljs-string">'data/models/imagenet-vgg-m.mat'</span>, ...
  <span class="hljs-string">'layerb'</span>, <span class="hljs-number">14</span>,...
  <span class="hljs-string">'shareWeight'</span>, false,...                            % false: asymmetric implementation where two networks are distinct
  }</span> ;

  bcnnvdvd.name = <span class="hljs-string">'bcnnvdvd'</span> ;
  bcnnvdvd.opts = <span class="hljs-cell">{...
  <span class="hljs-string">'type'</span>, <span class="hljs-string">'bcnn'</span>, ...
  <span class="hljs-string">'modela'</span>, <span class="hljs-string">'data/models/imagenet-vgg-verydeep-16.mat'</span>, ...
  <span class="hljs-string">'layera'</span>, <span class="hljs-number">30</span>,...
  <span class="hljs-string">'modelb'</span>, <span class="hljs-string">'data/models/imagenet-vgg-verydeep-16.mat'</span>, ...
  <span class="hljs-string">'layerb'</span>, <span class="hljs-number">30</span>,...
  <span class="hljs-string">'shareWeight'</span>, true,...
  }</span>;

  setupNameList = <span class="hljs-cell">{<span class="hljs-string">'bcnnmm'</span>}</span>;
  encoderList = <span class="hljs-cell">{{bcnnmm}</span>};
  <span class="hljs-comment">% setupNameList = {'bcnnvdvd'};</span>
  <span class="hljs-comment">% encoderList = {{bcnnvdvd}};</span>
  datasetList = <span class="hljs-cell">{{<span class="hljs-string">'cub'</span>, <span class="hljs-number">1</span>}</span>}
</code></pre>
<p>  Then it calls function <code>model_setup</code> to set up hyper-parameters and prepare the dataset. Finally it calls function <code>imdb_bcnn_train_dag</code> to perform the <em>two-step</em> training.</p>
</li><li><p><strong>Overview of <code>model_setup(...)</code></strong>:</p>
<pre><code data-origin="<pre><code>          Entry:  `[opts, imdb] = model_setup(varargin)`
            |
  Setup data structure `opts`: `batchSize`, `numEpochs`, `learningRate`, ...
            |
  Setup data structure `opts.encoders`: what the hell is encoders?
            |
      Load dataset: `cub`, `cars`, or `aircraft`, or others
            |
           End: save imdb
</code></pre>">          Entry:  `[opts, imdb] = model_setup(varargin)`
            |
  Setup data structure `opts`: `batchSize`, `numEpochs`, `learningRate`, ...
            |
  Setup data structure `opts.encoders`: what the hell is encoders?
            |
      Load dataset: `cub`, `cars`, or `aircraft`, or others
            |
           End: save imdb
</code></pre><p>  Hyper-parameters for training is set default inside the <code>model_setup</code> function. We can change it directly inside <code>model_setup</code> or by passing a different value when the function <code>model_steup</code> is called by <code>run_experiments_bcnn_train</code>.</p>
<p>  Then it loads the dataset specified in <code>datasetList</code>:</p>
<pre class="matlab hljs"><code class="matlab" data-origin="<pre><code class=&quot;matlab&quot;>  % /path/to/bcnn/model_setup.m

      switch opts.dataset
          case 'cubcrop'
              imdb = cub_get_database(opts.cubDir, true, false);
          case 'cub'
              imdb = cub_get_database(opts.cubDir, false, opts.useVal);
          case 'aircraft-variant'
              imdb = aircraft_get_database(opts.aircraftDir, 'variant');
          case 'cars'
              imdb = cars_get_database(opts.carsDir, false, opts.useVal);
          case 'imagenet'
              imdb = cnn_imagenet_setup_data('dataDir', opts.ilsvrcDir);
          case 'imagenet-224'
              imdb = cnn_imagenet_setup_data('dataDir', opts.ilsvrcDir_224);
          otherwise
              error('Unknown dataset %s', opts.dataset) ;
      end
</code></pre>">  <span class="hljs-comment">% /path/to/bcnn/model_setup.m</span>

      <span class="hljs-keyword">switch</span> opts.dataset
          <span class="hljs-keyword">case</span> <span class="hljs-string">'cubcrop'</span>
              imdb = cub_get_database(opts.cubDir, true, false);
          <span class="hljs-keyword">case</span> <span class="hljs-string">'cub'</span>
              imdb = cub_get_database(opts.cubDir, false, opts.useVal);
          <span class="hljs-keyword">case</span> <span class="hljs-string">'aircraft-variant'</span>
              imdb = aircraft_get_database(opts.aircraftDir, <span class="hljs-string">'variant'</span>);
          <span class="hljs-keyword">case</span> <span class="hljs-string">'cars'</span>
              imdb = cars_get_database(opts.carsDir, false, opts.useVal);
          <span class="hljs-keyword">case</span> <span class="hljs-string">'imagenet'</span>
              imdb = cnn_imagenet_setup_data(<span class="hljs-string">'dataDir'</span>, opts.ilsvrcDir);
          <span class="hljs-keyword">case</span> <span class="hljs-string">'imagenet-224'</span>
              imdb = cnn_imagenet_setup_data(<span class="hljs-string">'dataDir'</span>, opts.ilsvrcDir_224);
          <span class="hljs-keyword">otherwise</span>
              error(<span class="hljs-string">'Unknown dataset %s'</span>, opts.dataset) ;
      <span class="hljs-keyword">end</span>
</code></pre>
</li><li><p><strong>Overview of <code>imdb_bcnn_train_dag(imdb, opts)</code></strong>:</p>
<pre><code data-origin="<pre><code>             Entry: `imdb_bcnn_train_dag(imdb, opts)`
               |
    Setup some training params: `opts.train....`
               |
  Build up and Initialize network: 
      `initializeNetworkSharedWeights` or ` initializeNetworkTwoStreams`
               |
  Applying SGD algorithm to train the bcnn
               |
              End: save networks
</code></pre>">             Entry: `imdb_bcnn_train_dag(imdb, opts)`
               |
    Setup some training params: `opts.train....`
               |
  Build up and Initialize network: 
      `initializeNetworkSharedWeights` or ` initializeNetworkTwoStreams`
               |
  Applying SGD algorithm to train the bcnn
               |
              End: save networks
</code></pre></li></ul><p>The <em>two-step</em> training process is performed inside <code>imdb_bcnn_train_dag.m</code>. It calls <code>initializeNetworkSharedWeights</code> or <code>initializeNetworkTwoStreams</code> to perform training step 1 and <code>bcnn_train_simplenn</code> or <code>bcnn_train_dag</code> to perform traning step 2. Some hyper-parameters of step 1 are also set inside this function.</p><h4 id="2.-analysizing-some-typical-functions-in-`bcnn-package`-which-implement-layers-of-a-`b-cnn`-model."><a name="2.-analysizing-some-typical-functions-in-`bcnn-package`-which-implement-layers-of-a-`b-cnn`-model." href="#2.-analysizing-some-typical-functions-in-`bcnn-package`-which-implement-layers-of-a-`b-cnn`-model."></a>2. Analysizing some typical functions in <code>bcnn-package</code> which implement layers of a <code>B-CNN</code> model.</h4><ul>
<li><p><strong><code>function y = vl_nnbilinearpool(x, varargin)</code></strong></p>
<pre class="matlab hljs"><code class="matlab" data-origin="<pre><code class=&quot;matlab&quot;>  % /path/to/bcnn/bcnn-package/vl_nnbilinearpool.m

  function y = vl_nnbilinearpool(x, varargin)
  % -----------------------------------------------------------------------------------
  % functionality:
  %   implementation of the feed forward pass and backward pass of 'bilinearpool', which
  %   is a layer connected next to a pretrained CNN model (or two same model)
  %
  % $x$: input feature of size [height, width, channels, batch size].
  % $varargin$: $dzdy$ when in backward pass.
  % $y$:
  %   forward pass:
  %       Self outer product of $x$.
  %       For each image with size `[height, width, channels]`, firstly
  %       reshape it into size `[height * width, channels]`, and then
  %       compute the output
  %                   $y = \frac{1}{height * width} x^T x$
  %       which gives $y$ the size `[channels, channels]`, reshape it again to a vector.
  %   backward pass:
  %       gradient of $y$ w.r.t $x$.
  %       $y$ is the same size as $x$, i.e., `[height, width, channels, batch_size]`.
  %       For each image, reshape $dzdy$ to size `[channels, channels]`
  %                       reshape $x$ to size `[height * width, channels]`.
  %       $dydx$ is caculated as:
  %                   $y = \frac{1}{height * width} x * dzdy$
  %       which gives $y$ the size `[height * width, channels]`,
  %       Reshape $y$ to `[height, width, channels]` as output.
  % -----------------------------------------------------------------------------------

  % if the number of elements in `varargin` &amp;gt; 0 and the first element is not a string
  backMode = numel(varargin) &amp;gt; 0 &amp;amp;&amp;amp; ~isstr(varargin{1})

  % if in backward mode, take out the `dzdy` in `varargin`
  if backMode dzdy = varargin{1}; end

  % if `x` is a `gpuArray`, it is in `gpuMode`
  gpuMode = isa(x, 'gpuArray');

  % unpack the size of x into height, width, number of channel, and batch size
  [h, w, ch, bs] = size(x);

  % backward mode
  if backMode
      if gpuMode
          y = gpuArray(zeros(size(x), 'single'));
      else
          y = zeros(size(x), 'single'));
      end
      % for each image / for each feature map with `ch` channels
      for b = 1:bs
          dzdy_b = reshape(dzdy(1, 1, :, b), [ch, ch]);
          a = reshape (x(:, :, :, b), [h*w, ch]);
          % caculate dydx
          y(:, :, :, b) = reshape(a * dzdy_b, [h, w, ch]) / (h * w);
      end
  else
      if gpuMode
          y = gpuArray(zeros([1, 1, ch * ch, bs], 'single'));
      else
          y = zeros([1, 1, ch * ch, bs], 'single');
      for b = 1:bs
          a = reshape(x(:, :, :, b), [h * w, ch]);
          % caculate output
          y(1, 1, :, b) = reshape(a'*a, [1, ch*ch]) / (h * w);
      end
  end
</code></pre>">  <span class="hljs-comment">% /path/to/bcnn/bcnn-package/vl_nnbilinearpool.m</span>

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">y</span> = <span class="hljs-title">vl_nnbilinearpool</span><span class="hljs-params">(x, varargin)</span></span>
  <span class="hljs-comment">% -----------------------------------------------------------------------------------</span>
  <span class="hljs-comment">% functionality:</span>
  <span class="hljs-comment">%   implementation of the feed forward pass and backward pass of 'bilinearpool', which</span>
  <span class="hljs-comment">%   is a layer connected next to a pretrained CNN model (or two same model)</span>
  <span class="hljs-comment">%</span>
  <span class="hljs-comment">% $x$: input feature of size [height, width, channels, batch size].</span>
  <span class="hljs-comment">% $varargin$: $dzdy$ when in backward pass.</span>
  <span class="hljs-comment">% $y$:</span>
  <span class="hljs-comment">%   forward pass:</span>
  <span class="hljs-comment">%       Self outer product of $x$.</span>
  <span class="hljs-comment">%       For each image with size `[height, width, channels]`, firstly</span>
  <span class="hljs-comment">%       reshape it into size `[height * width, channels]`, and then</span>
  <span class="hljs-comment">%       compute the output</span>
  <span class="hljs-comment">%                   $y = \frac{1}{height * width} x^T x$</span>
  <span class="hljs-comment">%       which gives $y$ the size `[channels, channels]`, reshape it again to a vector.</span>
  <span class="hljs-comment">%   backward pass:</span>
  <span class="hljs-comment">%       gradient of $y$ w.r.t $x$.</span>
  <span class="hljs-comment">%       $y$ is the same size as $x$, i.e., `[height, width, channels, batch_size]`.</span>
  <span class="hljs-comment">%       For each image, reshape $dzdy$ to size `[channels, channels]`</span>
  <span class="hljs-comment">%                       reshape $x$ to size `[height * width, channels]`.</span>
  <span class="hljs-comment">%       $dydx$ is caculated as:</span>
  <span class="hljs-comment">%                   $y = \frac{1}{height * width} x * dzdy$</span>
  <span class="hljs-comment">%       which gives $y$ the size `[height * width, channels]`,</span>
  <span class="hljs-comment">%       Reshape $y$ to `[height, width, channels]` as output.</span>
  <span class="hljs-comment">% -----------------------------------------------------------------------------------</span>

  <span class="hljs-comment">% if the number of elements in `varargin` &gt; 0 and the first element is not a string</span>
  backMode = <span class="hljs-built_in">numel</span>(varargin) &gt; <span class="hljs-number">0</span> &amp;&amp; ~isstr(varargin<span class="hljs-cell">{<span class="hljs-number">1</span>}</span>)

  <span class="hljs-comment">% if in backward mode, take out the `dzdy` in `varargin`</span>
  <span class="hljs-keyword">if</span> backMode dzdy = varargin<span class="hljs-cell">{<span class="hljs-number">1</span>}</span>; <span class="hljs-keyword">end</span>

  <span class="hljs-comment">% if `x` is a `gpuArray`, it is in `gpuMode`</span>
  gpuMode = isa(x, <span class="hljs-string">'gpuArray'</span>);

  <span class="hljs-comment">% unpack the size of x into height, width, number of channel, and batch size</span>
  <span class="hljs-matrix">[h, w, ch, bs]</span> = <span class="hljs-built_in">size</span>(x);

  <span class="hljs-comment">% backward mode</span>
  <span class="hljs-keyword">if</span> backMode
      <span class="hljs-keyword">if</span> gpuMode
          y = gpuArray(<span class="hljs-built_in">zeros</span>(<span class="hljs-built_in">size</span>(x), <span class="hljs-string">'single'</span>));
      <span class="hljs-keyword">else</span>
          y = <span class="hljs-built_in">zeros</span>(<span class="hljs-built_in">size</span>(x), <span class="hljs-string">'single'</span>));
      <span class="hljs-keyword">end</span>
      <span class="hljs-comment">% for each image / for each feature map with `ch` channels</span>
      <span class="hljs-keyword">for</span> b = <span class="hljs-number">1</span>:bs
          dzdy_b = <span class="hljs-built_in">reshape</span>(dzdy(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, :, b), <span class="hljs-matrix">[ch, ch]</span>);
          a = <span class="hljs-built_in">reshape</span> (x(:, :, :, b), <span class="hljs-matrix">[h*w, ch]</span>);
          <span class="hljs-comment">% caculate dydx</span>
          y(:, :, :, b) = <span class="hljs-built_in">reshape</span>(a * dzdy_b, <span class="hljs-matrix">[h, w, ch]</span>) / (h * w);
      <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">if</span> gpuMode
          y = gpuArray(<span class="hljs-built_in">zeros</span>(<span class="hljs-matrix">[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, ch * ch, bs]</span>, <span class="hljs-string">'single'</span>));
      <span class="hljs-keyword">else</span>
          y = <span class="hljs-built_in">zeros</span>(<span class="hljs-matrix">[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, ch * ch, bs]</span>, <span class="hljs-string">'single'</span>);
      <span class="hljs-keyword">for</span> b = <span class="hljs-number">1</span>:bs
          a = <span class="hljs-built_in">reshape</span>(x(:, :, :, b), <span class="hljs-matrix">[h * w, ch]</span>);
          <span class="hljs-comment">% caculate output</span>
          y(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, :, b) = <span class="hljs-built_in">reshape</span>(a<span class="hljs-operator">'</span>*a, <span class="hljs-matrix">[<span class="hljs-number">1</span>, ch*ch]</span>) / (h * w);
      <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
</code></pre>
</li><li><p><strong><code>function y = vl_nnbilinearclpool(x1, x2, varargin)</code></strong></p>
<pre class="matlab hljs"><code class="matlab" data-origin="<pre><code class=&quot;matlab&quot;>  % /path/to/bcnn/bcnn-package/vl_nnbilinearclpool.m

  function y = vl_nnbilinearclpool(x1, x2, varargin)
  % -----------------------------------------------------------------------------------
  % functionality:
  %   implementation of the feed forward pass and backward pass of 'bilinearclpool', which
  %   is a layer connected next to a pretrained CNN model (or two same model)
  %
  % $x$: input feature of size [height, width, channels, batch size].
  % $varargin$: $dzdy$ when in backward pass.
  % $y$:
  %   forward pass:
  %       Self outer product of $x$.
  %       For each image with size `[height, width, channels]`, firstly
  %       reshape it into size `[height * width, channels]`, and then
  %       compute the output
  %                   $y = \frac{1}{height * width} x^T x$
  %       which gives $y$ the size `[channels, channels]`, reshape it again to a vector.
  %   backward pass:
  %       gradient of $y$ w.r.t $x$.
  %       $y$ is the same size as $x$, i.e., `[height, width, channels, batch_size]`.
  %       For each image, reshape $dzdy$ to size `[channels, channels]`
  %                       reshape $x$ to size `[height * width, channels]`.
  %       $dydx$ is caculated as:
  %                   $y = \frac{1}{height * width} x * dzdy$
  %       which gives $y$ the size `[height * width, channels]`,
  %       Reshape $y$ to `[height, width, channels]` as output.
  % -----------------------------------------------------------------------------------

  % if the number of elements in `varargin` &amp;gt; 0 and the first element is not a string
  backMode = numel(varargin) &amp;gt; 0 &amp;amp;&amp;amp; ~isstr(varargin{1})

  % if in backward mode, take out the `dzdy` in `varargin`
  if backMode dzdy = varargin{1}; end

  % if `x` is a `gpuArray`, it is in `gpuMode`
  gpuMode = isa(x1, 'gpuArray');

  % unpack the size of x into height, width, number of channel, and batch size
  [h1, w1, ch1, bs] = size(x1);
  [h2, w2, ch2, ~] = size(x2);

  % resize the CNN output to the same size
  if w1 * h1 &amp;lt;= w2 * h2
      % downsample feature 2
      x2 = array_resize(x2, w1, h1);
  else
      % downsample feature 1
      x1 = array_resize(x1, w2, h2);
  end
  h = size(x1, 1); w = size(x1, 2);

  % backward mode
  if backMode
      if gpuMode
          y = gpuArray(zeros(size(x), 'single'));
      else
          y = zeros(size(x), 'single'));
      end
      % for each image / for each feature map with `ch` channels
      for b = 1:bs
          dzdy_b = reshape(dzdy(1, 1, :, b), [ch1, ch2]);
          A = reshape (x1(:, :, :, b), [h*w, ch1]);
          B = reshape (x2(:, :, :, b), [h*w, ch2]);
          dB = reshape(A * dzdy_b, [h, w, ch2]);
          dA = reshape(B * dzdy_b', [h, w, ch1]); %'
          if w1 * h1 &amp;lt;= w2 * h2
              % B is downsampled
          else
              % A is downsampled
      end
  % feed forward pass
  else
      if gpuMode
          y = gpuArray(zeros([1, 1, ch1 * ch2, bs], 'single'));
      else
          y = zeros([1, 1, ch1 * ch2, bs], 'single');
      for b = 1:bs
          xa = reshape(x1(:, :, :, b), [h * w, ch1]);
          xb = reshape(x2(:, :, :, b), [h * w, ch2]);
          y(1, 1, :, b) = reshape(xa'*xb, [1, ch1*ch2]); % why not '/(h *w)'?
      end
  end

  function Ar = array_resize(A, w, h)
  %-----------------------------------------
  % downsample A with size `[w, h]`
  %-----------------------------------------

  ...
</code></pre>">  <span class="hljs-comment">% /path/to/bcnn/bcnn-package/vl_nnbilinearclpool.m</span>

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">y</span> = <span class="hljs-title">vl_nnbilinearclpool</span><span class="hljs-params">(x1, x2, varargin)</span></span>
  <span class="hljs-comment">% -----------------------------------------------------------------------------------</span>
  <span class="hljs-comment">% functionality:</span>
  <span class="hljs-comment">%   implementation of the feed forward pass and backward pass of 'bilinearclpool', which</span>
  <span class="hljs-comment">%   is a layer connected next to a pretrained CNN model (or two same model)</span>
  <span class="hljs-comment">%</span>
  <span class="hljs-comment">% $x$: input feature of size [height, width, channels, batch size].</span>
  <span class="hljs-comment">% $varargin$: $dzdy$ when in backward pass.</span>
  <span class="hljs-comment">% $y$:</span>
  <span class="hljs-comment">%   forward pass:</span>
  <span class="hljs-comment">%       Self outer product of $x$.</span>
  <span class="hljs-comment">%       For each image with size `[height, width, channels]`, firstly</span>
  <span class="hljs-comment">%       reshape it into size `[height * width, channels]`, and then</span>
  <span class="hljs-comment">%       compute the output</span>
  <span class="hljs-comment">%                   $y = \frac{1}{height * width} x^T x$</span>
  <span class="hljs-comment">%       which gives $y$ the size `[channels, channels]`, reshape it again to a vector.</span>
  <span class="hljs-comment">%   backward pass:</span>
  <span class="hljs-comment">%       gradient of $y$ w.r.t $x$.</span>
  <span class="hljs-comment">%       $y$ is the same size as $x$, i.e., `[height, width, channels, batch_size]`.</span>
  <span class="hljs-comment">%       For each image, reshape $dzdy$ to size `[channels, channels]`</span>
  <span class="hljs-comment">%                       reshape $x$ to size `[height * width, channels]`.</span>
  <span class="hljs-comment">%       $dydx$ is caculated as:</span>
  <span class="hljs-comment">%                   $y = \frac{1}{height * width} x * dzdy$</span>
  <span class="hljs-comment">%       which gives $y$ the size `[height * width, channels]`,</span>
  <span class="hljs-comment">%       Reshape $y$ to `[height, width, channels]` as output.</span>
  <span class="hljs-comment">% -----------------------------------------------------------------------------------</span>

  <span class="hljs-comment">% if the number of elements in `varargin` &gt; 0 and the first element is not a string</span>
  backMode = <span class="hljs-built_in">numel</span>(varargin) &gt; <span class="hljs-number">0</span> &amp;&amp; ~isstr(varargin<span class="hljs-cell">{<span class="hljs-number">1</span>}</span>)

  <span class="hljs-comment">% if in backward mode, take out the `dzdy` in `varargin`</span>
  <span class="hljs-keyword">if</span> backMode dzdy = varargin<span class="hljs-cell">{<span class="hljs-number">1</span>}</span>; <span class="hljs-keyword">end</span>

  <span class="hljs-comment">% if `x` is a `gpuArray`, it is in `gpuMode`</span>
  gpuMode = isa(x1, <span class="hljs-string">'gpuArray'</span>);

  <span class="hljs-comment">% unpack the size of x into height, width, number of channel, and batch size</span>
  <span class="hljs-matrix">[h1, w1, ch1, bs]</span> = <span class="hljs-built_in">size</span>(x1);
  <span class="hljs-matrix">[h2, w2, ch2, ~]</span> = <span class="hljs-built_in">size</span>(x2);

  <span class="hljs-comment">% resize the CNN output to the same size</span>
  <span class="hljs-keyword">if</span> w1 * h1 &lt;= w2 * h2
      <span class="hljs-comment">% downsample feature 2</span>
      x2 = array_resize(x2, w1, h1);
  <span class="hljs-keyword">else</span>
      <span class="hljs-comment">% downsample feature 1</span>
      x1 = array_resize(x1, w2, h2);
  <span class="hljs-keyword">end</span>
  h = <span class="hljs-built_in">size</span>(x1, <span class="hljs-number">1</span>); w = <span class="hljs-built_in">size</span>(x1, <span class="hljs-number">2</span>);

  <span class="hljs-comment">% backward mode</span>
  <span class="hljs-keyword">if</span> backMode
      <span class="hljs-keyword">if</span> gpuMode
          y = gpuArray(<span class="hljs-built_in">zeros</span>(<span class="hljs-built_in">size</span>(x), <span class="hljs-string">'single'</span>));
      <span class="hljs-keyword">else</span>
          y = <span class="hljs-built_in">zeros</span>(<span class="hljs-built_in">size</span>(x), <span class="hljs-string">'single'</span>));
      <span class="hljs-keyword">end</span>
      <span class="hljs-comment">% for each image / for each feature map with `ch` channels</span>
      <span class="hljs-keyword">for</span> b = <span class="hljs-number">1</span>:bs
          dzdy_b = <span class="hljs-built_in">reshape</span>(dzdy(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, :, b), <span class="hljs-matrix">[ch1, ch2]</span>);
          A = <span class="hljs-built_in">reshape</span> (x1(:, :, :, b), <span class="hljs-matrix">[h*w, ch1]</span>);
          B = <span class="hljs-built_in">reshape</span> (x2(:, :, :, b), <span class="hljs-matrix">[h*w, ch2]</span>);
          dB = <span class="hljs-built_in">reshape</span>(A * dzdy_b, <span class="hljs-matrix">[h, w, ch2]</span>);
          dA = <span class="hljs-built_in">reshape</span>(B * dzdy_b<span class="hljs-operator">'</span>, <span class="hljs-matrix">[h, w, ch1]</span>); <span class="hljs-comment">%'</span>
          <span class="hljs-keyword">if</span> w1 * h1 &lt;= w2 * h2
              <span class="hljs-comment">% B is downsampled</span>
          <span class="hljs-keyword">else</span>
              <span class="hljs-comment">% A is downsampled</span>
      <span class="hljs-keyword">end</span>
  <span class="hljs-comment">% feed forward pass</span>
  <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">if</span> gpuMode
          y = gpuArray(<span class="hljs-built_in">zeros</span>(<span class="hljs-matrix">[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, ch1 * ch2, bs]</span>, <span class="hljs-string">'single'</span>));
      <span class="hljs-keyword">else</span>
          y = <span class="hljs-built_in">zeros</span>(<span class="hljs-matrix">[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, ch1 * ch2, bs]</span>, <span class="hljs-string">'single'</span>);
      <span class="hljs-keyword">for</span> b = <span class="hljs-number">1</span>:bs
          xa = <span class="hljs-built_in">reshape</span>(x1(:, :, :, b), <span class="hljs-matrix">[h * w, ch1]</span>);
          xb = <span class="hljs-built_in">reshape</span>(x2(:, :, :, b), <span class="hljs-matrix">[h * w, ch2]</span>);
          y(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, :, b) = <span class="hljs-built_in">reshape</span>(xa<span class="hljs-operator">'</span>*xb, <span class="hljs-matrix">[<span class="hljs-number">1</span>, ch1*ch2]</span>); <span class="hljs-comment">% why not '/(h *w)'?</span>
      <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Ar</span> = <span class="hljs-title">array_resize</span><span class="hljs-params">(A, w, h)</span></span>
  <span class="hljs-comment">%-----------------------------------------</span>
  <span class="hljs-comment">% downsample A with size `[w, h]`</span>
  <span class="hljs-comment">%-----------------------------------------</span>

  ...
</code></pre>
</li><li><p><strong><code>function y = vl_nnsqrt(x, param, varagin)</code></strong></p>
<pre class="matlab hljs"><code class="matlab" data-origin="<pre><code class=&quot;matlab&quot;>  % /path/to/bcnn/bcnn-package/vl_nnsqrt.m

  function y = vl_nnsqrt(x, param, varagin)
  % ---------------------------------------------------------------------
  % functionality: perform square root normalization for the input features
  %                at each location
  %
  % x: the input features of size [height, width, channels, batch_size]
  % param: the threshold to prevent large value when close to 0
  % varargin: dzdy, only needed in backward pass
  % y:
  %     forward pass:
  %         y = sign(x) .* sqrt(|x|)
  %     backward pass:
  %         dydx = 0.5 ./ sqrt(|x| + param)
  %         y = dydx .* dzdy % the chain rule
  % ---------------------------------------------------------------------
</code></pre>">  <span class="hljs-comment">% /path/to/bcnn/bcnn-package/vl_nnsqrt.m</span>

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">y</span> = <span class="hljs-title">vl_nnsqrt</span><span class="hljs-params">(x, param, varagin)</span></span>
  <span class="hljs-comment">% ---------------------------------------------------------------------</span>
  <span class="hljs-comment">% functionality: perform square root normalization for the input features</span>
  <span class="hljs-comment">%                at each location</span>
  <span class="hljs-comment">%</span>
  <span class="hljs-comment">% x: the input features of size [height, width, channels, batch_size]</span>
  <span class="hljs-comment">% param: the threshold to prevent large value when close to 0</span>
  <span class="hljs-comment">% varargin: dzdy, only needed in backward pass</span>
  <span class="hljs-comment">% y:</span>
  <span class="hljs-comment">%     forward pass:</span>
  <span class="hljs-comment">%         y = sign(x) .* sqrt(|x|)</span>
  <span class="hljs-comment">%     backward pass:</span>
  <span class="hljs-comment">%         dydx = 0.5 ./ sqrt(|x| + param)</span>
  <span class="hljs-comment">%         y = dydx .* dzdy % the chain rule</span>
  <span class="hljs-comment">% ---------------------------------------------------------------------</span>
</code></pre>
</li><li><p><strong><code>function y = vl_nnl2norm(x, param, varagin)</code></strong></p>
<pre class="matlab hljs"><code class="matlab" data-origin="<pre><code class=&quot;matlab&quot;>  % /path/to/bcnn/bcnn-package/vl_nnl2norm.m

  function y = vl_nnl2norm(x, param, varagin)
  % ---------------------------------------------------------------------
  % functionality: perform square root normalization for the input features
  %                at each location
  %
  % x: the input features of size [height, width, channels, batch_size]
  % param: the threshold to prevent large value when the norm is close to 0
  % varargin: dzdy, only needed in backward pass
  % y:
  %     forward pass:
  %         y = x ./ ||x||  % note: ||x|| is l-2 norm
  %     backward pass:
  %         \frac{d}{dx_j}(x./||x||) = \frack{1}{||x||^3}(x_1^2 + ... + x_{j-1}^2 + x_{j+1}^2 + ... + x_n^2)
  %         (d/dx_j)(x./||x||) = 1 / ||x|| - x_j^2 / ||x|| ^ 3
  %         gradient(x./||x||) = 1 / ||x|| - x.^2 / ||x|| ^ 3
  % ---------------------------------------------------------------------
</code></pre>">  <span class="hljs-comment">% /path/to/bcnn/bcnn-package/vl_nnl2norm.m</span>

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">y</span> = <span class="hljs-title">vl_nnl2norm</span><span class="hljs-params">(x, param, varagin)</span></span>
  <span class="hljs-comment">% ---------------------------------------------------------------------</span>
  <span class="hljs-comment">% functionality: perform square root normalization for the input features</span>
  <span class="hljs-comment">%                at each location</span>
  <span class="hljs-comment">%</span>
  <span class="hljs-comment">% x: the input features of size [height, width, channels, batch_size]</span>
  <span class="hljs-comment">% param: the threshold to prevent large value when the norm is close to 0</span>
  <span class="hljs-comment">% varargin: dzdy, only needed in backward pass</span>
  <span class="hljs-comment">% y:</span>
  <span class="hljs-comment">%     forward pass:</span>
  <span class="hljs-comment">%         y = x ./ ||x||  % note: ||x|| is l-2 norm</span>
  <span class="hljs-comment">%     backward pass:</span>
  <span class="hljs-comment">%         \frac{d}{dx_j}(x./||x||) = \frack{1}{||x||^3}(x_1^2 + ... + x_{j-1}^2 + x_{j+1}^2 + ... + x_n^2)</span>
  <span class="hljs-comment">%         (d/dx_j)(x./||x||) = 1 / ||x|| - x_j^2 / ||x|| ^ 3</span>
  <span class="hljs-comment">%         gradient(x./||x||) = 1 / ||x|| - x.^2 / ||x|| ^ 3</span>
  <span class="hljs-comment">% ---------------------------------------------------------------------</span>
</code></pre>
</li></ul><h4 id="3.-looking-into-the-code-of-preparing-dataset."><a name="3.-looking-into-the-code-of-preparing-dataset." href="#3.-looking-into-the-code-of-preparing-dataset."></a>3. Looking into the code of preparing dataset.</h4><p>Before using the birds dataset <code>cub</code>, have a look into its function <code>imdb = cub_get_database(cubDir, useCropped, useVal)</code>:</p><pre class="matlab hljs"><code class="matlab" data-origin="<pre><code class=&quot;matlab&quot;>% cub_get_database.m

% the directory where the real images reside
if useCropped
    imdb.imageDir = fullfile(cubDir, 'images_cropped') ;
else
    imdb.imageDir = fullfile(cubDir, 'images');
end

...

% read the class names, image names, bounding boxes, lables...

[~, classNames] = textread(fullfile(cubDir, 'classes.txt'), '%d %s');
imdb.classes.name = horzcat(classNames(:));

% Image names
[~, imageNames] = textread(fullfile(cubDir, 'images.txt'), '%d %s');
imdb.images.name = imageNames;
imdb.images.id = (1:numel(imdb.images.name));

...

% if use validation, set 1/3 to validation set
if useVal
    rng(0)
    trainSize = numel(find(imageSet==1));

    trainIdx = find(imageSet==1);

    % set 1/3 of train set to validation
    valIdx = trainIdx(randperm(trainSize, round(trainSize/3)));
    imdb.images.set(valIdx) = 2;
end

...
</code></pre>"><span class="hljs-comment">% cub_get_database.m</span>

<span class="hljs-comment">% the directory where the real images reside</span>
<span class="hljs-keyword">if</span> useCropped
    imdb.imageDir = fullfile(cubDir, <span class="hljs-string">'images_cropped'</span>) ;
<span class="hljs-keyword">else</span>
    imdb.imageDir = fullfile(cubDir, <span class="hljs-string">'images'</span>);
<span class="hljs-keyword">end</span>

...

<span class="hljs-comment">% read the class names, image names, bounding boxes, lables...</span>

<span class="hljs-matrix">[~, classNames]</span> = textread(fullfile(cubDir, <span class="hljs-string">'classes.txt'</span>), <span class="hljs-string">'%d %s'</span>);
imdb.classes.name = horzcat(classNames(:));

<span class="hljs-comment">% Image names</span>
<span class="hljs-matrix">[~, imageNames]</span> = textread(fullfile(cubDir, <span class="hljs-string">'images.txt'</span>), <span class="hljs-string">'%d %s'</span>);
imdb.images.name = imageNames;
imdb.images.id = (<span class="hljs-number">1</span>:<span class="hljs-built_in">numel</span>(imdb.images.name));

...

<span class="hljs-comment">% if use validation, set 1/3 to validation set</span>
<span class="hljs-keyword">if</span> useVal
    rng(<span class="hljs-number">0</span>)
    trainSize = <span class="hljs-built_in">numel</span>(<span class="hljs-built_in">find</span>(imageSet==<span class="hljs-number">1</span>));

    trainIdx = <span class="hljs-built_in">find</span>(imageSet==<span class="hljs-number">1</span>);

    <span class="hljs-comment">% set 1/3 of train set to validation</span>
    valIdx = trainIdx(randperm(trainSize, <span class="hljs-built_in">round</span>(trainSize/<span class="hljs-number">3</span>)));
    imdb.images.set(valIdx) = <span class="hljs-number">2</span>;
<span class="hljs-keyword">end</span>

...
</code></pre><p>Download the CUB-200-2011 dataset and unzip and find that all the required files are contained in the package, all we need to do is put the directory under <code>/path/to/bcnn_root/data</code> with a new name <code>cub</code>.</p><ul>
<li>Dataset details:<ul>
<li>Birds: <a href="http://www.vision.caltech.edu/visipedia/CUB-200-2011.html">CUB-200-2011 dataset</a>.</li><li>Aircrafts: <a href="http://www.robots.ox.ac.uk/~vgg/data/oid/">FGVC aircraft dataset</a></li><li>Cars: <a href="http://ai.stanford.edu/~jkrause/cars/car_dataset.html">Stanford cars dataset</a></li></ul>
</li><li>These results are with domain specific fine-tuning. For more details see the updated <a href="http://arxiv.org/abs/1504.07889">B-CNN tech report</a>.</li></ul><p>The job of <code>cub_get_database.m</code> is to build up a structure <code>imdb</code>:</p><pre><code data-origin="<pre><code>imdb =

    imageDir: 'data/cub/images'
     maskDir: 'data/cub/masks'
        sets: {'train'  'val'  'test'}
     classes: [1x1 struct]
      images: [1x1 struct]
        meta: [1x1 struct]

imdb.images =

         name: {11788x1 cell}
           id: [1x11788 double]
        label: [1x11788 double]
       bounds: [4x11788 double]
          set: [1x11788 double]
    difficult: [1x11788 logical]
</code></pre>">imdb =

    imageDir: 'data/cub/images'
     maskDir: 'data/cub/masks'
        sets: {'train'  'val'  'test'}
     classes: [1x1 struct]
      images: [1x1 struct]
        meta: [1x1 struct]

imdb.images =

         name: {11788x1 cell}
           id: [1x11788 double]
        label: [1x11788 double]
       bounds: [4x11788 double]
          set: [1x11788 double]
    difficult: [1x11788 logical]
</code></pre><p>This structure seems quite clear. Only to note the member <code>imdb.images.set</code>, others are trivial.</p><pre class="matlab hljs"><code class="matlab" data-origin="<pre><code class=&quot;matlab&quot;>% /path/to/bcnn_root/cub_get_database.m
    ...
    imdb.images.set(imageSet == 1) = 1; % 1  for training
    imdb.images.set(imageSet == 0) = 3; % 3  for test

    if useVal
        ...
        % set 1/3 of train set to validation
        valIdx = trainIdx(randperm(trainSize, round(trainSize/3)));
        imdb.images.set(valIdx) = 2; % 2 for validation
    end
    ...
</code></pre>"><span class="hljs-comment">% /path/to/bcnn_root/cub_get_database.m</span>
    ...
    imdb.images.set(imageSet == <span class="hljs-number">1</span>) = <span class="hljs-number">1</span>; <span class="hljs-comment">% 1  for training</span>
    imdb.images.set(imageSet == <span class="hljs-number">0</span>) = <span class="hljs-number">3</span>; <span class="hljs-comment">% 3  for test</span>

    <span class="hljs-keyword">if</span> useVal
        ...
        <span class="hljs-comment">% set 1/3 of train set to validation</span>
        valIdx = trainIdx(randperm(trainSize, <span class="hljs-built_in">round</span>(trainSize/<span class="hljs-number">3</span>)));
        imdb.images.set(valIdx) = <span class="hljs-number">2</span>; <span class="hljs-comment">% 2 for validation</span>
    <span class="hljs-keyword">end</span>
    ...
</code></pre><p>That <code>imdb.images.set</code> contains a set of <code>set-lables</code>, one for each image. <code>1</code> lables the image for using in training, <code>2</code> for validation, and <code>3</code> for testing.</p><p>Let’s trace the <code>imdb.iamges.set</code> to see how it is used in other files:</p><pre class="bash hljs"><code class="bash" data-origin="<pre><code class=&quot;bash&quot;>    $ grep imdb.images.set ./*.m
</code></pre>">    $ grep imdb.images.set ./*.m
</code></pre><hr class="section"><pre class="matlab hljs"><code class="matlab" data-origin="<pre><code class=&quot;matlab&quot;>    ./bcnn_train_dag.m:if isempty(opts.train), opts.train = find(imdb.images.set==1) ; end
    ./bcnn_train_dag.m:if isempty(opts.val), opts.val = find(imdb.images.set==2) ; end
    ./bcnn_train_simplenn.m:if isempty(opts.train), opts.train = find(imdb.images.set==1) ; end
    ./bcnn_train_simplenn.m:if isempty(opts.val), opts.val = find(imdb.images.set==2) ; end
    ./bird_demo.m:imageInd = find(imdb.images.label == classId &amp;amp; imdb.images.set == 1);
    ./imdb_bcnn_train_dag.m:train = find(imdb.images.set == 1) ;
    ./imdb_cnn_train.m:      train = find(imdb.images.set == 1) ;
    ./initializeNetworkSharedWeights.m:    train = find(imdb.images.set==1|imdb.images.set==2);
    ./initializeNetworkTwoStreams.m:        train = find(ismember(imdb.images.set, [1 2]));
    ./model_train.m:        train = find(ismember(imdb.images.set, [1 2])) ;
    ./model_train.m:    train = ismember(imdb.images.set, [1 2]) ;
    ./model_train.m:    test = ismember(imdb.images.set, 3) ;
    ./print_dataset_info.m:train = ismember(imdb.images.set, [1 2]) ;
    ./print_dataset_info.m:test = ismember(imdb.images.set, [3]) ;
    ./run_experiments_bcnn_train.m:          imdb.images.set(imdb.images.set==3) = 2;
</code></pre>">    ./bcnn_train_dag.m:<span class="hljs-keyword">if</span> <span class="hljs-built_in">isempty</span>(opts.train), opts.train = <span class="hljs-built_in">find</span>(imdb.images.set==<span class="hljs-number">1</span>) ; <span class="hljs-keyword">end</span>
    ./bcnn_train_dag.m:<span class="hljs-keyword">if</span> <span class="hljs-built_in">isempty</span>(opts.val), opts.val = <span class="hljs-built_in">find</span>(imdb.images.set==<span class="hljs-number">2</span>) ; <span class="hljs-keyword">end</span>
    ./bcnn_train_simplenn.m:<span class="hljs-keyword">if</span> <span class="hljs-built_in">isempty</span>(opts.train), opts.train = <span class="hljs-built_in">find</span>(imdb.images.set==<span class="hljs-number">1</span>) ; <span class="hljs-keyword">end</span>
    ./bcnn_train_simplenn.m:<span class="hljs-keyword">if</span> <span class="hljs-built_in">isempty</span>(opts.val), opts.val = <span class="hljs-built_in">find</span>(imdb.images.set==<span class="hljs-number">2</span>) ; <span class="hljs-keyword">end</span>
    ./bird_demo.m:imageInd = <span class="hljs-built_in">find</span>(imdb.images.label == classId &amp; imdb.images.set == <span class="hljs-number">1</span>);
    ./imdb_bcnn_train_dag.m:train = <span class="hljs-built_in">find</span>(imdb.images.set == <span class="hljs-number">1</span>) ;
    ./imdb_cnn_train.m:      train = <span class="hljs-built_in">find</span>(imdb.images.set == <span class="hljs-number">1</span>) ;
    ./initializeNetworkSharedWeights.m:    train = <span class="hljs-built_in">find</span>(imdb.images.set==<span class="hljs-number">1</span>|imdb.images.set==<span class="hljs-number">2</span>);
    ./initializeNetworkTwoStreams.m:        train = <span class="hljs-built_in">find</span>(ismember(imdb.images.set, <span class="hljs-matrix">[<span class="hljs-number">1</span> <span class="hljs-number">2</span>]</span>));
    ./model_train.m:        train = <span class="hljs-built_in">find</span>(ismember(imdb.images.set, <span class="hljs-matrix">[<span class="hljs-number">1</span> <span class="hljs-number">2</span>]</span>)) ;
    ./model_train.m:    train = ismember(imdb.images.set, <span class="hljs-matrix">[<span class="hljs-number">1</span> <span class="hljs-number">2</span>]</span>) ;
    ./model_train.m:    test = ismember(imdb.images.set, <span class="hljs-number">3</span>) ;
    ./print_dataset_info.m:train = ismember(imdb.images.set, <span class="hljs-matrix">[<span class="hljs-number">1</span> <span class="hljs-number">2</span>]</span>) ;
    ./print_dataset_info.m:test = ismember(imdb.images.set, <span class="hljs-matrix">[<span class="hljs-number">3</span>]</span>) ;
    ./run_experiments_bcnn_train.m:          imdb.images.set(imdb.images.set==<span class="hljs-number">3</span>) = <span class="hljs-number">2</span>;
</code></pre><p>The lines with <code>./bcnn_train_dag.m</code> and <code>./bcnn_train_simplenn.m</code> are doing the jobs of extracting images with label <code>1</code> as training set and images with <code>2</code> as validation set. But none of the lines are related to label <code>3</code>, i.e., the test set, except three lines:</p><pre class="matlab hljs"><code class="matlab" data-origin="<pre><code class=&quot;matlab&quot;>    ./model_train.m:    test = ismember(imdb.images.set, 3) ;
    ./print_dataset_info.m:train = ismember(imdb.images.set, [1 2]) ;
    ./print_dataset_info.m:test = ismember(imdb.images.set, [3]) ;
    ./run_experiments_bcnn_train.m:          imdb.images.set(imdb.images.set==3) = 2;
</code></pre>">    ./model_train.m:    test = ismember(imdb.images.set, <span class="hljs-number">3</span>) ;
    ./print_dataset_info.m:train = ismember(imdb.images.set, <span class="hljs-matrix">[<span class="hljs-number">1</span> <span class="hljs-number">2</span>]</span>) ;
    ./print_dataset_info.m:test = ismember(imdb.images.set, <span class="hljs-matrix">[<span class="hljs-number">3</span>]</span>) ;
    ./run_experiments_bcnn_train.m:          imdb.images.set(imdb.images.set==<span class="hljs-number">3</span>) = <span class="hljs-number">2</span>;
</code></pre><p><code>model_train</code> is called by <code>run_experiments.m</code> and has no bussiness with <code>run_experiments_bcnn_train.m</code>. <code>print_dataset_info.m</code> prints out information about the dataset like:</p><pre class="matlab hljs"><code class="matlab" data-origin="<pre><code class=&quot;matlab&quot;>    &amp;gt;&amp;gt; print_dataset_info(imdb)
        dataset: classes: 200 in use. These are:
           1: 001.Black_footed_Albatross (train:    60, test:     0 total:    60)
           2: 002.Laysan_Albatross (train:    60, test:     0 total:    60)
           3: 003.Sooty_Albatross (train:    58, test:     0 total:    58)
           4: 004.Groove_billed_Ani (train:    60, test:     0 total:    60)
</code></pre>">    &gt;&gt; print_dataset_info(imdb)
        dataset: classes: <span class="hljs-number">200</span> in use. These are:
           <span class="hljs-number">1</span>: <span class="hljs-number">001.</span>Black_footed_Albatross (train:    <span class="hljs-number">60</span>, test:     <span class="hljs-number">0</span> total:    <span class="hljs-number">60</span>)
           <span class="hljs-number">2</span>: <span class="hljs-number">002.</span>Laysan_Albatross (train:    <span class="hljs-number">60</span>, test:     <span class="hljs-number">0</span> total:    <span class="hljs-number">60</span>)
           <span class="hljs-number">3</span>: <span class="hljs-number">003.</span>Sooty_Albatross (train:    <span class="hljs-number">58</span>, test:     <span class="hljs-number">0</span> total:    <span class="hljs-number">58</span>)
           <span class="hljs-number">4</span>: <span class="hljs-number">004.</span>Groove_billed_Ani (train:    <span class="hljs-number">60</span>, test:     <span class="hljs-number">0</span> total:    <span class="hljs-number">60</span>)
</code></pre><p>What left is the last line:</p><pre><code data-origin="<pre><code>./run_experiments_bcnn_train.m:          imdb.images.set(imdb.images.set==3) = 2;
</code></pre>">./run_experiments_bcnn_train.m:          imdb.images.set(imdb.images.set==3) = 2;
</code></pre><p>which sets the test set to validation set!</p><p>Therefore, to leave out a test set, it is required to comment this line. In order to separate a validation set from training set, simply set <code>useVal</code> to <code>true</code> via params list in <code>model_setup</code>.</p><h4 id="4.-inspecting-the-code-of-building-up-a-b-cnn-model."><a name="4.-inspecting-the-code-of-building-up-a-b-cnn-model." href="#4.-inspecting-the-code-of-building-up-a-b-cnn-model."></a>4. Inspecting the code of building up a B-CNN model.</h4><p>The code of building up the actual <code>B-CNN</code> model lies in file <code>initializeNetworkSharedWeights.m</code> or <code>initializeNetworkTwoStreams.m</code>. Have a look into <code>initializeNetworkSharedWeights.m</code>:</p><pre class="matlab hljs"><code class="matlab" data-origin="<pre><code class=&quot;matlab&quot;>% /path/to/bcnn/initializeNetworkSharedWeights.m

% ...

% Load the model
net = load(encoderOpts.modela);
net.meta.normalization.keepAspect = opts.keepAspect;

% truncate the network
maxLayer = max(encoderOpts.layera, encoderOpts.layerb);
net.layers = net.layers(1:maxLayer);

% ...

% stack bilinearpool layer
if(encoderOpts.layera==encoderOpts.layerb)
    net.layers{end+1} = struct('type', 'bilinearpool', 'name', 'blp');
else
    net.layers{end+1} = struct('type', 'bilinearclpool', 'layer1', encoderOpts.layera, 'layer2', encoderOpts.layerb, 'name', 'blcp');
end

% stack normalization
net.layers{end+1} = struct('type', 'sqrt', 'name', 'sqrt_norm');
net.layers{end+1} = struct('type', 'l2norm', 'name', 'l2_norm');

 net.layers{end+1} = struct('type', 'relu', 'name', 'relu_wbcnn');

% build a linear classifier netc
initialW = 0.001/scal * randn(1,1,mapSize1*mapSize2,numClass,'single');
initialBias = init_bias.*ones(1, numClass, 'single');
netc.layers = {};
netc.layers{end+1} = struct('type', 'conv', 'name', 'classifier', ...
    'weights', {{initialW, initialBias}}, ...
    'stride', 1, ...
    'pad', 0, ...
    'learningRate', [1000 1000], ...
    'weightDecay', [0 0]) ;
netc.layers{end+1} = struct('type', 'softmaxloss', 'name', 'loss') ;
netc = vl_simplenn_tidy(netc) ;

% ...
</code></pre>"><span class="hljs-comment">% /path/to/bcnn/initializeNetworkSharedWeights.m</span>

<span class="hljs-comment">% ...</span>

<span class="hljs-comment">% Load the model</span>
net = load(encoderOpts.modela);
net.meta.normalization.keepAspect = opts.keepAspect;

<span class="hljs-comment">% truncate the network</span>
maxLayer = max(encoderOpts.layera, encoderOpts.layerb);
net.layers = net.layers(<span class="hljs-number">1</span>:maxLayer);

<span class="hljs-comment">% ...</span>

<span class="hljs-comment">% stack bilinearpool layer</span>
<span class="hljs-keyword">if</span>(encoderOpts.layera==encoderOpts.layerb)
    net.layers<span class="hljs-cell">{end+<span class="hljs-number">1</span>}</span> = struct(<span class="hljs-string">'type'</span>, <span class="hljs-string">'bilinearpool'</span>, <span class="hljs-string">'name'</span>, <span class="hljs-string">'blp'</span>);
<span class="hljs-keyword">else</span>
    net.layers<span class="hljs-cell">{end+<span class="hljs-number">1</span>}</span> = struct(<span class="hljs-string">'type'</span>, <span class="hljs-string">'bilinearclpool'</span>, <span class="hljs-string">'layer1'</span>, encoderOpts.layera, <span class="hljs-string">'layer2'</span>, encoderOpts.layerb, <span class="hljs-string">'name'</span>, <span class="hljs-string">'blcp'</span>);
<span class="hljs-keyword">end</span>

<span class="hljs-comment">% stack normalization</span>
net.layers<span class="hljs-cell">{end+<span class="hljs-number">1</span>}</span> = struct(<span class="hljs-string">'type'</span>, <span class="hljs-string">'sqrt'</span>, <span class="hljs-string">'name'</span>, <span class="hljs-string">'sqrt_norm'</span>);
net.layers<span class="hljs-cell">{end+<span class="hljs-number">1</span>}</span> = struct(<span class="hljs-string">'type'</span>, <span class="hljs-string">'l2norm'</span>, <span class="hljs-string">'name'</span>, <span class="hljs-string">'l2_norm'</span>);

 net.layers<span class="hljs-cell">{end+<span class="hljs-number">1</span>}</span> = struct(<span class="hljs-string">'type'</span>, <span class="hljs-string">'relu'</span>, <span class="hljs-string">'name'</span>, <span class="hljs-string">'relu_wbcnn'</span>);

<span class="hljs-comment">% build a linear classifier netc</span>
initialW = <span class="hljs-number">0.001</span>/scal * <span class="hljs-built_in">randn</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,mapSize1*mapSize2,numClass,<span class="hljs-string">'single'</span>);
initialBias = init_bias.*<span class="hljs-built_in">ones</span>(<span class="hljs-number">1</span>, numClass, <span class="hljs-string">'single'</span>);
netc.layers = <span class="hljs-cell">{}</span>;
netc.layers<span class="hljs-cell">{end+<span class="hljs-number">1</span>}</span> = struct(<span class="hljs-string">'type'</span>, <span class="hljs-string">'conv'</span>, <span class="hljs-string">'name'</span>, <span class="hljs-string">'classifier'</span>, ...
    <span class="hljs-string">'weights'</span>, <span class="hljs-cell">{{initialW, initialBias}</span>}, ...
    <span class="hljs-string">'stride'</span>, <span class="hljs-number">1</span>, ...
    <span class="hljs-string">'pad'</span>, <span class="hljs-number">0</span>, ...
    <span class="hljs-string">'learningRate'</span>, <span class="hljs-matrix">[<span class="hljs-number">1000</span> <span class="hljs-number">1000</span>]</span>, ...
    <span class="hljs-string">'weightDecay'</span>, <span class="hljs-matrix">[<span class="hljs-number">0</span> <span class="hljs-number">0</span>]</span>) ;
netc.layers<span class="hljs-cell">{end+<span class="hljs-number">1</span>}</span> = struct(<span class="hljs-string">'type'</span>, <span class="hljs-string">'softmaxloss'</span>, <span class="hljs-string">'name'</span>, <span class="hljs-string">'loss'</span>) ;
netc = vl_simplenn_tidy(netc) ;

<span class="hljs-comment">% ...</span>
</code></pre><p>In this code block, the pretrained CNN is loaded from path <code>encoderOpts.modela</code> and truncated at layer <code>encoderOpts.layera</code>. Then a <code>bilinearpool</code> layer followed by a <code>sqrt</code> normalization and <code>l2norm</code> normalization layers are stacked upon the truncated CNN building up a <code>Bilinear feature</code> extractor <code>net</code>. </p><p>A linear classifier <code>netc</code> is also created for classification. The classifier consists in a full-connected layer of size <code>[mapSize1*mapSize2, numClass]</code> followed by a <code>softmaxloss</code> layer, building up a <code>softmax</code> classifier.</p><p>The training step 1 is to train this classifier <code>netc</code>. Once the training completes, <code>netc</code> will be stacked upon <code>net</code> to build up a complete <code>B-CNN</code> model available for traning step 2.</p><h4 id="5.-analysizing-the-code-of-training-step-1."><a name="5.-analysizing-the-code-of-training-step-1." href="#5.-analysizing-the-code-of-training-step-1."></a>5. Analysizing the code of training step 1.</h4><p>The traning step 1 is performed by <code>initializeNetworkSharedWeights.m</code>.</p><pre class="matlab hljs"><code class="matlab" data-origin="<pre><code class=&quot;matlab&quot;>% initializeNetworkSharedWeights.m

    ...

    % get bcnn feature for train and val sets
    train = find(imdb.images.set==1|imdb.images.set==2);

        ...

        % compute and cache the bilinear cnn features
        for t=1:batchSize:numel(train)

            ...

            batch = train(t:min(numel(train), t+batchSize-1));
            [im, labels] = getBatchFn(imdb, batch) ;

            netInit = net;

            ...

            net.layers{end}.class = labels ;

            res = [] ;
            res = vl_bilinearnn(netInit, im, [], res, ...
                'accumulate', false, ...
                'mode', 'test', ...
                'conserveMemory', true, ...
                'sync', true, ...
                'cudnn', opts.cudnn) ;
            codeb = squeeze(gather(res(end).x));
            for i=1:numel(batch)
                code = codeb(:,i);
                savefast(fullfile(opts.nonftbcnnDir, ['bcnn_nonft_', num2str(batch(i), '%05d')]), 'code');
            end
        end
    end

   ...

        bcnndb = imdb;
        tempStr = sprintf('%05d\t', train);
        tempStr = textscan(tempStr, '%s', 'delimiter', '\t');
        bcnndb.images.name = strcat('bcnn_nonft_', tempStr{1}');
        bcnndb.images.id = bcnndb.images.id(train);
        bcnndb.images.label = bcnndb.images.label(train);
        bcnndb.images.set = bcnndb.images.set(train);
        bcnndb.imageDir = opts.nonftbcnnDir;

        %train logistic regression
        [netc, info] = cnn_train(netc, bcnndb, @getBatch_bcnn_fromdisk, opts.inittrain, ...
            'conserveMemory', true);

    end

   ...
</code></pre>"><span class="hljs-comment">% initializeNetworkSharedWeights.m</span>

    ...

    <span class="hljs-comment">% get bcnn feature for train and val sets</span>
    train = <span class="hljs-built_in">find</span>(imdb.images.set==<span class="hljs-number">1</span>|imdb.images.set==<span class="hljs-number">2</span>);

        ...

        <span class="hljs-comment">% compute and cache the bilinear cnn features</span>
        <span class="hljs-keyword">for</span> t=<span class="hljs-number">1</span>:batchSize:<span class="hljs-built_in">numel</span>(train)

            ...

            batch = train(t:min(<span class="hljs-built_in">numel</span>(train), t+batchSize-<span class="hljs-number">1</span>));
            <span class="hljs-matrix">[im, labels]</span> = getBatchFn(imdb, batch) ;

            netInit = net;

            ...

            net.layers<span class="hljs-cell">{end}</span>.class = labels ;

            res = <span class="hljs-matrix">[]</span> ;
            res = vl_bilinearnn(netInit, im, <span class="hljs-matrix">[]</span>, res, ...
                <span class="hljs-string">'accumulate'</span>, false, ...
                <span class="hljs-string">'mode'</span>, <span class="hljs-string">'test'</span>, ...
                <span class="hljs-string">'conserveMemory'</span>, true, ...
                <span class="hljs-string">'sync'</span>, true, ...
                <span class="hljs-string">'cudnn'</span>, opts.cudnn) ;
            codeb = <span class="hljs-built_in">squeeze</span>(gather(res(<span class="hljs-keyword">end</span>).x));
            <span class="hljs-keyword">for</span> <span class="hljs-built_in">i</span>=<span class="hljs-number">1</span>:<span class="hljs-built_in">numel</span>(batch)
                code = codeb(:,<span class="hljs-built_in">i</span>);
                savefast(fullfile(opts.nonftbcnnDir, <span class="hljs-matrix">[<span class="hljs-string">'bcnn_nonft_'</span>, num2str(batch(i), <span class="hljs-string">'%05d'</span>)]</span>), <span class="hljs-string">'code'</span>);
            <span class="hljs-keyword">end</span>
        <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span>

   ...

        bcnndb = imdb;
        tempStr = sprintf(<span class="hljs-string">'%05d\t'</span>, train);
        tempStr = textscan(tempStr, <span class="hljs-string">'%s'</span>, <span class="hljs-string">'delimiter'</span>, <span class="hljs-string">'\t'</span>);
        bcnndb.images.name = strcat(<span class="hljs-string">'bcnn_nonft_'</span>, tempStr<span class="hljs-cell">{<span class="hljs-number">1</span>}</span><span class="hljs-operator">'</span>);
        bcnndb.images.id = bcnndb.images.id(train);
        bcnndb.images.label = bcnndb.images.label(train);
        bcnndb.images.set = bcnndb.images.set(train);
        bcnndb.imageDir = opts.nonftbcnnDir;

        <span class="hljs-comment">%train logistic regression</span>
        <span class="hljs-matrix">[netc, info]</span> = cnn_train(netc, bcnndb, @getBatch_bcnn_fromdisk, opts.inittrain, ...
            <span class="hljs-string">'conserveMemory'</span>, true);

    <span class="hljs-keyword">end</span>

   ...
</code></pre><p>For each image in training and validation set, this code block extracts the bilinear feature from it using network <code>net</code>. Given a batch of images, the <code>vl_bilinearnn</code> here extracts a bilinear feature for each of the images repectively and saves to disk.</p><p>The dataset <code>bcnndb</code> used for training network <code>netc</code> is then built up from these bilinear features. The training is performed by function <code>cnn_train</code>.</p><h4 id="6.-the-code-of-training-step-2."><a name="6.-the-code-of-training-step-2." href="#6.-the-code-of-training-step-2."></a>6. The code of training step 2.</h4><p>Training step 2 is performed by <code>bcnn_train_simplenn</code> or <code>bcnn_train_dag</code> as indicated by the following code block:</p><pre class="matlab hljs"><code class="matlab" data-origin="<pre><code class=&quot;matlab&quot;>% /path/to/bcnn/imdb_bcnn_train_dag.m

...

if simplenn
    fn_train = getBatchSimpleNNWrapper(train_bopts) ;
    fn_val = getBatchSimpleNNWrapper(val_bopts) ;
    [net,info] = bcnn_train_simplenn(net, imdb, fn_train, fn_val, opts.train, 'conserveMemory', true) ;
    net = net_deploy(net) ;
    saveNetwork(fullfile(opts.expDir, 'fine-tuned-model', 'final-model.mat'), net, info);
else
    fn_train = getBatchDagNNWrapper(train_bopts, useGpu) ;
    fn_val = getBatchDagNNWrapper(val_bopts, useGpu) ;
    opts.train = rmfield(opts.train, {'sync', 'cudnn'}) ;
    [net, info] = bcnn_train_dag(net, imdb, fn_train, fn_val, opts.train) ;
    net = net_deploy(net) ;
    save(fullfile(opts.expDir, 'fine-tuned-model', 'final-model.mat'), 'net', 'info', '-v7.3');
end

...
</code></pre>"><span class="hljs-comment">% /path/to/bcnn/imdb_bcnn_train_dag.m</span>

...

<span class="hljs-keyword">if</span> simplenn
    fn_train = getBatchSimpleNNWrapper(train_bopts) ;
    fn_val = getBatchSimpleNNWrapper(val_bopts) ;
    <span class="hljs-matrix">[net,info]</span> = bcnn_train_simplenn(net, imdb, fn_train, fn_val, opts.train, <span class="hljs-string">'conserveMemory'</span>, true) ;
    net = net_deploy(net) ;
    saveNetwork(fullfile(opts.expDir, <span class="hljs-string">'fine-tuned-model'</span>, <span class="hljs-string">'final-model.mat'</span>), net, info);
<span class="hljs-keyword">else</span>
    fn_train = getBatchDagNNWrapper(train_bopts, useGpu) ;
    fn_val = getBatchDagNNWrapper(val_bopts, useGpu) ;
    opts.train = rmfield(opts.train, <span class="hljs-cell">{<span class="hljs-string">'sync'</span>, <span class="hljs-string">'cudnn'</span>}</span>) ;
    <span class="hljs-matrix">[net, info]</span> = bcnn_train_dag(net, imdb, fn_train, fn_val, opts.train) ;
    net = net_deploy(net) ;
    save(fullfile(opts.expDir, <span class="hljs-string">'fine-tuned-model'</span>, <span class="hljs-string">'final-model.mat'</span>), <span class="hljs-string">'net'</span>, <span class="hljs-string">'info'</span>, <span class="hljs-string">'-v7.3'</span>);
<span class="hljs-keyword">end</span>

...
</code></pre><p>The function <code>bcnn_train_simplenn</code> is modified from <code>cnn_train</code> of <strong>MatConvNet</strong>, which implementes the SGD algorithm for training a simple network.</p><p>The function <code>bcnn_train_dag</code> is modified from <code>cnn_train_dag</code> of <strong>MatConvNet</strong>, which implementes the SGD algorithm for training a complex network.</p><h4 id="7.-additional-training-step."><a name="7.-additional-training-step." href="#7.-additional-training-step."></a>7. Additional training step.</h4><p>Once training step 2 is done, the fine-tuning is said to be done. However, there should be one additional training step to train the whole network combining the training and validation dataset.<br>In this step, authors of the paper chop off the softmax classifier, i.e., <code>netc</code> in <code>initializeNetworkSharedWeights</code>, and replace it with a set of linear SVMs, which should call for one more traning step.</p><p>After the additional training step, the test set had been left out is used for evaluating the accuracy of the final model.</p><p>Note that training SVMs in this additional step consumes more than 32GB main memory of CPU.</p><h4 id="8.-miscellaneous"><a name="8.-miscellaneous" href="#8.-miscellaneous"></a>8. Miscellaneous</h4><ul>
<li><p><code>vl_bilinearnn</code> is modified from <code>vl_simplenn</code> of <strong>MatConvNet</strong> and implements both the forward pass and backward pass of a network.</p>
</li><li><p><code>imdb_get_batch</code> is used for fetching a batch of examples along with labels from dataset <code>*.imdb</code>. The output batch is ready to be passed to <code>vl_bilinearnn</code> for training or validation.</p>
</li><li><p><code>run_experiments</code> is used for training SVMs after training step 2.</p>
</li></ul><h2 id="附录-5-修改-b-cnn，尝试改进"><a name="附录-5-修改-b-cnn，尝试改进" href="#附录-5-修改-b-cnn，尝试改进"></a>附录-5 修改 B-CNN，尝试改进</h2><h4 id="5.1-motivation."><a name="5.1-motivation." href="#5.1-motivation."></a>5.1 Motivation.</h4><p>Given two feature extractors <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-798-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11247" style="width: 1.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.317em 1000em 2.59em -0.437em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-11248"><span class="msubsup" id="MathJax-Span-11249"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.883em -0.437em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11250" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2em; left: 0.541em;"><span class="mi" id="MathJax-Span-11251" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.287em; vertical-align: -0.36em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-798">f_A</script></span> and <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-799-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11252" style="width: 1.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.317em 1000em 2.598em -0.437em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-11253"><span class="msubsup" id="MathJax-Span-11254"><span style="display: inline-block; position: relative; width: 0.944em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.883em -0.437em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11255" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2em; left: 0.541em;"><span class="mi" id="MathJax-Span-11256" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.296em; vertical-align: -0.369em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-799">f_b</script></span>, denote their output features as two matrices <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-800-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11257" style="width: 1.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.311em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.339em 1000em 2.507em -0.466em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-11258"><span class="msubsup" id="MathJax-Span-11259"><span style="display: inline-block; position: relative; width: 1.308em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11260" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11261" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.158em; vertical-align: -0.258em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-800">X_a</script></span> and <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-801-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11262" style="width: 1.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.339em 1000em 2.508em -0.466em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-11263"><span class="msubsup" id="MathJax-Span-11264"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11265" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11266" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.159em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-801">X_b</script></span> respectively (they must have the same number of rows), where each column of them is a reshaped feature map. The B-CNN model proposed by Tsung-Yu Lin simply takes their matrix product <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-802-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11267" style="width: 3.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.787em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.133em 1000em 2.604em -0.466em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-11268"><span class="msubsup" id="MathJax-Span-11269"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11270" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.598em 1000em 2.404em -0.477em); top: -2.65em; left: 0.932em;"><span class="mi" id="MathJax-Span-11271" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.765em 1000em 2.411em -0.468em); top: -1.993em; left: 0.85em;"><span class="mi" id="MathJax-Span-11272" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-11273"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11274" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11275" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.528em; vertical-align: -0.377em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-802">X_a^T X_b</script></span> as the bilinear-pooled form. We observe that it can also be written as <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-803-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11276" style="width: 4.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.279em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.461em 1000em 2.932em -0.466em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-11277"><span class="msubsup" id="MathJax-Span-11278"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11279" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.598em 1000em 2.404em -0.477em); top: -2.65em; left: 0.932em;"><span class="mi" id="MathJax-Span-11280" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.765em 1000em 2.411em -0.468em); top: -1.993em; left: 0.85em;"><span class="mi" id="MathJax-Span-11281" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-11282" style="font-family: MathJax_Math; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="msubsup" id="MathJax-Span-11283"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11284" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11285" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.528em; vertical-align: -0.377em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-803">X_a^T I X_b</script></span>, where <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-804-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11286" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-11287"><span class="mi" id="MathJax-Span-11288" style="font-family: MathJax_Math; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-804">I</script></span> is an <em>identity matrix</em>, which brings up the question: does <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-805-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11289" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-11290"><span class="mi" id="MathJax-Span-11291" style="font-family: MathJax_Math; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-805">I</script></span> is the optimal matrix? Holding the view that <em>identity matrix</em> is general to any matrix, i.e., contains no particular information and changes nothing, we would like to ask, can we train some matrices that contain some particular information for a specific dataset? It seems convincing that the identity matrix should not be the optimal and there should be some matrices that bring information about a given dataset to be optimal.</p><p>Holding this belief, we replace the identity matrix with a weight matrix and let the training algorithm learn a specific matrix for a given dataset.</p><h4 id="5.2-revised-bilinear-model."><a name="5.2-revised-bilinear-model." href="#5.2-revised-bilinear-model."></a>5.2 Revised bilinear model.</h4><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-806-Frame"><nobr><span class="math" id="MathJax-Span-11292" style="width: 7.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.175em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.68em 1000em 3.15em -0.462em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11293"><span class="mi" id="MathJax-Span-11294" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-11295" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-11296" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11297" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.598em 1000em 2.404em -0.477em); top: -2.65em; left: 0.932em;"><span class="mi" id="MathJax-Span-11298" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.765em 1000em 2.411em -0.468em); top: -1.993em; left: 0.85em;"><span class="mi" id="MathJax-Span-11299" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-11300" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span class="msubsup" id="MathJax-Span-11301"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11302" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11303" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11304" style="font-family: MathJax_Main;">,</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.528em; vertical-align: -0.377em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-806">Y = X_a^TWX_b,</script><p></p><p>where</p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-807-Frame"><nobr><span class="math" id="MathJax-Span-11305" style="width: 32.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 26.557em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.657em 1000em 3.09em -0.466em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11306"><span class="msubsup" id="MathJax-Span-11307"><span style="display: inline-block; position: relative; width: 1.308em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11308" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11309" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11310" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="msubsup" id="MathJax-Span-11311" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 3.682em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.699em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11312" style="font-family: MathJax_Math; font-style: italic;">R</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.708em; left: 0.765em;"><span class="texatom" id="MathJax-Span-11313"><span class="mrow" id="MathJax-Span-11314"><span class="msubsup" id="MathJax-Span-11315"><span style="display: inline-block; position: relative; width: 0.796em; height: 0px;"><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.468em); top: -2.24em; left: 0em;"><span class="mi" id="MathJax-Span-11316" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; top: -2.08em; left: 0.469em;"><span class="mi" id="MathJax-Span-11317" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span><span class="mo" id="MathJax-Span-11318" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-11319" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="msubsup" id="MathJax-Span-11320"><span style="display: inline-block; position: relative; width: 0.942em; height: 0px;"><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.47em); top: -2.24em; left: 0em;"><span class="mi" id="MathJax-Span-11321" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; top: -2.08em; left: 0.615em;"><span class="mi" id="MathJax-Span-11322" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-11323" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-11324" style="font-family: MathJax_Main; padding-left: 0.167em;">&nbsp;</span><span class="mtext" id="MathJax-Span-11325" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-11326"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11327" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11328" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11329" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="msubsup" id="MathJax-Span-11330" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 3.572em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.699em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11331" style="font-family: MathJax_Math; font-style: italic;">R</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.708em; left: 0.765em;"><span class="texatom" id="MathJax-Span-11332"><span class="mrow" id="MathJax-Span-11333"><span class="msubsup" id="MathJax-Span-11334"><span style="display: inline-block; position: relative; width: 0.741em; height: 0px;"><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.468em); top: -2.24em; left: 0em;"><span class="mi" id="MathJax-Span-11335" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; top: -2.08em; left: 0.469em;"><span class="mi" id="MathJax-Span-11336" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span><span class="mo" id="MathJax-Span-11337" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-11338" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="msubsup" id="MathJax-Span-11339"><span style="display: inline-block; position: relative; width: 0.887em; height: 0px;"><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.47em); top: -2.24em; left: 0em;"><span class="mi" id="MathJax-Span-11340" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; top: -2.08em; left: 0.615em;"><span class="mi" id="MathJax-Span-11341" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-11342" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-11343" style="font-family: MathJax_Main; padding-left: 0.167em;">&nbsp;</span><span class="mtext" id="MathJax-Span-11344" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-11345" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span class="mo" id="MathJax-Span-11346" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="msubsup" id="MathJax-Span-11347" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 2.971em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.699em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11348" style="font-family: MathJax_Math; font-style: italic;">R</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.708em; left: 0.765em;"><span class="texatom" id="MathJax-Span-11349"><span class="mrow" id="MathJax-Span-11350"><span class="msubsup" id="MathJax-Span-11351"><span style="display: inline-block; position: relative; width: 0.796em; height: 0px;"><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.468em); top: -2.24em; left: 0em;"><span class="mi" id="MathJax-Span-11352" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; top: -2.08em; left: 0.469em;"><span class="mi" id="MathJax-Span-11353" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span><span class="mo" id="MathJax-Span-11354" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="msubsup" id="MathJax-Span-11355"><span style="display: inline-block; position: relative; width: 0.741em; height: 0px;"><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.468em); top: -2.24em; left: 0em;"><span class="mi" id="MathJax-Span-11356" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; top: -2.08em; left: 0.469em;"><span class="mi" id="MathJax-Span-11357" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-11358" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-11359" style="font-family: MathJax_Main; padding-left: 0.167em;">&nbsp;</span><span class="mtext" id="MathJax-Span-11360" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-11361" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-11362" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="msubsup" id="MathJax-Span-11363" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 4.283em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.699em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11364" style="font-family: MathJax_Math; font-style: italic;">R</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.708em; left: 0.765em;"><span class="texatom" id="MathJax-Span-11365"><span class="mrow" id="MathJax-Span-11366"><span class="mi" id="MathJax-Span-11367" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="msubsup" id="MathJax-Span-11368"><span style="display: inline-block; position: relative; width: 0.942em; height: 0px;"><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.47em); top: -2.24em; left: 0em;"><span class="mi" id="MathJax-Span-11369" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; top: -2.08em; left: 0.615em;"><span class="mi" id="MathJax-Span-11370" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span><span class="mo" id="MathJax-Span-11371" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-11372" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="msubsup" id="MathJax-Span-11373"><span style="display: inline-block; position: relative; width: 0.887em; height: 0px;"><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.47em); top: -2.24em; left: 0em;"><span class="mi" id="MathJax-Span-11374" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; top: -2.08em; left: 0.615em;"><span class="mi" id="MathJax-Span-11375" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.482em; vertical-align: -0.303em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-807">X_a \in R^{P_a\times CH_a},~~X_b \in R^{P_b\times CH_b}, ~~W\in R^{P_a\times P_b}, ~~Y\in R^{CH_a\times CH_b}</script><p></p><p>The gradients w.r.t <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-808-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11376" style="width: 1.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.311em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.339em 1000em 2.507em -0.466em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-11377"><span class="msubsup" id="MathJax-Span-11378"><span style="display: inline-block; position: relative; width: 1.308em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11379" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11380" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.158em; vertical-align: -0.258em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-808">X_a</script></span>, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-809-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11381" style="width: 1.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.339em 1000em 2.508em -0.466em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-11382"><span class="msubsup" id="MathJax-Span-11383"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11384" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11385" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.159em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-809">X_b</script></span>, and <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-810-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11386" style="width: 1.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.093em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.7em -0.441em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-11387"><span class="mi" id="MathJax-Span-11388" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-810">W</script></span> are</p><ul>
<li><span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-811-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11389" style="width: 12.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.613em 1000em 3.157em -0.446em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11390"><span class="msubsup" id="MathJax-Span-11391"><span style="display: inline-block; position: relative; width: 1.86em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-11392" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.874em;"><span class="texatom" id="MathJax-Span-11393"><span class="mrow" id="MathJax-Span-11394"><span class="msubsup" id="MathJax-Span-11395"><span style="display: inline-block; position: relative; width: 0.91em; height: 0px;"><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.473em); top: -2.24em; left: 0em;"><span class="mi" id="MathJax-Span-11396" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; top: -2.08em; left: 0.584em;"><span class="mi" id="MathJax-Span-11397" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span></span><span class="mi" id="MathJax-Span-11398" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-11399" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-11400" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span class="msubsup" id="MathJax-Span-11401"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11402" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11403" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11404" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="mo" id="MathJax-Span-11405" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="msubsup" id="MathJax-Span-11406"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-11407" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-11408" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-11409" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="msubsup" id="MathJax-Span-11410"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-11411" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-11412" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.618em; vertical-align: -0.385em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-811">\nabla_{X_a}Z = WX_b\cdot(\nabla_YZ)^T</script></span>, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-812-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11413" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.568em 1000em 2.896em -0.492em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11414"><span class="mtext" id="MathJax-Span-11415" style="font-family: MathJax_Main;">&nbsp;</span><span class="mtext" id="MathJax-Span-11416" style="font-family: MathJax_Main;">&nbsp;</span><span class="mtext" id="MathJax-Span-11417" style="font-family: MathJax_Main;">&nbsp;</span><span class="mtext" id="MathJax-Span-11418" style="font-family: MathJax_Main;">&nbsp;</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.133em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-812">~~~~</script></span>(size: <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-813-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11419" style="width: 24.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.219em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.863em 1000em 3.054em -0.459em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11420"><span class="msubsup" id="MathJax-Span-11421"><span style="display: inline-block; position: relative; width: 1.114em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11422" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.656em;"><span class="mi" id="MathJax-Span-11423" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11424" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="msubsup" id="MathJax-Span-11425" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11426" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.656em;"><span class="mi" id="MathJax-Span-11427" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11428" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="msubsup" id="MathJax-Span-11429" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11430" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.656em;"><span class="mi" id="MathJax-Span-11431" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11432" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mi" id="MathJax-Span-11433" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="msubsup" id="MathJax-Span-11434"><span style="display: inline-block; position: relative; width: 1.275em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11435" style="font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.872em;"><span class="mi" id="MathJax-Span-11436" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11437" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="mi" id="MathJax-Span-11438" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="msubsup" id="MathJax-Span-11439"><span style="display: inline-block; position: relative; width: 1.275em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11440" style="font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.872em;"><span class="mi" id="MathJax-Span-11441" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11442" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mi" id="MathJax-Span-11443" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="msubsup" id="MathJax-Span-11444"><span style="display: inline-block; position: relative; width: 1.329em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11445" style="font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.872em;"><span class="mi" id="MathJax-Span-11446" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11447" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-11448" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.114em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11449" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.656em;"><span class="mi" id="MathJax-Span-11450" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11451" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mi" id="MathJax-Span-11452" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="msubsup" id="MathJax-Span-11453"><span style="display: inline-block; position: relative; width: 1.329em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11454" style="font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.872em;"><span class="mi" id="MathJax-Span-11455" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.186em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-813">P_a\times P_b \cdot P_b\times CH_b\cdot CH_b\times CH_a = P_a\times CH_a</script></span>)</li><li><span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-814-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11456" style="width: 13.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.656em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.68em 1000em 3.158em -0.446em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11457"><span class="msubsup" id="MathJax-Span-11458"><span style="display: inline-block; position: relative; width: 1.805em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-11459" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.874em;"><span class="texatom" id="MathJax-Span-11460"><span class="mrow" id="MathJax-Span-11461"><span class="msubsup" id="MathJax-Span-11462"><span style="display: inline-block; position: relative; width: 0.856em; height: 0px;"><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.473em); top: -2.24em; left: 0em;"><span class="mi" id="MathJax-Span-11463" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; top: -2.08em; left: 0.584em;"><span class="mi" id="MathJax-Span-11464" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span></span><span class="mi" id="MathJax-Span-11465" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-11466" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-11467" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.741em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.7em -0.441em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11468" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.65em; left: 1.174em;"><span class="mi" id="MathJax-Span-11469" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-11470"><span style="display: inline-block; position: relative; width: 1.308em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11471" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11472" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11473" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="mo" id="MathJax-Span-11474" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="msubsup" id="MathJax-Span-11475"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-11476" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-11477" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-11478" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-11479" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.537em; vertical-align: -0.386em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-814">\nabla_{X_b}Z = W^TX_a\cdot(\nabla_YZ)</script></span>,  <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-815-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11480" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.568em 1000em 2.896em -0.492em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11481"><span class="mtext" id="MathJax-Span-11482" style="font-family: MathJax_Main;">&nbsp;</span><span class="mtext" id="MathJax-Span-11483" style="font-family: MathJax_Main;">&nbsp;</span><span class="mtext" id="MathJax-Span-11484" style="font-family: MathJax_Main;">&nbsp;</span><span class="mtext" id="MathJax-Span-11485" style="font-family: MathJax_Main;">&nbsp;</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.133em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-815">~~~~</script></span>(size: <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-816-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11486" style="width: 24.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.219em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.863em 1000em 3.054em -0.459em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11487"><span class="msubsup" id="MathJax-Span-11488"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11489" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.656em;"><span class="mi" id="MathJax-Span-11490" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11491" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="msubsup" id="MathJax-Span-11492" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.114em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11493" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.656em;"><span class="mi" id="MathJax-Span-11494" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11495" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="msubsup" id="MathJax-Span-11496" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.114em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11497" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.656em;"><span class="mi" id="MathJax-Span-11498" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11499" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mi" id="MathJax-Span-11500" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="msubsup" id="MathJax-Span-11501"><span style="display: inline-block; position: relative; width: 1.329em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11502" style="font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.872em;"><span class="mi" id="MathJax-Span-11503" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11504" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="mi" id="MathJax-Span-11505" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="msubsup" id="MathJax-Span-11506"><span style="display: inline-block; position: relative; width: 1.329em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11507" style="font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.872em;"><span class="mi" id="MathJax-Span-11508" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11509" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mi" id="MathJax-Span-11510" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="msubsup" id="MathJax-Span-11511"><span style="display: inline-block; position: relative; width: 1.275em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11512" style="font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.872em;"><span class="mi" id="MathJax-Span-11513" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11514" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-11515" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11516" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.656em;"><span class="mi" id="MathJax-Span-11517" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11518" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mi" id="MathJax-Span-11519" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="msubsup" id="MathJax-Span-11520"><span style="display: inline-block; position: relative; width: 1.275em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11521" style="font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.872em;"><span class="mi" id="MathJax-Span-11522" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.186em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-816">P_b\times P_a \cdot P_a\times CH_a\cdot CH_a\times CH_b = P_b\times CH_b</script></span>)</li><li><span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-817-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11523" style="width: 13.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.038em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.68em 1000em 3.165em -0.446em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11524"><span class="msubsup" id="MathJax-Span-11525"><span style="display: inline-block; position: relative; width: 1.714em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-11526" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="texatom" id="MathJax-Span-11527"><span class="mrow" id="MathJax-Span-11528"><span class="mi" id="MathJax-Span-11529" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.074em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-11530" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-11531" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-11532" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.308em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11533" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11534" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11535" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="mo" id="MathJax-Span-11536" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="msubsup" id="MathJax-Span-11537"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-11538" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-11539" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-11540" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-11541" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-11542" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="msubsup" id="MathJax-Span-11543" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11544" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.598em 1000em 2.404em -0.477em); top: -2.65em; left: 0.932em;"><span class="mi" id="MathJax-Span-11545" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.586em 1000em 2.412em -0.464em); top: -1.98em; left: 0.85em;"><span class="mi" id="MathJax-Span-11546" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.545em; vertical-align: -0.394em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-817">\nabla_{W}Z = X_a\cdot(\nabla_YZ)\cdot X_b^T</script></span>.  <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-818-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11547" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.568em 1000em 2.896em -0.492em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11548"><span class="mtext" id="MathJax-Span-11549" style="font-family: MathJax_Main;">&nbsp;</span><span class="mtext" id="MathJax-Span-11550" style="font-family: MathJax_Main;">&nbsp;</span><span class="mtext" id="MathJax-Span-11551" style="font-family: MathJax_Main;">&nbsp;</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.133em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-818">~~~</script></span>(size: <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-819-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11552" style="width: 24.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.219em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.863em 1000em 3.054em -0.459em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11553"><span class="msubsup" id="MathJax-Span-11554"><span style="display: inline-block; position: relative; width: 1.114em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11555" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.656em;"><span class="mi" id="MathJax-Span-11556" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11557" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mi" id="MathJax-Span-11558" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="msubsup" id="MathJax-Span-11559"><span style="display: inline-block; position: relative; width: 1.329em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11560" style="font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.872em;"><span class="mi" id="MathJax-Span-11561" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11562" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="mi" id="MathJax-Span-11563" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="msubsup" id="MathJax-Span-11564"><span style="display: inline-block; position: relative; width: 1.329em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11565" style="font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.872em;"><span class="mi" id="MathJax-Span-11566" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11567" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mi" id="MathJax-Span-11568" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="msubsup" id="MathJax-Span-11569"><span style="display: inline-block; position: relative; width: 1.275em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11570" style="font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.872em;"><span class="mi" id="MathJax-Span-11571" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11572" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="mi" id="MathJax-Span-11573" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="msubsup" id="MathJax-Span-11574"><span style="display: inline-block; position: relative; width: 1.275em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11575" style="font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.872em;"><span class="mi" id="MathJax-Span-11576" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11577" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="msubsup" id="MathJax-Span-11578" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11579" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.656em;"><span class="mi" id="MathJax-Span-11580" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11581" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-11582" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.114em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11583" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.656em;"><span class="mi" id="MathJax-Span-11584" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11585" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="msubsup" id="MathJax-Span-11586" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11587" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.656em;"><span class="mi" id="MathJax-Span-11588" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.186em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-819">P_a\times CH_a \cdot CH_a\times CH_b\cdot CH_b\times P_b = P_a\times P_b</script></span>)</li></ul><p>Note that when <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-820-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11589" style="width: 1.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.311em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.339em 1000em 2.507em -0.466em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-11590"><span class="msubsup" id="MathJax-Span-11591"><span style="display: inline-block; position: relative; width: 1.308em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11592" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11593" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.158em; vertical-align: -0.258em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-820">X_a</script></span> equals <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-821-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11594" style="width: 1.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.339em 1000em 2.508em -0.466em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-11595"><span class="msubsup" id="MathJax-Span-11596"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11597" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11598" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.159em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-821">X_b</script></span>, i.e. <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-822-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11599" style="width: 7.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.066em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.885em 1000em 3.054em -0.466em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11600"><span class="msubsup" id="MathJax-Span-11601"><span style="display: inline-block; position: relative; width: 1.308em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11602" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11603" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11604" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-11605" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11606" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11607" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11608" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-11609" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.159em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-822">X_a = X_b = X</script></span>,</p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-823-Frame"><nobr><span class="math" id="MathJax-Span-11610" style="width: 21.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.432em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.613em 1000em 3.146em -0.446em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11611"><span class="msubsup" id="MathJax-Span-11612"><span style="display: inline-block; position: relative; width: 1.55em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-11613" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="texatom" id="MathJax-Span-11614"><span class="mrow" id="MathJax-Span-11615"><span class="mi" id="MathJax-Span-11616" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-11617" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-11618" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-11619" style="font-family: MathJax_Main; padding-left: 0.278em;">2</span><span class="msubsup" id="MathJax-Span-11620"><span style="display: inline-block; position: relative; width: 1.55em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-11621" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="texatom" id="MathJax-Span-11622"><span class="mrow" id="MathJax-Span-11623"><span class="mi" id="MathJax-Span-11624" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-11625" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-11626" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="msubsup" id="MathJax-Span-11627" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-11628" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-11629" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-11630" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-11631" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-11632" style="font-family: MathJax_Main; padding-left: 0.278em;">2</span><span class="mi" id="MathJax-Span-11633" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span class="mi" id="MathJax-Span-11634" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-11635" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="mo" id="MathJax-Span-11636" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="msubsup" id="MathJax-Span-11637"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-11638" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-11639" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-11640" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="msubsup" id="MathJax-Span-11641"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-11642" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-11643" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.604em; vertical-align: -0.372em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-823">\nabla_{X}Z = 2\nabla_{X}Y\cdot\nabla_YZ = 2WX\cdot(\nabla_YZ)^T</script><p></p><h4 id="5.3-application"><a name="5.3-application" href="#5.3-application"></a>5.3 Application</h4><p>Considering two sets of feature maps output from some CNNs with sizes <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-824-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11644" style="width: 8.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.322em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.863em 1000em 3.053em -0.441em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11645"><span class="msubsup" id="MathJax-Span-11646"><span style="display: inline-block; position: relative; width: 1.446em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.7em -0.441em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11647" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.989em;"><span class="mi" id="MathJax-Span-11648" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11649" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="msubsup" id="MathJax-Span-11650" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.329em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11651" style="font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.872em;"><span class="mi" id="MathJax-Span-11652" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11653" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mi" id="MathJax-Span-11654" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="msubsup" id="MathJax-Span-11655"><span style="display: inline-block; position: relative; width: 1.329em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11656" style="font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.872em;"><span class="mi" id="MathJax-Span-11657" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.185em; vertical-align: -0.258em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-824">W_a\times H_a\times CH_a</script></span> and <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-825-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11658" style="width: 8.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.158em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.863em 1000em 3.054em -0.441em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11659"><span class="msubsup" id="MathJax-Span-11660"><span style="display: inline-block; position: relative; width: 1.392em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.7em -0.441em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11661" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.989em;"><span class="mi" id="MathJax-Span-11662" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11663" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="msubsup" id="MathJax-Span-11664" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.275em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11665" style="font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.872em;"><span class="mi" id="MathJax-Span-11666" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11667" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mi" id="MathJax-Span-11668" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="msubsup" id="MathJax-Span-11669"><span style="display: inline-block; position: relative; width: 1.275em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11670" style="font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.872em;"><span class="mi" id="MathJax-Span-11671" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.186em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-825">W_b \times H_b\times CH_b</script></span> respectively. The model can be applied easily by reshaping them to <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-826-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11672" style="width: 9.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.814em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11673"><span class="mo" id="MathJax-Span-11674" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-11675"><span style="display: inline-block; position: relative; width: 1.446em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.7em -0.441em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11676" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.989em;"><span class="mi" id="MathJax-Span-11677" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11678" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="msubsup" id="MathJax-Span-11679" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.329em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11680" style="font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.872em;"><span class="mi" id="MathJax-Span-11681" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11682" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-11683" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mi" id="MathJax-Span-11684" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="msubsup" id="MathJax-Span-11685"><span style="display: inline-block; position: relative; width: 1.329em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11686" style="font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.872em;"><span class="mi" id="MathJax-Span-11687" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-826">(W_a*H_a)\times CH_a</script></span> and <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-827-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11688" style="width: 9.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.65em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11689"><span class="mo" id="MathJax-Span-11690" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-11691"><span style="display: inline-block; position: relative; width: 1.392em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.7em -0.441em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11692" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.989em;"><span class="mi" id="MathJax-Span-11693" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11694" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="msubsup" id="MathJax-Span-11695" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.275em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11696" style="font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.872em;"><span class="mi" id="MathJax-Span-11697" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11698" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-11699" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mi" id="MathJax-Span-11700" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="msubsup" id="MathJax-Span-11701"><span style="display: inline-block; position: relative; width: 1.275em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11702" style="font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.872em;"><span class="mi" id="MathJax-Span-11703" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-827">(W_b*H_b)\times CH_b</script></span>.</p><h4 id="5.4-add-a-self-defined-layer-`vl_weightedbilinearpool`-to-`matconvnet`"><a name="5.4-add-a-self-defined-layer-`vl_weightedbilinearpool`-to-`matconvnet`" href="#5.4-add-a-self-defined-layer-`vl_weightedbilinearpool`-to-`matconvnet`"></a>5.4 Add a self-defined layer <code>vl_weightedbilinearpool</code> to <code>matconvnet</code></h4><ol>
<li><p><strong>Define the layer <code>vl_weightedbilinearpool.m</code></strong></p>
<p> The first step to add a self-defined layer to <code>matconvnet</code> is to define a function implementing the layer’s functionalities of <em>feed forward</em> and <em>back propagation</em> with given inputs.</p>
<p> The following is what the <code>vl_weightedbilinearpool.m</code> may look like.</p>
<pre class="matlab hljs"><code class="matlab" data-origin="<pre><code class=&quot;matlab&quot;> % /path/to/bcnn/bcnn-package/vl_weightedbilinearpool.m

 function [y, varargout] = vl_weightedbilinearpool(x1, x2, W, varargin)
 % VL_WEIGHTEDBILINEARPOOL implementes the revised bilinear model with a weights matrix
 %
 % Copyright (C) 2016 Jincheng Su @ Hikvision.
 % All rights reserved.
 %
 % * **Feed forward**
 %   * Input: `x1` and `x2`, with shapes `[h1, w1, ch1, bs]` and `[h2, w2, ch2, bs]`.
 %            `W`, the weights
 %   * Output: `y`, with shape `[ch1*ch2, bs]`.
 %
 % * **Back propagation**
 %   * Input: `x1`, `x2` and `W` are the same as in forward pass, 
 %            dzdy = varargin{1}, is the derivative of loss `z` w.r.t `y`.
 %   * Output: y, the derivative of loss `z` w.r.t `x1`, i.e., dzdx1.
 %             varargout{1} = y2, the derivative of loss `z` w.r.t `x2`, i.e., dzdx2.
 %             varargout{2} = dw, the derivative of loss `z` w.r.t `W`, i.e., dzdW.
 %
 % -----------------------
 % The revised B-CNN model
 % -----------------------
 %
 %  $ Y = X_a^TWX_b,$
 %
 % where $I$ is an identity matrix and
 %     $X_a \in R^{P_a\times CH_a},~~X_b \in R^{P_b\times CH_b}, ~~W\in R^{P_a\times P_b}, ~~Y\in R^{CH_a\times CH_b}$
 %
 % The derivatives w.r.t $X_a$, $X_b$, and $W$ are
 % * $\nabla_{X_a}Z = WX_b\cdot(\nabla_YZ)^T$, $~~~~$(size: $P_a\times P_b \cdot P_b\times CH_b\cdot CH_b\times CH_a = P_a\times CH_a$)
 % * $\nabla_{X_b}Z = W^TX_a\cdot(\nabla_YZ)$,  $~~~~$(size: $P_b\times P_a \cdot P_a\times CH_a\cdot CH_a\times CH_b = P_b\times CH_b$)
 % * $\nabla_{W}Z = X_a\cdot(\nabla_YZ)\cdot X_b^T$.  $~~~$(size: $P_a\times CH_a \cdot CH_a\times CH_b\cdot CH_b\times P_b = P_a\times P_b$)
 %
 % -------------------------------------------------------------------------------------------------------

 % flag for doing backward pass
 isBackward = numel(varargin) &amp;gt; 0 &amp;amp;&amp;amp; ~isstr(varargin{1});
 if isBackward
     dzdy = varargin{1};
 end

 % if GPU is used
 gpuMode = isa(x1, 'gpuArray');

 % [height, widht, channels, batchsize]
 [h1, w1, ch1, bs] = size(x1);
 [h2, w2, ch2, ~ ] = size(x2);

 if ~isBackward
     % forward pass
     if gpuMode
         y = gpuArray(zeros([1, 1, ch1 * ch2, bs], 'single'));
     else
         y = zeros([1, 1, ch1 * ch2, bs], 'single');
     end

     for b = 1: bs
         Xa = reshape(x1(:,:,:,b), [h1 * w1, ch1]);
         Xb = reshape(x2(:,:,:,b), [h2 * w2, ch2]);

         y(1, 1, :, b) = reshape(Xa'*W*Xb, [1, ch1 * ch2]); %'
     end
 else
     % backward pass
     if gpuMode
         y1 = gpuArray(zeros(h1, w1, ch1, bs, 'single')); 
         y2 = gpuArray(zeros(h2, w2, ch2, bs, 'single')); 
         dw = gpuArray(zeros(h1*w1, h2*w2,'single')); 
     else
         y1 = (zeros(h1, w1, ch1, bs, 'single')); 
         y2 = (zeros(h2, w2, ch2, bs, 'single')); 
         dw = (zeros(h1*w1, h2*w2,'single')); 
     end

     for b = 1: bs
         dZdY = reshape(dzdy(1, 1, :, b), [ch1, ch2]);
         Xa = reshape(x1(:,:,:,b), [h1 * w1, ch1]);
         Xb = reshape(x2(:,:,:,b), [h2 * w2, ch2]);
         dZdXa = reshape(W*Xb*dZdY', [h1, w1, ch1]);
         dZdXb = reshape(W'*Xa*dZdY, [h2, w2, ch2]);
         dZdW = Xa*dZdY*Xb'; %'

         y1(:, :, ;, b) = dZdXa;
         y2(:, :, :, b) = dZdXb;
         dw = dw + dZdW;
     end
     y = y1;
     varargout{1} = y2;
     varargout{2} = dw / bs;
 end
</code></pre>"> <span class="hljs-comment">% /path/to/bcnn/bcnn-package/vl_weightedbilinearpool.m</span>

 <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">[y, varargout]</span> = <span class="hljs-title">vl_weightedbilinearpool</span><span class="hljs-params">(x1, x2, W, varargin)</span></span>
 <span class="hljs-comment">% VL_WEIGHTEDBILINEARPOOL implementes the revised bilinear model with a weights matrix</span>
 <span class="hljs-comment">%</span>
 <span class="hljs-comment">% Copyright (C) 2016 Jincheng Su @ Hikvision.</span>
 <span class="hljs-comment">% All rights reserved.</span>
 <span class="hljs-comment">%</span>
 <span class="hljs-comment">% * **Feed forward**</span>
 <span class="hljs-comment">%   * Input: `x1` and `x2`, with shapes `[h1, w1, ch1, bs]` and `[h2, w2, ch2, bs]`.</span>
 <span class="hljs-comment">%            `W`, the weights</span>
 <span class="hljs-comment">%   * Output: `y`, with shape `[ch1*ch2, bs]`.</span>
 <span class="hljs-comment">%</span>
 <span class="hljs-comment">% * **Back propagation**</span>
 <span class="hljs-comment">%   * Input: `x1`, `x2` and `W` are the same as in forward pass, </span>
 <span class="hljs-comment">%            dzdy = varargin{1}, is the derivative of loss `z` w.r.t `y`.</span>
 <span class="hljs-comment">%   * Output: y, the derivative of loss `z` w.r.t `x1`, i.e., dzdx1.</span>
 <span class="hljs-comment">%             varargout{1} = y2, the derivative of loss `z` w.r.t `x2`, i.e., dzdx2.</span>
 <span class="hljs-comment">%             varargout{2} = dw, the derivative of loss `z` w.r.t `W`, i.e., dzdW.</span>
 <span class="hljs-comment">%</span>
 <span class="hljs-comment">% -----------------------</span>
 <span class="hljs-comment">% The revised B-CNN model</span>
 <span class="hljs-comment">% -----------------------</span>
 <span class="hljs-comment">%</span>
 <span class="hljs-comment">%  $ Y = X_a^TWX_b,$</span>
 <span class="hljs-comment">%</span>
 <span class="hljs-comment">% where $I$ is an identity matrix and</span>
 <span class="hljs-comment">%     $X_a \in R^{P_a\times CH_a},~~X_b \in R^{P_b\times CH_b}, ~~W\in R^{P_a\times P_b}, ~~Y\in R^{CH_a\times CH_b}$</span>
 <span class="hljs-comment">%</span>
 <span class="hljs-comment">% The derivatives w.r.t $X_a$, $X_b$, and $W$ are</span>
 <span class="hljs-comment">% * $\nabla_{X_a}Z = WX_b\cdot(\nabla_YZ)^T$, $~~~~$(size: $P_a\times P_b \cdot P_b\times CH_b\cdot CH_b\times CH_a = P_a\times CH_a$)</span>
 <span class="hljs-comment">% * $\nabla_{X_b}Z = W^TX_a\cdot(\nabla_YZ)$,  $~~~~$(size: $P_b\times P_a \cdot P_a\times CH_a\cdot CH_a\times CH_b = P_b\times CH_b$)</span>
 <span class="hljs-comment">% * $\nabla_{W}Z = X_a\cdot(\nabla_YZ)\cdot X_b^T$.  $~~~$(size: $P_a\times CH_a \cdot CH_a\times CH_b\cdot CH_b\times P_b = P_a\times P_b$)</span>
 <span class="hljs-comment">%</span>
 <span class="hljs-comment">% -------------------------------------------------------------------------------------------------------</span>

 <span class="hljs-comment">% flag for doing backward pass</span>
 isBackward = <span class="hljs-built_in">numel</span>(varargin) &gt; <span class="hljs-number">0</span> &amp;&amp; ~isstr(varargin<span class="hljs-cell">{<span class="hljs-number">1</span>}</span>);
 <span class="hljs-keyword">if</span> isBackward
     dzdy = varargin<span class="hljs-cell">{<span class="hljs-number">1</span>}</span>;
 <span class="hljs-keyword">end</span>

 <span class="hljs-comment">% if GPU is used</span>
 gpuMode = isa(x1, <span class="hljs-string">'gpuArray'</span>);

 <span class="hljs-comment">% [height, widht, channels, batchsize]</span>
 <span class="hljs-matrix">[h1, w1, ch1, bs]</span> = <span class="hljs-built_in">size</span>(x1);
 <span class="hljs-matrix">[h2, w2, ch2, ~ ]</span> = <span class="hljs-built_in">size</span>(x2);

 <span class="hljs-keyword">if</span> ~isBackward
     <span class="hljs-comment">% forward pass</span>
     <span class="hljs-keyword">if</span> gpuMode
         y = gpuArray(<span class="hljs-built_in">zeros</span>(<span class="hljs-matrix">[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, ch1 * ch2, bs]</span>, <span class="hljs-string">'single'</span>));
     <span class="hljs-keyword">else</span>
         y = <span class="hljs-built_in">zeros</span>(<span class="hljs-matrix">[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, ch1 * ch2, bs]</span>, <span class="hljs-string">'single'</span>);
     <span class="hljs-keyword">end</span>

     <span class="hljs-keyword">for</span> b = <span class="hljs-number">1</span>: bs
         Xa = <span class="hljs-built_in">reshape</span>(x1(:,:,:,b), <span class="hljs-matrix">[h1 * w1, ch1]</span>);
         Xb = <span class="hljs-built_in">reshape</span>(x2(:,:,:,b), <span class="hljs-matrix">[h2 * w2, ch2]</span>);

         y(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, :, b) = <span class="hljs-built_in">reshape</span>(Xa<span class="hljs-operator">'</span>*W*Xb, <span class="hljs-matrix">[<span class="hljs-number">1</span>, ch1 * ch2]</span>); <span class="hljs-comment">%'</span>
     <span class="hljs-keyword">end</span>
 <span class="hljs-keyword">else</span>
     <span class="hljs-comment">% backward pass</span>
     <span class="hljs-keyword">if</span> gpuMode
         y1 = gpuArray(<span class="hljs-built_in">zeros</span>(h1, w1, ch1, bs, <span class="hljs-string">'single'</span>)); 
         y2 = gpuArray(<span class="hljs-built_in">zeros</span>(h2, w2, ch2, bs, <span class="hljs-string">'single'</span>)); 
         dw = gpuArray(<span class="hljs-built_in">zeros</span>(h1*w1, h2*w2,<span class="hljs-string">'single'</span>)); 
     <span class="hljs-keyword">else</span>
         y1 = (<span class="hljs-built_in">zeros</span>(h1, w1, ch1, bs, <span class="hljs-string">'single'</span>)); 
         y2 = (<span class="hljs-built_in">zeros</span>(h2, w2, ch2, bs, <span class="hljs-string">'single'</span>)); 
         dw = (<span class="hljs-built_in">zeros</span>(h1*w1, h2*w2,<span class="hljs-string">'single'</span>)); 
     <span class="hljs-keyword">end</span>

     <span class="hljs-keyword">for</span> b = <span class="hljs-number">1</span>: bs
         dZdY = <span class="hljs-built_in">reshape</span>(dzdy(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, :, b), <span class="hljs-matrix">[ch1, ch2]</span>);
         Xa = <span class="hljs-built_in">reshape</span>(x1(:,:,:,b), <span class="hljs-matrix">[h1 * w1, ch1]</span>);
         Xb = <span class="hljs-built_in">reshape</span>(x2(:,:,:,b), <span class="hljs-matrix">[h2 * w2, ch2]</span>);
         dZdXa = <span class="hljs-built_in">reshape</span>(W*Xb*dZdY<span class="hljs-operator">'</span>, <span class="hljs-matrix">[h1, w1, ch1]</span>);
         dZdXb = <span class="hljs-built_in">reshape</span>(W<span class="hljs-operator">'</span>*Xa*dZdY, <span class="hljs-matrix">[h2, w2, ch2]</span>);
         dZdW = Xa*dZdY*Xb<span class="hljs-operator">'</span>; <span class="hljs-comment">%'</span>

         y1(:, :, ;, b) = dZdXa;
         y2(:, :, :, b) = dZdXb;
         dw = dw + dZdW;
     <span class="hljs-keyword">end</span>
     y = y1;
     varargout<span class="hljs-cell">{<span class="hljs-number">1</span>}</span> = y2;
     varargout<span class="hljs-cell">{<span class="hljs-number">2</span>}</span> = dw / bs;
 <span class="hljs-keyword">end</span>
</code></pre>
<p> Note that when <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-828-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11704" style="width: 1.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.311em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.339em 1000em 2.507em -0.466em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-11705"><span class="msubsup" id="MathJax-Span-11706"><span style="display: inline-block; position: relative; width: 1.308em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11707" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11708" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.158em; vertical-align: -0.258em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-828">X_a</script></span> equals <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-829-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11709" style="width: 1.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.339em 1000em 2.508em -0.466em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-11710"><span class="msubsup" id="MathJax-Span-11711"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11712" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11713" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.159em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-829">X_b</script></span>, i.e. <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-830-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11714" style="width: 7.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.066em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.885em 1000em 3.054em -0.466em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11715"><span class="msubsup" id="MathJax-Span-11716"><span style="display: inline-block; position: relative; width: 1.308em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11717" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11718" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11719" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-11720" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11721" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11722" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11723" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-11724" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.159em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-830">X_a = X_b = X</script></span>. Assume <code>y{1} = dZdXa</code> and <code>y{2} = dZdXb</code>, we can reuse this function by taking <code>dzdx = dZdXa + dZdXb = y{1} + y{2}</code>.</p>
</li><li><p><strong>Register the layer to <code>vl_simplenn.m</code></strong></p>
<p> Since I always hold the belief of never changing the source code easily, I would leave <code>vl_simplenn.m</code> untouched but rather revise its alternative <code>vl_bilinearnn.m</code>. </p>
<pre><code data-origin="<pre><code> $ cp /path/to/bcnn/bcnn-package/vl_bilinearnn.m /path/to/bcnn/bcnn-package/vl_bilinearnn.m_bak
 $ gvim /path/to/bcnn/bcnn-package/vl_bilinearnn.m
</code></pre>"> $ cp /path/to/bcnn/bcnn-package/vl_bilinearnn.m /path/to/bcnn/bcnn-package/vl_bilinearnn.m_bak
 $ gvim /path/to/bcnn/bcnn-package/vl_bilinearnn.m
</code></pre><hr class="section">
<pre class="matlab hljs"><code class="matlab" data-origin="<pre><code class=&quot;matlab&quot;> % vl_bilinearnn.m

     ...
     % forward pass
         case 'pdist'
           res(i+1) = vl_nnpdist(res(i).x, l.p, 'noRoot', l.noRoot, 'epsilon', l.epsilon) ;
         case 'bilinearpool'
           res(i+1).x = vl_nnbilinearpool(res(i).x);
         case 'bilinearclpool'
           x1 = res(l.layer1+1).x;
           x2 = res(l.layer2+1).x;
           res(i+1).x = vl_nnbilinearclpool(x1, x2);

         % this is my layer. As a first try, I simply assume the input `x1` and `x2` are the same
         case 'weightedbilinearpool'
           res(i+1).x = vl_weightedbilinearpool(res(i).x, res(i).x, l.weights{1});

         case 'sqrt'
           res(i+1).x = vl_nnsqrt(res(i).x, 1e-8);
         case 'l2norm'
           res(i+1).x = vl_nnl2norm(res(i).x, 1e-10);
         case 'custom'

     ...

     % backward pass
         case 'bilinearclpool'
             x1 = res(l.layer1+1).x;
             x2 = res(l.layer2+1).x;
             [y1, y2] = vl_nnbilinearclpool(x1, x2, res(i+1).dzdx);
             res(l.layer1+1).dzdx = updateGradient(res(l.layer1+1).dzdx, y1);
             res(l.layer2+1).dzdx = updateGradient(res(l.layer2+1).dzdx, y2);

         % this is my layer. As a first try, I simply assume the input `x1` and `x2` are the same
         case 'weightedbilinearpool'
             [y1, y2, dzdw{1}] = vl_weightedbilinearpool(res(i).x, res(i).x, l.weights{1}, res(i+1).dzdx);
             res(i).dzdx = updateGradient(res(i).dzdx, y1 + y2);
             clear y1 y2

         case 'sqrt'
             backprop = vl_nnsqrt(res(i).x, 1e-8, res(i+1).dzdx);
             res(i).dzdx = updateGradient(res(i).dzdx, backprop);
             clear backprop
     ...

     % Add our type.
     switch l.type
         case {'conv', 'convt', 'bnorm', 'weightedbilinearpool'}
             if ~opts.accumulate
                 res(i).dzdw = dzdw ;
             else
                 for j=1:numel(dzdw)
                     res(i).dzdw{j} = res(i).dzdw{j} + dzdw{j} ;
             end
         end
         dzdw = [] ;
     end
</code></pre>"> <span class="hljs-comment">% vl_bilinearnn.m</span>

     ...
     <span class="hljs-comment">% forward pass</span>
         <span class="hljs-keyword">case</span> <span class="hljs-string">'pdist'</span>
           res(<span class="hljs-built_in">i</span>+<span class="hljs-number">1</span>) = vl_nnpdist(res(<span class="hljs-built_in">i</span>).x, l.p, <span class="hljs-string">'noRoot'</span>, l.noRoot, <span class="hljs-string">'epsilon'</span>, l.epsilon) ;
         <span class="hljs-keyword">case</span> <span class="hljs-string">'bilinearpool'</span>
           res(<span class="hljs-built_in">i</span>+<span class="hljs-number">1</span>).x = vl_nnbilinearpool(res(<span class="hljs-built_in">i</span>).x);
         <span class="hljs-keyword">case</span> <span class="hljs-string">'bilinearclpool'</span>
           x1 = res(l.layer1+<span class="hljs-number">1</span>).x;
           x2 = res(l.layer2+<span class="hljs-number">1</span>).x;
           res(<span class="hljs-built_in">i</span>+<span class="hljs-number">1</span>).x = vl_nnbilinearclpool(x1, x2);

         <span class="hljs-comment">% this is my layer. As a first try, I simply assume the input `x1` and `x2` are the same</span>
         <span class="hljs-keyword">case</span> <span class="hljs-string">'weightedbilinearpool'</span>
           res(<span class="hljs-built_in">i</span>+<span class="hljs-number">1</span>).x = vl_weightedbilinearpool(res(<span class="hljs-built_in">i</span>).x, res(<span class="hljs-built_in">i</span>).x, l.weights<span class="hljs-cell">{<span class="hljs-number">1</span>}</span>);

         <span class="hljs-keyword">case</span> <span class="hljs-string">'sqrt'</span>
           res(<span class="hljs-built_in">i</span>+<span class="hljs-number">1</span>).x = vl_nnsqrt(res(<span class="hljs-built_in">i</span>).x, <span class="hljs-number">1e-8</span>);
         <span class="hljs-keyword">case</span> <span class="hljs-string">'l2norm'</span>
           res(<span class="hljs-built_in">i</span>+<span class="hljs-number">1</span>).x = vl_nnl2norm(res(<span class="hljs-built_in">i</span>).x, <span class="hljs-number">1e-10</span>);
         <span class="hljs-keyword">case</span> <span class="hljs-string">'custom'</span>

     ...

     <span class="hljs-comment">% backward pass</span>
         <span class="hljs-keyword">case</span> <span class="hljs-string">'bilinearclpool'</span>
             x1 = res(l.layer1+<span class="hljs-number">1</span>).x;
             x2 = res(l.layer2+<span class="hljs-number">1</span>).x;
             <span class="hljs-matrix">[y1, y2]</span> = vl_nnbilinearclpool(x1, x2, res(<span class="hljs-built_in">i</span>+<span class="hljs-number">1</span>).dzdx);
             res(l.layer1+<span class="hljs-number">1</span>).dzdx = updateGradient(res(l.layer1+<span class="hljs-number">1</span>).dzdx, y1);
             res(l.layer2+<span class="hljs-number">1</span>).dzdx = updateGradient(res(l.layer2+<span class="hljs-number">1</span>).dzdx, y2);

         <span class="hljs-comment">% this is my layer. As a first try, I simply assume the input `x1` and `x2` are the same</span>
         <span class="hljs-keyword">case</span> <span class="hljs-string">'weightedbilinearpool'</span>
             <span class="hljs-matrix">[y1, y2, dzdw{<span class="hljs-number">1</span>}]</span> = vl_weightedbilinearpool(res(<span class="hljs-built_in">i</span>).x, res(<span class="hljs-built_in">i</span>).x, l.weights<span class="hljs-cell">{<span class="hljs-number">1</span>}</span>, res(<span class="hljs-built_in">i</span>+<span class="hljs-number">1</span>).dzdx);
             res(<span class="hljs-built_in">i</span>).dzdx = updateGradient(res(<span class="hljs-built_in">i</span>).dzdx, y1 + y2);
             clear y1 y2

         <span class="hljs-keyword">case</span> <span class="hljs-string">'sqrt'</span>
             backprop = vl_nnsqrt(res(<span class="hljs-built_in">i</span>).x, <span class="hljs-number">1e-8</span>, res(<span class="hljs-built_in">i</span>+<span class="hljs-number">1</span>).dzdx);
             res(<span class="hljs-built_in">i</span>).dzdx = updateGradient(res(<span class="hljs-built_in">i</span>).dzdx, backprop);
             clear backprop
     ...

     <span class="hljs-comment">% Add our type.</span>
     <span class="hljs-keyword">switch</span> l.type
         <span class="hljs-keyword">case</span> <span class="hljs-cell">{<span class="hljs-string">'conv'</span>, <span class="hljs-string">'convt'</span>, <span class="hljs-string">'bnorm'</span>, <span class="hljs-string">'weightedbilinearpool'</span>}</span>
             <span class="hljs-keyword">if</span> ~opts.accumulate
                 res(<span class="hljs-built_in">i</span>).dzdw = dzdw ;
             <span class="hljs-keyword">else</span>
                 <span class="hljs-keyword">for</span> <span class="hljs-built_in">j</span>=<span class="hljs-number">1</span>:<span class="hljs-built_in">numel</span>(dzdw)
                     res(<span class="hljs-built_in">i</span>).dzdw<span class="hljs-cell">{j}</span> = res(<span class="hljs-built_in">i</span>).dzdw<span class="hljs-cell">{j}</span> + dzdw<span class="hljs-cell">{j}</span> ;
             <span class="hljs-keyword">end</span>
         <span class="hljs-keyword">end</span>
         dzdw = <span class="hljs-matrix">[]</span> ;
     <span class="hljs-keyword">end</span>
</code></pre>
</li><li><p><strong>Our work of adding a layer to <code>matconvnet</code> is almost done</strong>. However, one another small revision is indispensable for enabling our layer to run on a GPU unbuggly when using <code>vl_bilinearnn.m</code>. That is, add our layer to the <code>vl_simplenn_move.m</code>.</p>
<pre class="matlab hljs"><code class="matlab" data-origin="<pre><code class=&quot;matlab&quot;> % /path/to/bcnn/matconvnet/matlab/simplenn/vl_simplenn_move.m
 for l=1:numel(net.layers)
     switch net.layers{l}.type
         case {'conv', 'convt', 'bnorm', 'weightedbilinearpool'}
             for f = {'filters', 'biases', 'filtersMomentum', 'biasesMomentum'}
</code></pre>"> <span class="hljs-comment">% /path/to/bcnn/matconvnet/matlab/simplenn/vl_simplenn_move.m</span>
 <span class="hljs-keyword">for</span> l=<span class="hljs-number">1</span>:<span class="hljs-built_in">numel</span>(net.layers)
     <span class="hljs-keyword">switch</span> net.layers<span class="hljs-cell">{l}</span>.type
         <span class="hljs-keyword">case</span> <span class="hljs-cell">{<span class="hljs-string">'conv'</span>, <span class="hljs-string">'convt'</span>, <span class="hljs-string">'bnorm'</span>, <span class="hljs-string">'weightedbilinearpool'</span>}</span>
             <span class="hljs-keyword">for</span> f = <span class="hljs-cell">{<span class="hljs-string">'filters'</span>, <span class="hljs-string">'biases'</span>, <span class="hljs-string">'filtersMomentum'</span>, <span class="hljs-string">'biasesMomentum'</span>}</span>
</code></pre>
</li></ol><h4 id="5.5-build-our-`wb-cnn`-model-for-training."><a name="5.5-build-our-`wb-cnn`-model-for-training." href="#5.5-build-our-`wb-cnn`-model-for-training."></a>5.5 Build our <code>WB-CNN</code> model for training.</h4><p>Now that we have added a self-defined layer with type <code>weightedbilinearpool</code> to <code>matconvnet</code>, we need to build a network to test if it works correctly or if it ever works. I’ll do it by revised the <code>B-CNN</code> model.</p><p>As a first try, let’s implements a simple symmetric <code>WB-CNN</code>, which can be built easily by replacing the <code>bilinearpool</code> layer in a symmetric <code>B-CNN</code> with our <code>weightedbilinearpool</code> layer.</p><ol>
<li><p><strong>Modify <code>initializeNetworkSharedWeights.m</code></strong></p>
<pre><code data-origin="<pre><code> $ cp /path/to/bcnn/initializeNetworkSharedWeights.m /path/to/bcnn/initializeNetworkWeightedBcnn.m
 $ gvim /path/to/bcnn/initializeNetworkWeightedBcnn.m
</code></pre>"> $ cp /path/to/bcnn/initializeNetworkSharedWeights.m /path/to/bcnn/initializeNetworkWeightedBcnn.m
 $ gvim /path/to/bcnn/initializeNetworkWeightedBcnn.m
</code></pre><hr class="section">
<pre class="matlab hljs"><code class="matlab" data-origin="<pre><code class=&quot;matlab&quot;> % initializeNetworkWeightedBcnn.m

     ...

     % build a linear classifier netc
     netc.layers = {};

     h1 = 27;
     w1 = 27;
     bilinearW = 0.001/scal * randn(h1*w1, h1*w1, 'single');
     % stack weighted bilinearpool layer
     netc.layers{end+1} = struct('type', 'weightedbilinearpool', 'name', 'wblp', ...
         'weights',{{bilinearW}} , ...
         'learningRate', [1000], ...
         'weightDecay', [0.9]);

     % stack a dropout layer, `rate` is defined as a probability of a varaiable not to be zeroed.
     netc.layers{end+1} = struct('type', 'dropout', 'name', 'dropout_wbcnn',...
         'rate', 0.3);

     % stack a relu layer
      netc.layers{end+1} = struct('type', 'relu', 'name', 'relu6');

     % stack normalization
     netc.layers{end+1} = struct('type', 'sqrt', 'name', 'sqrt_norm');
     netc.layers{end+1} = struct('type', 'l2norm', 'name', 'l2_norm');

     % stack classifier layer
     initialW = 0.001/scal * randn(1,1,ch1*ch2,numClass,'single');
     initialBias = init_bias.*ones(1, numClass, 'single');
     netc.layers{end+1} = struct('type', 'conv', 'name', 'classifier', ...
         'weights', {{initialW, initialBias}}, ...
         'stride', 1, ...
         'pad', 0, ...
         'learningRate', [1000 1000], ...
         'weightDecay', [0 0]) ;
     netc.layers{end+1} = struct('type', 'softmaxloss', 'name', 'loss') ;
     netc = vl_simplenn_tidy(netc) ;

     ...

                 codeb = squeeze(gather(res(end).x));
                 for i=1:numel(batch)
                      %
                      code = codeb(:, :, :, i);
     %                code = reshape(codeb(:, :, :, i), size(codeb, 1)*size(codeb, 2), size(codeb, 3));
                     savefast(fullfile(opts.nonftbcnnDir, ['bcnn_nonft_', num2str(batch(i), '%05d')]), 'code');
                 end
             end
         end

     ...

     function [im,labels] = getBatch_bcnn_fromdisk(imdb, batch)
     % -------------------------------------------------------------------------

     imtmp = cell(1, numel(batch));
     for i=1:numel(batch)
         load(fullfile(imdb.imageDir, imdb.images.name{batch(i)}));
         imtmp{i} = code;
     end
     h = size(imtmp{1}, 1);
     w = size(imtmp{1}, 2);
     ch = size(imtmp{1}, 3);
     im = zeros(h, w, ch, numel(batch));
     for i = 1:numel(batch)
         im(:, :, :, i) = imtmp{i};
     end
     clear imtmp
     %im = cat(2, im{:});
     %im = reshape(im, size(im, 1), size(im, 2), size(im,3), size(im, 4));
     labels = imdb.images.label(batch) ;
</code></pre>"> <span class="hljs-comment">% initializeNetworkWeightedBcnn.m</span>

     ...

     <span class="hljs-comment">% build a linear classifier netc</span>
     netc.layers = <span class="hljs-cell">{}</span>;

     h1 = <span class="hljs-number">27</span>;
     w1 = <span class="hljs-number">27</span>;
     bilinearW = <span class="hljs-number">0.001</span>/scal * <span class="hljs-built_in">randn</span>(h1*w1, h1*w1, <span class="hljs-string">'single'</span>);
     <span class="hljs-comment">% stack weighted bilinearpool layer</span>
     netc.layers<span class="hljs-cell">{end+<span class="hljs-number">1</span>}</span> = struct(<span class="hljs-string">'type'</span>, <span class="hljs-string">'weightedbilinearpool'</span>, <span class="hljs-string">'name'</span>, <span class="hljs-string">'wblp'</span>, ...
         <span class="hljs-string">'weights'</span>,<span class="hljs-cell">{{bilinearW}</span>} , ...
         <span class="hljs-string">'learningRate'</span>, <span class="hljs-matrix">[<span class="hljs-number">1000</span>]</span>, ...
         <span class="hljs-string">'weightDecay'</span>, <span class="hljs-matrix">[<span class="hljs-number">0.9</span>]</span>);

     <span class="hljs-comment">% stack a dropout layer, `rate` is defined as a probability of a varaiable not to be zeroed.</span>
     netc.layers<span class="hljs-cell">{end+<span class="hljs-number">1</span>}</span> = struct(<span class="hljs-string">'type'</span>, <span class="hljs-string">'dropout'</span>, <span class="hljs-string">'name'</span>, <span class="hljs-string">'dropout_wbcnn'</span>,...
         <span class="hljs-string">'rate'</span>, <span class="hljs-number">0.3</span>);

     <span class="hljs-comment">% stack a relu layer</span>
      netc.layers<span class="hljs-cell">{end+<span class="hljs-number">1</span>}</span> = struct(<span class="hljs-string">'type'</span>, <span class="hljs-string">'relu'</span>, <span class="hljs-string">'name'</span>, <span class="hljs-string">'relu6'</span>);

     <span class="hljs-comment">% stack normalization</span>
     netc.layers<span class="hljs-cell">{end+<span class="hljs-number">1</span>}</span> = struct(<span class="hljs-string">'type'</span>, <span class="hljs-string">'sqrt'</span>, <span class="hljs-string">'name'</span>, <span class="hljs-string">'sqrt_norm'</span>);
     netc.layers<span class="hljs-cell">{end+<span class="hljs-number">1</span>}</span> = struct(<span class="hljs-string">'type'</span>, <span class="hljs-string">'l2norm'</span>, <span class="hljs-string">'name'</span>, <span class="hljs-string">'l2_norm'</span>);

     <span class="hljs-comment">% stack classifier layer</span>
     initialW = <span class="hljs-number">0.001</span>/scal * <span class="hljs-built_in">randn</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,ch1*ch2,numClass,<span class="hljs-string">'single'</span>);
     initialBias = init_bias.*<span class="hljs-built_in">ones</span>(<span class="hljs-number">1</span>, numClass, <span class="hljs-string">'single'</span>);
     netc.layers<span class="hljs-cell">{end+<span class="hljs-number">1</span>}</span> = struct(<span class="hljs-string">'type'</span>, <span class="hljs-string">'conv'</span>, <span class="hljs-string">'name'</span>, <span class="hljs-string">'classifier'</span>, ...
         <span class="hljs-string">'weights'</span>, <span class="hljs-cell">{{initialW, initialBias}</span>}, ...
         <span class="hljs-string">'stride'</span>, <span class="hljs-number">1</span>, ...
         <span class="hljs-string">'pad'</span>, <span class="hljs-number">0</span>, ...
         <span class="hljs-string">'learningRate'</span>, <span class="hljs-matrix">[<span class="hljs-number">1000</span> <span class="hljs-number">1000</span>]</span>, ...
         <span class="hljs-string">'weightDecay'</span>, <span class="hljs-matrix">[<span class="hljs-number">0</span> <span class="hljs-number">0</span>]</span>) ;
     netc.layers<span class="hljs-cell">{end+<span class="hljs-number">1</span>}</span> = struct(<span class="hljs-string">'type'</span>, <span class="hljs-string">'softmaxloss'</span>, <span class="hljs-string">'name'</span>, <span class="hljs-string">'loss'</span>) ;
     netc = vl_simplenn_tidy(netc) ;

     ...

                 codeb = <span class="hljs-built_in">squeeze</span>(gather(res(<span class="hljs-keyword">end</span>).x));
                 <span class="hljs-keyword">for</span> <span class="hljs-built_in">i</span>=<span class="hljs-number">1</span>:<span class="hljs-built_in">numel</span>(batch)
                      <span class="hljs-comment">%</span>
                      code = codeb(:, :, :, <span class="hljs-built_in">i</span>);
     <span class="hljs-comment">%                code = reshape(codeb(:, :, :, i), size(codeb, 1)*size(codeb, 2), size(codeb, 3));</span>
                     savefast(fullfile(opts.nonftbcnnDir, <span class="hljs-matrix">[<span class="hljs-string">'bcnn_nonft_'</span>, num2str(batch(i), <span class="hljs-string">'%05d'</span>)]</span>), <span class="hljs-string">'code'</span>);
                 <span class="hljs-keyword">end</span>
             <span class="hljs-keyword">end</span>
         <span class="hljs-keyword">end</span>

     ...

     <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">[im,labels]</span> = <span class="hljs-title">getBatch_bcnn_fromdisk</span><span class="hljs-params">(imdb, batch)</span></span>
     <span class="hljs-comment">% -------------------------------------------------------------------------</span>

     imtmp = cell(<span class="hljs-number">1</span>, <span class="hljs-built_in">numel</span>(batch));
     <span class="hljs-keyword">for</span> <span class="hljs-built_in">i</span>=<span class="hljs-number">1</span>:<span class="hljs-built_in">numel</span>(batch)
         load(fullfile(imdb.imageDir, imdb.images.name<span class="hljs-cell">{batch(i)}</span>));
         imtmp<span class="hljs-cell">{i}</span> = code;
     <span class="hljs-keyword">end</span>
     h = <span class="hljs-built_in">size</span>(imtmp<span class="hljs-cell">{<span class="hljs-number">1</span>}</span>, <span class="hljs-number">1</span>);
     w = <span class="hljs-built_in">size</span>(imtmp<span class="hljs-cell">{<span class="hljs-number">1</span>}</span>, <span class="hljs-number">2</span>);
     ch = <span class="hljs-built_in">size</span>(imtmp<span class="hljs-cell">{<span class="hljs-number">1</span>}</span>, <span class="hljs-number">3</span>);
     im = <span class="hljs-built_in">zeros</span>(h, w, ch, <span class="hljs-built_in">numel</span>(batch));
     <span class="hljs-keyword">for</span> <span class="hljs-built_in">i</span> = <span class="hljs-number">1</span>:<span class="hljs-built_in">numel</span>(batch)
         im(:, :, :, <span class="hljs-built_in">i</span>) = imtmp<span class="hljs-cell">{i}</span>;
     <span class="hljs-keyword">end</span>
     clear imtmp
     <span class="hljs-comment">%im = cat(2, im{:});</span>
     <span class="hljs-comment">%im = reshape(im, size(im, 1), size(im, 2), size(im,3), size(im, 4));</span>
     labels = imdb.images.label(batch) ;
</code></pre>
</li><li><p><strong>Open <code>/path/to/bcnn/matconvnet/examples/cnn_train.m</code> and replace the <code>vl_simplenn</code> with <code>vl_bilinearnn</code></strong>.</p>
<pre class="matlab hljs"><code class="matlab" data-origin="<pre><code class=&quot;matlab&quot;> %     res = vl_simplenn(net, im, dzdy, res, ...
 %                       'accumulate', s ~= 1, ...
 %                       'mode', evalMode, ...
 %                       'conserveMemory', params.conserveMemory, ...
 %                       'backPropDepth', params.backPropDepth, ...
 %                       'sync', params.sync, ...
 %                       'cudnn', params.cudnn, ...
 %                       'parameterServer', parserv, ...
 %                       'holdOn', s &amp;lt; params.numSubBatches) ;

      res = vl_bilinearnn(net, im, dzdy, res, ...
                       'accumulate', s ~= 1, ...
                       'mode', evalMode, ...
                       'conserveMemory', params.conserveMemory, ...
                       'backPropDepth', params.backPropDepth, ...
                       'sync', params.sync, ...
                       'cudnn', params.cudnn) ;
</code></pre>"> <span class="hljs-comment">%     res = vl_simplenn(net, im, dzdy, res, ...</span>
 <span class="hljs-comment">%                       'accumulate', s ~= 1, ...</span>
 <span class="hljs-comment">%                       'mode', evalMode, ...</span>
 <span class="hljs-comment">%                       'conserveMemory', params.conserveMemory, ...</span>
 <span class="hljs-comment">%                       'backPropDepth', params.backPropDepth, ...</span>
 <span class="hljs-comment">%                       'sync', params.sync, ...</span>
 <span class="hljs-comment">%                       'cudnn', params.cudnn, ...</span>
 <span class="hljs-comment">%                       'parameterServer', parserv, ...</span>
 <span class="hljs-comment">%                       'holdOn', s &lt; params.numSubBatches) ;</span>

      res = vl_bilinearnn(net, im, dzdy, res, ...
                       <span class="hljs-string">'accumulate'</span>, s ~= <span class="hljs-number">1</span>, ...
                       <span class="hljs-string">'mode'</span>, evalMode, ...
                       <span class="hljs-string">'conserveMemory'</span>, params.conserveMemory, ...
                       <span class="hljs-string">'backPropDepth'</span>, params.backPropDepth, ...
                       <span class="hljs-string">'sync'</span>, params.sync, ...
                       <span class="hljs-string">'cudnn'</span>, params.cudnn) ;
</code></pre>
</li></ol><h4 id="5.6-experimental-results."><a name="5.6-experimental-results." href="#5.6-experimental-results."></a>5.6 Experimental results.</h4><p>We use the same training method as that in Tsung-Yu’s paper. As a first try, we use the simple model <strong>WB-CNN[M,M]</strong> and train it on <strong>birds</strong> dataset for comparison.</p><p>Experimental result of WB-CNN[M,M] model trained on <em>CUB-100-2011</em> is shown in the following table.</p><p><code>error-1</code> is the validation error of traning step 1, which trains a classifier for the model on <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-831-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11725" style="width: 1.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.53em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11726"><span class="mn" id="MathJax-Span-11727" style="font-family: MathJax_Main;">2</span><span class="texatom" id="MathJax-Span-11728"><span class="mrow" id="MathJax-Span-11729"><span class="mo" id="MathJax-Span-11730" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-11731" style="font-family: MathJax_Main;">3</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-831">2/3</script></span> traning set leaving out <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-832-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11732" style="width: 1.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.53em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.409em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11733"><span class="mn" id="MathJax-Span-11734" style="font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-11735"><span class="mrow" id="MathJax-Span-11736"><span class="mo" id="MathJax-Span-11737" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-11738" style="font-family: MathJax_Main;">3</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-832">1/3</script></span> for validation.</p><p><code>error-2</code> is the validation error of traning step 2, which is the fine-tuning step with <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-833-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11739" style="width: 1.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.53em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11740"><span class="mn" id="MathJax-Span-11741" style="font-family: MathJax_Main;">2</span><span class="texatom" id="MathJax-Span-11742"><span class="mrow" id="MathJax-Span-11743"><span class="mo" id="MathJax-Span-11744" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-11745" style="font-family: MathJax_Main;">3</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-833">2/3</script></span> of traning set leaving out the same <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-834-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11746" style="width: 1.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.53em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.409em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11747"><span class="mn" id="MathJax-Span-11748" style="font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-11749"><span class="mrow" id="MathJax-Span-11750"><span class="mo" id="MathJax-Span-11751" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-11752" style="font-family: MathJax_Main;">3</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-834">1/3</script></span> for validation.</p><p><code>accuracy</code> is the final accuracy after training on the whole training set.</p><table>
<thead>
<tr>
<th style="text-align:center">model</th>
<th style="text-align:center">error-1</th>
<th style="text-align:center">error-2</th>
<th style="text-align:center">accuracy</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">B-CNN[M, M]</td>
<td style="text-align:center">&gt; 0.39</td>
<td style="text-align:center">&gt; 0.28</td>
<td style="text-align:center">77.56%</td>
</tr>
<tr>
<td style="text-align:center">WB-CNN[M, M]</td>
<td style="text-align:center">&lt; 0.34</td>
<td style="text-align:center">&lt; 0.25</td>
<td style="text-align:center">78.70%</td>
</tr>
</tbody>
</table><p>It seems that the gain from adding a weight matrix is not that impressive as indicated by <code>error-1</code> and <code>error-2</code>. In fact experimental result with <strong>WB-CNN[D,D]</strong> does not show any improvement over <em>*B-CNN[D,D]</em>.</p><p>One thing to note is that since the identity matrix gives the original paper excellent performance, it inspires us to <strong>initialize our matrix <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-835-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11753" style="width: 1.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.093em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.7em -0.441em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-11754"><span class="mi" id="MathJax-Span-11755" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-835">W</script></span> with an identity matrix</strong>. By letting it begin with an identity matrix, we would like the training algorithm to find if there is a better matrix and if not, we hope the algorithm to find its way back to the identity matrix. In fact, we have also experimented with a random matrix generated by a scaled gaussian distribution and it gives a poor result of accuracy smaller than 76%.</p><h4 id="5.7-other-variations-of-revision"><a name="5.7-other-variations-of-revision" href="#5.7-other-variations-of-revision"></a>5.7 Other variations of revision</h4><p>Another attemptation we made is to constrain the matrix to be symmetric by formulating it as <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-836-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11756" style="width: 11.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.617em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.68em 1000em 3.15em -0.462em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11757"><span class="mi" id="MathJax-Span-11758" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-11759" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-11760" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11761" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.598em 1000em 2.404em -0.477em); top: -2.65em; left: 0.932em;"><span class="mi" id="MathJax-Span-11762" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.765em 1000em 2.411em -0.468em); top: -1.993em; left: 0.85em;"><span class="mi" id="MathJax-Span-11763" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11764" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-11765"><span style="display: inline-block; position: relative; width: 1.741em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.7em -0.441em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11766" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.65em; left: 1.174em;"><span class="mi" id="MathJax-Span-11767" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11768" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-11769" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span class="mo" id="MathJax-Span-11770" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-11771"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11772" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11773" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.528em; vertical-align: -0.377em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-836">Y = X_a^T(W^T+W)X_b</script></span>. The gradient is correspondingly <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-837-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11774" style="width: 17.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.208em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.613em 1000em 3.146em -0.446em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11775"><span class="msubsup" id="MathJax-Span-11776"><span style="display: inline-block; position: relative; width: 1.714em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-11777" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-11778" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.074em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-11779" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-11780" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-11781" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.308em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11782" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11783" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11784" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-11785"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-11786" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-11787" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-11788" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-11789" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-11790" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="msubsup" id="MathJax-Span-11791"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-11792" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-11793" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-11794" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="msubsup" id="MathJax-Span-11795"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-11796" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-11797" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11798" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-11799"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11800" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11801" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.604em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-837">\nabla_WY = X_a (\nabla_YZ + (\nabla_YZ)^T) X_b</script></span>.<br>The observation is that by decomposing <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-838-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11802" style="width: 24.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.781em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.613em 1000em 3.146em -0.466em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11803"><span class="msubsup" id="MathJax-Span-11804"><span style="display: inline-block; position: relative; width: 1.308em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11805" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11806" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11807" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-11808" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="msubsup" id="MathJax-Span-11809"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.909em 1000em 2.688em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11810" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.546em;"><span class="mn" id="MathJax-Span-11811" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-11812" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-11813" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.909em 1000em 2.688em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11814" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.546em;"><span class="mn" id="MathJax-Span-11815" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-11816" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-11817" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-11818" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-11819" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-11820" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-11821" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(1.909em 1000em 2.688em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11822" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.546em;"><span class="mi" id="MathJax-Span-11823" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-11824"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-11825" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-11826" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11827" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-11828" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11829" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11830" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11831" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-11832" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="msubsup" id="MathJax-Span-11833"><span style="display: inline-block; position: relative; width: 0.895em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.452em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11834" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.437em;"><span class="mn" id="MathJax-Span-11835" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-11836" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-11837" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.895em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.452em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11838" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.437em;"><span class="mn" id="MathJax-Span-11839" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-11840" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-11841" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-11842" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-11843" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-11844" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-11845" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.452em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11846" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.437em;"><span class="mi" id="MathJax-Span-11847" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-11848"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-11849" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-11850" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.604em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-838">X_a = (a_1, a_2, ..., a_m)^T, X_b = (b_1, b_2, ..., b_n)^T</script></span> and rewritting <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-839-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11851" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.677em -0.462em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-11852"><span class="mi" id="MathJax-Span-11853" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.965em; vertical-align: -0.065em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-839">Y</script></span> as</p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-840-Frame"><nobr><span class="math" id="MathJax-Span-11854" style="width: 27.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.732em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.613em 1000em 4.224em -0.462em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11855"><span class="mi" id="MathJax-Span-11856" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-11857" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-11858" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="msubsup" id="MathJax-Span-11859"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.909em 1000em 2.688em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11860" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.546em;"><span class="mn" id="MathJax-Span-11861" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-11862" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-11863" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.909em 1000em 2.688em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11864" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.546em;"><span class="mn" id="MathJax-Span-11865" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-11866" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-11867" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-11868" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-11869" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-11870" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-11871" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(1.909em 1000em 2.688em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11872" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.546em;"><span class="mi" id="MathJax-Span-11873" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11874" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-11875" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span class="mo" id="MathJax-Span-11876" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-11877"><span style="display: inline-block; position: relative; width: 0.895em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.452em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11878" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.437em;"><span class="mn" id="MathJax-Span-11879" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-11880" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-11881" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.895em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.452em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11882" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.437em;"><span class="mn" id="MathJax-Span-11883" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-11884" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-11885" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-11886" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-11887" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-11888" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-11889" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.452em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11890" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.437em;"><span class="mi" id="MathJax-Span-11891" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-11892"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-11893" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-11894" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11895" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="munderover" id="MathJax-Span-11896" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.475em; height: 0px;"><span style="position: absolute; clip: rect(2.657em 1000em 4.384em -0.437em); top: -3.77em; left: 0em;"><span class="mo" id="MathJax-Span-11897" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.77em;"></span></span><span style="position: absolute; clip: rect(1.664em 1000em 2.703em -0.477em); top: -1.211em; left: 0.355em;"><span class="texatom" id="MathJax-Span-11898"><span class="mrow" id="MathJax-Span-11899"><span class="mi" id="MathJax-Span-11900" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-11901" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-11902" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-11903" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.386em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11904" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.765em;"><span class="texatom" id="MathJax-Span-11905"><span class="mrow" id="MathJax-Span-11906"><span class="mi" id="MathJax-Span-11907" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-11908" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-11909"><span style="display: inline-block; position: relative; width: 0.895em; height: 0px;"><span style="position: absolute; clip: rect(1.909em 1000em 2.688em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11910" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.546em;"><span class="mi" id="MathJax-Span-11911" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-11912"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.452em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11913" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.437em;"><span class="mi" id="MathJax-Span-11914" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.92em; vertical-align: -1.687em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-840">Y = (a_1, a_2, ..., a_m)W(b_1, b_2, ..., b_n)^T = \sum_{i,j}w_{ij}a_i b_j</script><p></p><p>Note that when <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-841-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11915" style="width: 1.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.311em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.339em 1000em 2.507em -0.466em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-11916"><span class="msubsup" id="MathJax-Span-11917"><span style="display: inline-block; position: relative; width: 1.308em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11918" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11919" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.158em; vertical-align: -0.258em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-841">X_a</script></span> equals <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-842-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11920" style="width: 1.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.339em 1000em 2.508em -0.466em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-11921"><span class="msubsup" id="MathJax-Span-11922"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11923" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11924" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.159em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-842">X_b</script></span> which is the condition in our simple try, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-843-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11925" style="width: 2.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.749em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.328em 1000em 2.644em -0.459em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-11926"><span class="msubsup" id="MathJax-Span-11927"><span style="display: inline-block; position: relative; width: 0.895em; height: 0px;"><span style="position: absolute; clip: rect(1.909em 1000em 2.688em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11928" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.546em;"><span class="mi" id="MathJax-Span-11929" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-11930"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.452em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11931" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.437em;"><span class="mi" id="MathJax-Span-11932" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.339em; vertical-align: -0.426em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-843">a_i b_j</script></span> equals <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-844-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11933" style="width: 2.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.749em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.328em 1000em 2.644em -0.459em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-11934"><span class="msubsup" id="MathJax-Span-11935"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.909em 1000em 2.688em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11936" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.546em;"><span class="mi" id="MathJax-Span-11937" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-11938"><span style="display: inline-block; position: relative; width: 0.785em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.452em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11939" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.437em;"><span class="mi" id="MathJax-Span-11940" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.339em; vertical-align: -0.426em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-844">a_j b_i</script></span>, which means <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-845-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11941" style="width: 1.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.421em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.579em 1000em 2.644em -0.471em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-11942"><span class="msubsup" id="MathJax-Span-11943"><span style="display: inline-block; position: relative; width: 1.386em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11944" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.765em;"><span class="texatom" id="MathJax-Span-11945"><span class="mrow" id="MathJax-Span-11946"><span class="mi" id="MathJax-Span-11947" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-11948" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.033em; vertical-align: -0.426em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-845">w_{ij}</script></span> should equal to <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-846-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11949" style="width: 1.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.421em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.579em 1000em 2.644em -0.471em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-11950"><span class="msubsup" id="MathJax-Span-11951"><span style="display: inline-block; position: relative; width: 1.386em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11952" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.765em;"><span class="texatom" id="MathJax-Span-11953"><span class="mrow" id="MathJax-Span-11954"><span class="mi" id="MathJax-Span-11955" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mi" id="MathJax-Span-11956" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.033em; vertical-align: -0.426em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-846">w_{ji}</script></span>, i.e., <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-847-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11957" style="width: 1.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.093em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.7em -0.441em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-11958"><span class="mi" id="MathJax-Span-11959" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-847">W</script></span> should be symmetric.</p><p>However, experiments show that this attemptation does not help.</p><p>What’s worse, experiments with the <strong>WB-CNN[D,D]</strong> do not show any improvement over the orignal un-weighted model.</p><p>Still one another attemptation is that we formualte it as <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-848-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11960" style="width: 10.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.197em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.462em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11961"><span class="mi" id="MathJax-Span-11962" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-11963" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-11964" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.308em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11965" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11966" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-11967" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-11968" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span class="mo" id="MathJax-Span-11969" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-11970" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mo" id="MathJax-Span-11971" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-11972"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11973" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-11974" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-848">Y = X_a(W+I)X_b</script></span>, and initialize <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-849-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11975" style="width: 1.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.093em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.7em -0.441em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-11976"><span class="mi" id="MathJax-Span-11977" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-849">W</script></span> randomly. The underlying motivation is that, we preserve the model’s orignal ability and let it determine if the identity matrix should be adjusted by <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-850-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11978" style="width: 1.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.093em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.7em -0.441em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-11979"><span class="mi" id="MathJax-Span-11980" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-850">W</script></span> to improve performance. However this dosen’t show any improvement as well. We look into the trained matrix <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-851-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11981" style="width: 1.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.093em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.7em -0.441em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-11982"><span class="mi" id="MathJax-Span-11983" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-851">W</script></span> and find that it learns very small weights, all with order 1e-3, which seems to indicate that the identity matrix is actually the best…</p><p>However, experimental results with step one seem to indicate that our revised models is superior to the original model, but the benefit of our revised models is eliminated by the feature extractors. Why?</p><p>Observing that our weights matrix <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-852-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11984" style="width: 1.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.093em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.7em -0.441em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-11985"><span class="mi" id="MathJax-Span-11986" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-852">W</script></span> is <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-853-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11987" style="width: 5.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.262em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.892em 1000em 2.918em -0.437em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11988"><span class="mn" id="MathJax-Span-11989" style="font-family: MathJax_Main;">729</span><span class="mo" id="MathJax-Span-11990" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mn" id="MathJax-Span-11991" style="font-family: MathJax_Main; padding-left: 0.222em;">729</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.985em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-853">729\times 729</script></span> for the WB-CNN[M,M] model, which is a lot of parameters, maybe it is because it overfits easily since our birds dataset is too small? How about try some dropout?</p><p>However, experiments with different dropout rates (0.7, 0.5, 0.3, 0.1) do not show any help and some even hurt.</p><p>Anyway the experiments with traning step 1 and 2 demonstrate that our revised models are superior to the original model at least in some aspects. As to what aspects remains unknown.</p><h4 id="5.7-conclusion"><a name="5.7-conclusion" href="#5.7-conclusion"></a>5.7 Conclusion</h4><p>In the revised model, we tried different formulations of bilinear models such as <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-854-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-11992" style="width: 7.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.902em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.68em 1000em 3.15em -0.462em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-11993"><span class="mi" id="MathJax-Span-11994" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-11995" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-11996" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-11997" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.598em 1000em 2.404em -0.477em); top: -2.65em; left: 0.932em;"><span class="mi" id="MathJax-Span-11998" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.765em 1000em 2.411em -0.468em); top: -1.993em; left: 0.85em;"><span class="mi" id="MathJax-Span-11999" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-12000" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span class="msubsup" id="MathJax-Span-12001"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-12002" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-12003" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.528em; vertical-align: -0.377em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-854">Y = X_a^TWX_b</script></span>, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-855-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-12004" style="width: 10.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.415em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.68em 1000em 3.15em -0.462em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-12005"><span class="mi" id="MathJax-Span-12006" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-12007" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-12008" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-12009" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.598em 1000em 2.404em -0.477em); top: -2.65em; left: 0.932em;"><span class="mi" id="MathJax-Span-12010" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.765em 1000em 2.411em -0.468em); top: -1.993em; left: 0.85em;"><span class="mi" id="MathJax-Span-12011" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-12012" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-12013" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span class="mo" id="MathJax-Span-12014" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-12015" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mo" id="MathJax-Span-12016" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-12017"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-12018" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-12019" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.528em; vertical-align: -0.377em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-855">Y = X_a^T(W+I)X_b</script></span> or <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-856-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-12020" style="width: 11.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.617em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.68em 1000em 3.15em -0.462em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-12021"><span class="mi" id="MathJax-Span-12022" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-12023" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-12024" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-12025" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.598em 1000em 2.404em -0.477em); top: -2.65em; left: 0.932em;"><span class="mi" id="MathJax-Span-12026" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.765em 1000em 2.411em -0.468em); top: -1.993em; left: 0.85em;"><span class="mi" id="MathJax-Span-12027" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-12028" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-12029"><span style="display: inline-block; position: relative; width: 1.741em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.7em -0.441em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-12030" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.65em; left: 1.174em;"><span class="mi" id="MathJax-Span-12031" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-12032" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-12033" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span class="mo" id="MathJax-Span-12034" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-12035"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-12036" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.85em;"><span class="mi" id="MathJax-Span-12037" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.528em; vertical-align: -0.377em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-856">Y = X_a^T(W^T+W)X_b</script></span> and try with WB-CNN[M,M] and WB-CNN[D,D] models on the birds dataset. Experimental results show that the revised models improve the B-CNN[M,M] model slightly while do not help the B-CNN[D,D] model on the birds dataset.</p><h2 id="附录-6-深入探究-bilinear-与-covariance-的关系-(2016-12-25,-sunday@-fudan-library,-zhang-jiang)"><a name="附录-6-深入探究-bilinear-与-covariance-的关系-(2016-12-25,-sunday@-fudan-library,-zhang-jiang)" href="#附录-6-深入探究-bilinear-与-covariance-的关系-(2016-12-25,-sunday@-fudan-library,-zhang-jiang)"></a>附录-6 深入探究 Bilinear 与 Covariance 的关系 (2016-12-25, Sunday@ Fudan Library, Zhang Jiang)</h2><p>回到 4.3 节的问题,</p><ul>
<li><p><strong>如果把双线性编码方式直接替换为方差矩阵即 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1111-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-17124" style="width: 14.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.022em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.613em 1000em 3.287em -0.492em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-17125"><span class="mfrac" id="MathJax-Span-17126"><span style="display: inline-block; position: relative; width: 1.486em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.66em 1000em 2.459em -0.433em); top: -2.708em; left: 50%; margin-left: -0.191em;"><span class="mn" id="MathJax-Span-17127" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.467em -0.477em); top: -1.912em; left: 50%; margin-left: -0.683em;"><span class="mrow" id="MathJax-Span-17128"><span class="mi" id="MathJax-Span-17129" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-17130" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-17131" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 1.486em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-17132" style="font-family: MathJax_Main; padding-left: 0.167em;">(</span><span class="mi" id="MathJax-Span-17133" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="msubsup" id="MathJax-Span-17134"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-17135" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.65em; left: 0.932em;"><span class="mi" id="MathJax-Span-17136" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-17137" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mfrac" id="MathJax-Span-17138" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.66em 1000em 2.459em -0.433em); top: -2.708em; left: 50%; margin-left: -0.191em;"><span class="mn" id="MathJax-Span-17139" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.764em 1000em 2.412em -0.477em); top: -1.896em; left: 50%; margin-left: -0.219em;"><span class="mi" id="MathJax-Span-17140" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 0.557em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-17141" style="font-family: MathJax_Main; padding-left: 0.167em;">(</span><span class="mi" id="MathJax-Span-17142" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mi" id="MathJax-Span-17143" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mo" id="MathJax-Span-17144" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-17145" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-17146" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mi" id="MathJax-Span-17147" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="msubsup" id="MathJax-Span-17148"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-17149" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-17150" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-17151" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.777em; vertical-align: -0.544em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1111">\frac{1}{n-1}(XX^T - \frac{1}{n}(Xe)(Xe)^T)</script></span>, 性能会有什么变化呢</strong>？ </p>
<p>  为了回答这个问题, 需要作一些实验, 为此, 将 <code>bilinear-pool</code> 这一层改成 <code>covariance</code> 层, 然后对比试验结果.</p>
</li></ul><ol>
<li><p><strong>相关公式 (<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1562-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25405" style="width: 1.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.874em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-25406"><span class="mi" id="MathJax-Span-25407" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1562">X</script></span> 的方差矩阵和梯度公式)</strong></p>
<ul>
<li><p><strong>Covariance</strong>:</p>
<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1563-Frame"><nobr><span class="math" id="MathJax-Span-25408" style="width: 35.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 29.235em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(-0.418em 1000em 4.289em -0.325em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-25409"><span class="mtable" id="MathJax-Span-25410" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 28.907em; height: 0px;"><span style="position: absolute; clip: rect(2.1em 1000em 5.723em -0.492em); top: -4.317em; left: 0em;"><span style="display: inline-block; position: relative; width: 14.426em; height: 0px;"><span style="position: absolute; clip: rect(1.613em 1000em 3.146em -0.442em); top: -3.829em; right: 0em;"><span class="mtd" id="MathJax-Span-25411"><span class="mrow" id="MathJax-Span-25412"><span class="mi" id="MathJax-Span-25413" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="mi" id="MathJax-Span-25414" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-25415" style="font-family: MathJax_Math; font-style: italic;">v</span><span class="mo" id="MathJax-Span-25416" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-25417" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-25418" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-25419" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-25420" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-25421" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-25422" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="msubsup" id="MathJax-Span-25423"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-25424" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.653em; left: 0.932em;"><span class="mi" id="MathJax-Span-25425" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-25426" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-25427" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-25428" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-25429" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-25430" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-25431" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-25432" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="msubsup" id="MathJax-Span-25433"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-25434" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-25435" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(3.825em 1000em 4.153em -0.492em); top: -2.747em; right: 0em;"><span class="mtd" id="MathJax-Span-25461"><span class="mrow" id="MathJax-Span-25462"></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.317em;"></span></span><span style="position: absolute; clip: rect(2.752em 1000em 7.459em -0.214em); top: -5.355em; left: 14.426em;"><span style="display: inline-block; position: relative; width: 14.481em; height: 0px;"><span style="position: absolute; clip: rect(1.226em 1000em 3.593em -0.214em); top: -3.829em; left: 0em;"><span class="mtd" id="MathJax-Span-25436"><span class="mrow" id="MathJax-Span-25437"><span class="mo" id="MathJax-Span-25438" style="font-family: MathJax_Main; padding-left: 0.222em; padding-right: 0.333em;">=</span><span class="mfrac" id="MathJax-Span-25439"><span style="display: inline-block; position: relative; width: 2.47em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.902em 1000em 2.896em -0.409em); top: -3.409em; left: 50%; margin-left: -0.273em;"><span class="mn" id="MathJax-Span-25440" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.902em 1000em 2.907em -0.471em); top: -2.046em; left: 50%; margin-left: -1.175em;"><span class="mrow" id="MathJax-Span-25441"><span class="mi" id="MathJax-Span-25442" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-25443" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mn" id="MathJax-Span-25444" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 2.47em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-25445" style="font-family: MathJax_Main; padding-left: 0.167em;">(</span><span class="mi" id="MathJax-Span-25446" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="msubsup" id="MathJax-Span-25447"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-25448" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.653em; left: 0.932em;"><span class="mi" id="MathJax-Span-25449" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-25450" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-25451" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">n</span><span class="mi" id="MathJax-Span-25452" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-25453" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-25454" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-25455" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mi" id="MathJax-Span-25456" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="msubsup" id="MathJax-Span-25457"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-25458" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-25459" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-25460" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.226em 1000em 3.593em -0.214em); top: -1.49em; left: 0em;"><span class="mtd" id="MathJax-Span-25463"><span class="mrow" id="MathJax-Span-25464"><span class="mo" id="MathJax-Span-25465" style="font-family: MathJax_Main; padding-left: 0.222em; padding-right: 0.333em;">=</span><span class="mfrac" id="MathJax-Span-25466"><span style="display: inline-block; position: relative; width: 2.47em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.902em 1000em 2.896em -0.409em); top: -3.409em; left: 50%; margin-left: -0.273em;"><span class="mn" id="MathJax-Span-25467" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.902em 1000em 2.907em -0.471em); top: -2.046em; left: 50%; margin-left: -1.175em;"><span class="mrow" id="MathJax-Span-25468"><span class="mi" id="MathJax-Span-25469" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-25470" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mn" id="MathJax-Span-25471" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 2.47em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-25472" style="font-family: MathJax_Main; padding-left: 0.167em;">(</span><span class="mi" id="MathJax-Span-25473" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="msubsup" id="MathJax-Span-25474"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-25475" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.653em; left: 0.932em;"><span class="mi" id="MathJax-Span-25476" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-25477" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mfrac" id="MathJax-Span-25478" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.721em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.902em 1000em 2.896em -0.409em); top: -3.409em; left: 50%; margin-left: -0.273em;"><span class="mn" id="MathJax-Span-25479" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.471em); top: -1.828em; left: 50%; margin-left: -0.301em;"><span class="mi" id="MathJax-Span-25480" style="font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 0.721em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-25481" style="font-family: MathJax_Main; padding-left: 0.167em;">(</span><span class="mi" id="MathJax-Span-25482" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mi" id="MathJax-Span-25483" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mo" id="MathJax-Span-25484" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-25485" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-25486" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mi" id="MathJax-Span-25487" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="msubsup" id="MathJax-Span-25488"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-25489" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-25490" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-25491" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.355em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 5.476em; vertical-align: -2.433em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-1563">
    \begin{align}
      Cov(X) = E(XX^T) - EX(EX)^T &= \frac{1}{n-1}(XX^T - nEX(EX)^T)\\
      &= \frac{1}{n-1}(XX^T - \frac{1}{n}(Xe)(Xe)^T)
    \end{align}</script><p></p></li><li><p><strong>Gradient</strong></p>
<p>  Assume <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1564-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25492" style="width: 8.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.94em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.613em 1000em 3.146em -0.462em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25493"><span class="mi" id="MathJax-Span-25494" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-25495" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-25496" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="mi" id="MathJax-Span-25497" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mi" id="MathJax-Span-25498" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mo" id="MathJax-Span-25499" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-25500" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-25501" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mi" id="MathJax-Span-25502" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="msubsup" id="MathJax-Span-25503"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-25504" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-25505" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.604em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1564">Y = (Xe)(Xe)^T</script></span> and <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1565-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25506" style="width: 4.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.88em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.457em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25507"><span class="mi" id="MathJax-Span-25508" style="font-family: MathJax_Math; font-style: italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-25509" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-25510" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-25511" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-25512" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-25513" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1565">z = f(Y)</script></span>,</p>
<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1566-Frame"><nobr><span class="math" id="MathJax-Span-25514" style="width: 15.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.787em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(-0.227em 1000em 4.098em -0.325em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-25515"><span class="mtable" id="MathJax-Span-25516" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 12.459em; height: 0px;"><span style="position: absolute; clip: rect(2.349em 1000em 6.307em -0.492em); top: -4.645em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.022em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.828em -0.446em); top: -3.962em; right: 0em;"><span class="mtd" id="MathJax-Span-25517"><span class="mrow" id="MathJax-Span-25518"><span class="msubsup" id="MathJax-Span-25519"><span style="display: inline-block; position: relative; width: 1.55em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-25520" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-25521" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-25522" style="font-family: MathJax_Math; font-style: italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(3.825em 1000em 4.153em -0.492em); top: -3.932em; right: 0em;"><span class="mtd" id="MathJax-Span-25536"><span class="mrow" id="MathJax-Span-25537"></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(3.825em 1000em 4.153em -0.492em); top: -2.49em; right: 0em;"><span class="mtd" id="MathJax-Span-25560"><span class="mrow" id="MathJax-Span-25561"></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.645em;"></span></span><span style="position: absolute; clip: rect(2.61em 1000em 6.885em -0.214em); top: -4.973em; left: 2.022em;"><span style="display: inline-block; position: relative; width: 10.437em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.214em); top: -4.181em; left: 0em;"><span class="mtd" id="MathJax-Span-25523"><span class="mrow" id="MathJax-Span-25524"><span class="mo" id="MathJax-Span-25525" style="font-family: MathJax_Main; padding-left: 0.222em; padding-right: 0.333em;">=</span><span class="mo" id="MathJax-Span-25526" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-25527"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-25528" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-25529" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-25530" style="font-family: MathJax_Math; font-style: italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-25531" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-25532"><span style="display: inline-block; position: relative; width: 1.55em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-25533" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-25534" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-25535" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.613em 1000em 3.146em -0.214em); top: -2.675em; left: 0em;"><span class="mtd" id="MathJax-Span-25538"><span class="mrow" id="MathJax-Span-25539"><span class="mo" id="MathJax-Span-25540" style="font-family: MathJax_Main; padding-left: 0.222em; padding-right: 0.333em;">=</span><span class="mo" id="MathJax-Span-25541" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-25542"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-25543" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-25544" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-25545" style="font-family: MathJax_Math; font-style: italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-25546" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-25547"><span style="display: inline-block; position: relative; width: 1.55em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-25548" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-25549" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-25550" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-25551" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mi" id="MathJax-Span-25552" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mo" id="MathJax-Span-25553" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-25554" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-25555" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mi" id="MathJax-Span-25556" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="msubsup" id="MathJax-Span-25557"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-25558" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-25559" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.677em 1000em 3.146em -0.214em); top: -1.234em; left: 0em;"><span class="mtd" id="MathJax-Span-25562"><span class="mrow" id="MathJax-Span-25563"><span class="mo" id="MathJax-Span-25564" style="font-family: MathJax_Main; padding-left: 0.222em; padding-right: 0.333em;">=</span><span class="mn" id="MathJax-Span-25565" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-25566" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-25567"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-25568" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-25569" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-25570" style="font-family: MathJax_Math; font-style: italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-25571" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-25572" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-25573" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-25574" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="msubsup" id="MathJax-Span-25575"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.453em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-25576" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.653em; left: 0.492em;"><span class="mi" id="MathJax-Span-25577" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-25578" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.973em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 5.01em; vertical-align: -2.2em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-1566">
  \begin{align}
      \nabla_X z &= (\nabla_Y z) \nabla_X Y\\
                 &= (\nabla_Y z) \nabla_X (Xe)(Xe)^T\\
                 &= 2(\nabla_Y z) X(ee^T)
  \end{align}</script><p></p><p>  Assume <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1567-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25579" style="width: 6.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.464em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.462em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25580"><span class="mi" id="MathJax-Span-25581" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-25582" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-25583" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="mi" id="MathJax-Span-25584" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-25585" style="font-family: MathJax_Math; font-style: italic;">v</span><span class="mo" id="MathJax-Span-25586" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-25587" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-25588" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1567">Y= Cov(X)</script></span> and <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1568-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25589" style="width: 4.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.88em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.457em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25590"><span class="mi" id="MathJax-Span-25591" style="font-family: MathJax_Math; font-style: italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-25592" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-25593" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-25594" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-25595" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-25596" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1568">z = f(Y)</script></span>, then</p>
<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1569-Frame"><nobr><span class="math" id="MathJax-Span-25597" style="width: 20.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.94em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.321em 1000em 5.048em -0.446em); top: -3.934em; left: 0em;"><span class="mrow" id="MathJax-Span-25598"><span class="msubsup" id="MathJax-Span-25599"><span style="display: inline-block; position: relative; width: 1.55em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-25600" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-25601" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-25602" style="font-family: MathJax_Math; font-style: italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-25603" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-25604" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 2.47em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.902em 1000em 2.896em -0.442em); top: -3.409em; left: 50%; margin-left: -0.273em;"><span class="mn" id="MathJax-Span-25605" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.902em 1000em 2.907em -0.471em); top: -2.046em; left: 50%; margin-left: -1.175em;"><span class="mrow" id="MathJax-Span-25606"><span class="mi" id="MathJax-Span-25607" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-25608" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mn" id="MathJax-Span-25609" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 2.47em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-25610" style="font-family: MathJax_Main; padding-left: 0.167em;">(</span><span class="msubsup" id="MathJax-Span-25611"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-25612" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-25613" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-25614" style="font-family: MathJax_Math; font-style: italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-25615" style="font-family: MathJax_Main;">)</span><span class="mrow" id="MathJax-Span-25616" style="padding-left: 0.167em;"><span class="mo" id="MathJax-Span-25617" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mi" id="MathJax-Span-25618" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-25619" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mfrac" id="MathJax-Span-25620" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.721em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.902em 1000em 2.896em -0.409em); top: -3.409em; left: 50%; margin-left: -0.273em;"><span class="mn" id="MathJax-Span-25621" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.471em); top: -1.828em; left: 50%; margin-left: -0.301em;"><span class="mi" id="MathJax-Span-25622" style="font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 0.721em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mi" id="MathJax-Span-25623" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-25624" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-25625" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="msubsup" id="MathJax-Span-25626"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.453em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-25627" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.653em; left: 0.492em;"><span class="mi" id="MathJax-Span-25628" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-25629" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-25630" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.934em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.06em; vertical-align: -1.225em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-1569">\nabla_Xz = \frac{2}{n-1}(\nabla_Yz)\left(X-\frac{1}{n}X(ee^T)\right)</script><p></p><p>  where <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1570-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25631" style="width: 4.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.77em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.779em 1000em 3.146em -0.453em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25632"><span class="mi" id="MathJax-Span-25633" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mo" id="MathJax-Span-25634" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="mo" id="MathJax-Span-25635" style="font-family: MathJax_Main; padding-left: 0.278em;">{</span><span class="mn" id="MathJax-Span-25636" style="font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-25637"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.427em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-25638" style="font-family: MathJax_Main;">}</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.546em;"><span class="mi" id="MathJax-Span-25639" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.402em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1570">e\in\{1\}^n</script></span>, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1571-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25640" style="width: 0.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.601em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-25641"><span class="mi" id="MathJax-Span-25642" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.686em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1571">n</script></span> is the number of columns of <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1572-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25643" style="width: 1.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.874em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-25644"><span class="mi" id="MathJax-Span-25645" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1572">X</script></span>.</p>
<p>  For the case of B-CNN, do it on <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1573-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25646" style="width: 1.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.53em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.133em 1000em 2.35em -0.466em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-25647"><span class="msubsup" id="MathJax-Span-25648"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-25649" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.65em; left: 0.932em;"><span class="mi" id="MathJax-Span-25650" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.218em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1573">X^T</script></span>.</p>
</li></ul>
</li><li><p><strong>应用 (<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1574-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25651" style="width: 1.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.874em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-25652"><span class="mi" id="MathJax-Span-25653" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1574">X</script></span> 的方差矩阵和梯度公式)</strong>.<br> 上面的公式是根据 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1575-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25654" style="width: 1.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.874em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-25655"><span class="mi" id="MathJax-Span-25656" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1575">X</script></span> 的方差所求的, 对于我们的图像分类任务, 由于 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1576-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25657" style="width: 1.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.874em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-25658"><span class="mi" id="MathJax-Span-25659" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1576">X</script></span> 的每一列是一个 <em>feature map</em>, 因此我们要求的是 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1577-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25660" style="width: 1.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.53em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.133em 1000em 2.35em -0.466em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-25661"><span class="msubsup" id="MathJax-Span-25662"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-25663" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.65em; left: 0.932em;"><span class="mi" id="MathJax-Span-25664" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.218em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1577">X^T</script></span> 的方差. 因此上面的公式需要进行修改, 令 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1578-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25665" style="width: 4.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.716em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.68em 1000em 2.896em -0.466em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25666"><span class="mi" id="MathJax-Span-25667" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-25668" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-25669" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-25670" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.65em; left: 0.932em;"><span class="mi" id="MathJax-Span-25671" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.218em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1578">X = X^T</script></span>, 上面的公式变为,</p>
<ul>
<li><p><strong>Covariance</strong>:</p>
<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1579-Frame"><nobr><span class="math" id="MathJax-Span-25672" style="width: 23.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.126em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.226em 1000em 3.593em -0.442em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25673"><span class="mi" id="MathJax-Span-25674" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="mi" id="MathJax-Span-25675" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-25676" style="font-family: MathJax_Math; font-style: italic;">v</span><span class="mo" id="MathJax-Span-25677" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-25678"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-25679" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.653em; left: 0.932em;"><span class="mi" id="MathJax-Span-25680" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-25681" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-25682" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-25683" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 2.47em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.902em 1000em 2.896em -0.409em); top: -3.409em; left: 50%; margin-left: -0.273em;"><span class="mn" id="MathJax-Span-25684" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.902em 1000em 2.907em -0.471em); top: -2.046em; left: 50%; margin-left: -1.175em;"><span class="mrow" id="MathJax-Span-25685"><span class="mi" id="MathJax-Span-25686" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-25687" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mn" id="MathJax-Span-25688" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 2.47em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-25689" style="font-family: MathJax_Main; padding-left: 0.167em;">(</span><span class="msubsup" id="MathJax-Span-25690"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-25691" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.653em; left: 0.932em;"><span class="mi" id="MathJax-Span-25692" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-25693" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-25694" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mfrac" id="MathJax-Span-25695" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.721em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.902em 1000em 2.896em -0.409em); top: -3.409em; left: 50%; margin-left: -0.273em;"><span class="mn" id="MathJax-Span-25696" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.471em); top: -1.828em; left: 50%; margin-left: -0.301em;"><span class="mi" id="MathJax-Span-25697" style="font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 0.721em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-25698" style="font-family: MathJax_Main; padding-left: 0.167em;">(</span><span class="msubsup" id="MathJax-Span-25699"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-25700" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.653em; left: 0.932em;"><span class="mi" id="MathJax-Span-25701" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-25702" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mo" id="MathJax-Span-25703" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-25704" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-25705"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.453em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-25706" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.653em; left: 0.492em;"><span class="mi" id="MathJax-Span-25707" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-25708" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-25709" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-25710" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.621em; vertical-align: -0.917em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-1579">
      Cov(X^T) = \frac{1}{n-1}(X^TX- \frac{1}{n}(X^Te)(e^TX))</script><p></p></li><li><p><strong>Gradient</strong></p>
<p>  Assume <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1580-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25711" style="width: 7.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.12em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.68em 1000em 3.146em -0.462em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25712"><span class="mi" id="MathJax-Span-25713" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-25714" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-25715" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="mi" id="MathJax-Span-25716" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-25717" style="font-family: MathJax_Math; font-style: italic;">v</span><span class="mo" id="MathJax-Span-25718" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-25719"><span style="display: inline-block; position: relative; width: 1.498em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-25720" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.65em; left: 0.932em;"><span class="mi" id="MathJax-Span-25721" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-25722" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.523em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1580">Y= Cov(X^T)</script></span> and <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1581-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25723" style="width: 4.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.88em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.457em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-25724"><span class="mi" id="MathJax-Span-25725" style="font-family: MathJax_Math; font-style: italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-25726" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-25727" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-25728" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-25729" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-25730" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1581">z = f(Y)</script></span>, then</p>
<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1582-Frame"><nobr><span class="math" id="MathJax-Span-25731" style="width: 21.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.76em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.321em 1000em 5.048em -0.446em); top: -3.934em; left: 0em;"><span class="mrow" id="MathJax-Span-25732"><span class="msubsup" id="MathJax-Span-25733"><span style="display: inline-block; position: relative; width: 1.55em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-25734" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-25735" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-25736" style="font-family: MathJax_Math; font-style: italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-25737" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-25738" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 2.47em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.902em 1000em 2.896em -0.442em); top: -3.409em; left: 50%; margin-left: -0.273em;"><span class="mn" id="MathJax-Span-25739" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.902em 1000em 2.907em -0.471em); top: -2.046em; left: 50%; margin-left: -1.175em;"><span class="mrow" id="MathJax-Span-25740"><span class="mi" id="MathJax-Span-25741" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-25742" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mn" id="MathJax-Span-25743" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 2.47em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mrow" id="MathJax-Span-25744" style="padding-left: 0.167em;"><span class="mo" id="MathJax-Span-25745" style="vertical-align: 0em; padding-left: 0.167em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mi" id="MathJax-Span-25746" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-25747" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mfrac" id="MathJax-Span-25748" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.721em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.902em 1000em 2.896em -0.409em); top: -3.409em; left: 50%; margin-left: -0.273em;"><span class="mn" id="MathJax-Span-25749" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.471em); top: -1.828em; left: 50%; margin-left: -0.301em;"><span class="mi" id="MathJax-Span-25750" style="font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 0.721em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-25751" style="font-family: MathJax_Main; padding-left: 0.167em;">(</span><span class="mi" id="MathJax-Span-25752" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="msubsup" id="MathJax-Span-25753"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.453em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-25754" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.653em; left: 0.492em;"><span class="mi" id="MathJax-Span-25755" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-25756" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-25757" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-25758" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span class="mo" id="MathJax-Span-25759" style="font-family: MathJax_Main; padding-left: 0.167em;">(</span><span class="msubsup" id="MathJax-Span-25760"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-25761" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-25762" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-25763" style="font-family: MathJax_Math; font-style: italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-25764"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-25765" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-25766" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.934em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.06em; vertical-align: -1.225em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-1582">
  \nabla_Xz = \frac{2}{n-1}\left(X-\frac{1}{n}(ee^T)X\right)(\nabla_Yz)^T</script><p></p><p>注意, 这里的 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1583-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25767" style="width: 0.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.492em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.453em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-25768"><span class="mi" id="MathJax-Span-25769" style="font-family: MathJax_Math; font-style: italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.686em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1583">e</script></span> 的维度等于 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1584-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25770" style="width: 1.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.874em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-25771"><span class="mi" id="MathJax-Span-25772" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1584">X</script></span> 的行数, 这与上面有所不同, 在那里, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1585-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25773" style="width: 0.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.492em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.453em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-25774"><span class="mi" id="MathJax-Span-25775" style="font-family: MathJax_Math; font-style: italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.686em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1585">e</script></span> 的维数等于 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1586-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-25776" style="width: 1.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.874em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-25777"><span class="mi" id="MathJax-Span-25778" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1586">X</script></span> 的列数.</p>
</li></ul>
</li><li><p><strong>编写 <code>vl_covariance</code> 层</strong>.</p>
<pre class="matlab hljs"><code class="matlab" data-origin="<pre><code class=&quot;matlab&quot;> function y = vl_covariance(X, varargin)
 % -------------------------------------------------------------------------------------------------------
 % VL_COVARIANCE implementes the revised bilinear model with a covariance
 % instead
 %
 % Copyright (C) 2016.12.25 Jincheng Su @Fudan Library, Zhang Jiang
 % All rights reserved.
 %
 % Input:
 %     X -- the a batch of feature map, with size [h, w, ch, bs]
 %     varargin{1} -- dzdy when in backpropagation
 % Output:
 %     y -- the covariance in forward pass or dzdx in backward pass
 %
 % -----------------------
 % The covariance model
 % -----------------------
 %
 % $
 %   \begin{align}
 %     Cov(X) = E(XX^T) - EX(EX)^T &amp;amp;= \frac{1}{n-1}(XX^T - nEX(EX)^T)\\
 %     &amp;amp;= \frac{1}{n-1}(XX^T - \frac{1}{n}(Xe)(Xe)^T)
 %   \end{align}
 % $
 % 
 % assume $Y = (Xe)(Xe)^T$ and $z = f(Y)$,
 % 
 % $
 % \begin{align}
 %     \nabla_X z &amp;amp;= (\nabla_Y z) \nabla_X Y\\
 %                &amp;amp;= (\nabla_Y z) \nabla_X (Xe)(Xe)^T\\
 %                &amp;amp;= 2(\nabla_Y z) X(ee^T)
 % \end{align}
 % $
 % 
 % assume $Y= Cov(X)$ and $z = f(Y)$, then
 % 
 % $\nabla_Xz = \frac{2}{n-1}(\nabla_Yz)\left(X-\frac{1}{n}X(ee^T)\right)$
 % 
 % where $e\in\{1\}^n$, $n$ is the number of columns of $X$.
 %
 % -------------------------------------------------------------------------------------------------------

 % flag for doing backward pass
 isBackward = numel(varargin) &amp;gt; 0 &amp;amp;&amp;amp; ~isstr(varargin{1});
 if isBackward
     dzdy = varargin{1};
 end

 % if GPU is used
 gpuMode = isa(X, 'gpuArray');

 % [height, widht, channels, batchsize]
 [h, w, ch, bs] = size(X);

 if ~isBackward
     % forward pass
     if gpuMode
         y = gpuArray(zeros([1, 1, ch * ch, bs], 'single'));
         e = gpuArray(ones([h*w, 1], 'single'));
     else
         y = zeros([1, 1, ch * ch, bs], 'single');
         e = ones([h*w, 1], 'single');
     end

     for b = 1: bs
         Xmat = reshape(X(:,:,:,b), [h * w, ch]);
         CovXt = (Xmat'*Xmat - (Xmat'*e)*(e'*Xmat)/ch)/(ch-1);  
         y(1, 1, :, b) = reshape(CovXt, [1, ch * ch]);% / (h1 * w1 ); %'
     end
 else
     % backward pass
     if gpuMode
         y = gpuArray(zeros(h, w, ch, bs, 'single')); 
         e = gpuArray(ones([h*w, 1], 'single'));
     else
         y = (zeros(h, w, ch, bs, 'single'));
         e = ones([h*w, 1], 'single');
     end

     for b = 1: bs
         dy = reshape(dzdy(1, 1, :, b), [ch, ch]);
         Xmat = reshape(X(:,:,:,b), [h * w, ch]);
         dzdx = 2 * (Xmat -  (e*e')* Xmat/ ch) * dy'/(ch-1);   
         clear Xmat dy
         y(:, :, :, b) = reshape(dzdx, [h, w, ch]);
     end

 end
</code></pre>"> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">y</span> = <span class="hljs-title">vl_covariance</span><span class="hljs-params">(X, varargin)</span></span>
 <span class="hljs-comment">% -------------------------------------------------------------------------------------------------------</span>
 <span class="hljs-comment">% VL_COVARIANCE implementes the revised bilinear model with a covariance</span>
 <span class="hljs-comment">% instead</span>
 <span class="hljs-comment">%</span>
 <span class="hljs-comment">% Copyright (C) 2016.12.25 Jincheng Su @Fudan Library, Zhang Jiang</span>
 <span class="hljs-comment">% All rights reserved.</span>
 <span class="hljs-comment">%</span>
 <span class="hljs-comment">% Input:</span>
 <span class="hljs-comment">%     X -- the a batch of feature map, with size [h, w, ch, bs]</span>
 <span class="hljs-comment">%     varargin{1} -- dzdy when in backpropagation</span>
 <span class="hljs-comment">% Output:</span>
 <span class="hljs-comment">%     y -- the covariance in forward pass or dzdx in backward pass</span>
 <span class="hljs-comment">%</span>
 <span class="hljs-comment">% -----------------------</span>
 <span class="hljs-comment">% The covariance model</span>
 <span class="hljs-comment">% -----------------------</span>
 <span class="hljs-comment">%</span>
 <span class="hljs-comment">% $</span>
 <span class="hljs-comment">%   \begin{align}</span>
 <span class="hljs-comment">%     Cov(X) = E(XX^T) - EX(EX)^T &amp;= \frac{1}{n-1}(XX^T - nEX(EX)^T)\\</span>
 <span class="hljs-comment">%     &amp;= \frac{1}{n-1}(XX^T - \frac{1}{n}(Xe)(Xe)^T)</span>
 <span class="hljs-comment">%   \end{align}</span>
 <span class="hljs-comment">% $</span>
 <span class="hljs-comment">% </span>
 <span class="hljs-comment">% assume $Y = (Xe)(Xe)^T$ and $z = f(Y)$,</span>
 <span class="hljs-comment">% </span>
 <span class="hljs-comment">% $</span>
 <span class="hljs-comment">% \begin{align}</span>
 <span class="hljs-comment">%     \nabla_X z &amp;= (\nabla_Y z) \nabla_X Y\\</span>
 <span class="hljs-comment">%                &amp;= (\nabla_Y z) \nabla_X (Xe)(Xe)^T\\</span>
 <span class="hljs-comment">%                &amp;= 2(\nabla_Y z) X(ee^T)</span>
 <span class="hljs-comment">% \end{align}</span>
 <span class="hljs-comment">% $</span>
 <span class="hljs-comment">% </span>
 <span class="hljs-comment">% assume $Y= Cov(X)$ and $z = f(Y)$, then</span>
 <span class="hljs-comment">% </span>
 <span class="hljs-comment">% $\nabla_Xz = \frac{2}{n-1}(\nabla_Yz)\left(X-\frac{1}{n}X(ee^T)\right)$</span>
 <span class="hljs-comment">% </span>
 <span class="hljs-comment">% where $e\in\{1\}^n$, $n$ is the number of columns of $X$.</span>
 <span class="hljs-comment">%</span>
 <span class="hljs-comment">% -------------------------------------------------------------------------------------------------------</span>

 <span class="hljs-comment">% flag for doing backward pass</span>
 isBackward = <span class="hljs-built_in">numel</span>(varargin) &gt; <span class="hljs-number">0</span> &amp;&amp; ~isstr(varargin<span class="hljs-cell">{<span class="hljs-number">1</span>}</span>);
 <span class="hljs-keyword">if</span> isBackward
     dzdy = varargin<span class="hljs-cell">{<span class="hljs-number">1</span>}</span>;
 <span class="hljs-keyword">end</span>

 <span class="hljs-comment">% if GPU is used</span>
 gpuMode = isa(X, <span class="hljs-string">'gpuArray'</span>);

 <span class="hljs-comment">% [height, widht, channels, batchsize]</span>
 <span class="hljs-matrix">[h, w, ch, bs]</span> = <span class="hljs-built_in">size</span>(X);

 <span class="hljs-keyword">if</span> ~isBackward
     <span class="hljs-comment">% forward pass</span>
     <span class="hljs-keyword">if</span> gpuMode
         y = gpuArray(<span class="hljs-built_in">zeros</span>(<span class="hljs-matrix">[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, ch * ch, bs]</span>, <span class="hljs-string">'single'</span>));
         e = gpuArray(<span class="hljs-built_in">ones</span>(<span class="hljs-matrix">[h*w, <span class="hljs-number">1</span>]</span>, <span class="hljs-string">'single'</span>));
     <span class="hljs-keyword">else</span>
         y = <span class="hljs-built_in">zeros</span>(<span class="hljs-matrix">[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, ch * ch, bs]</span>, <span class="hljs-string">'single'</span>);
         e = <span class="hljs-built_in">ones</span>(<span class="hljs-matrix">[h*w, <span class="hljs-number">1</span>]</span>, <span class="hljs-string">'single'</span>);
     <span class="hljs-keyword">end</span>

     <span class="hljs-keyword">for</span> b = <span class="hljs-number">1</span>: bs
         Xmat = <span class="hljs-built_in">reshape</span>(X(:,:,:,b), <span class="hljs-matrix">[h * w, ch]</span>);
         CovXt = (Xmat<span class="hljs-operator">'</span>*Xmat - (Xmat<span class="hljs-operator">'</span>*e)*(e<span class="hljs-operator">'</span>*Xmat)/ch)/(ch-<span class="hljs-number">1</span>);  
         y(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, :, b) = <span class="hljs-built_in">reshape</span>(CovXt, <span class="hljs-matrix">[<span class="hljs-number">1</span>, ch * ch]</span>);<span class="hljs-comment">% / (h1 * w1 ); %'</span>
     <span class="hljs-keyword">end</span>
 <span class="hljs-keyword">else</span>
     <span class="hljs-comment">% backward pass</span>
     <span class="hljs-keyword">if</span> gpuMode
         y = gpuArray(<span class="hljs-built_in">zeros</span>(h, w, ch, bs, <span class="hljs-string">'single'</span>)); 
         e = gpuArray(<span class="hljs-built_in">ones</span>(<span class="hljs-matrix">[h*w, <span class="hljs-number">1</span>]</span>, <span class="hljs-string">'single'</span>));
     <span class="hljs-keyword">else</span>
         y = (<span class="hljs-built_in">zeros</span>(h, w, ch, bs, <span class="hljs-string">'single'</span>));
         e = <span class="hljs-built_in">ones</span>(<span class="hljs-matrix">[h*w, <span class="hljs-number">1</span>]</span>, <span class="hljs-string">'single'</span>);
     <span class="hljs-keyword">end</span>

     <span class="hljs-keyword">for</span> b = <span class="hljs-number">1</span>: bs
         dy = <span class="hljs-built_in">reshape</span>(dzdy(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, :, b), <span class="hljs-matrix">[ch, ch]</span>);
         Xmat = <span class="hljs-built_in">reshape</span>(X(:,:,:,b), <span class="hljs-matrix">[h * w, ch]</span>);
         dzdx = <span class="hljs-number">2</span> * (Xmat -  (e*e<span class="hljs-operator">'</span>)* Xmat/ ch) * dy<span class="hljs-operator">'</span>/(ch-<span class="hljs-number">1</span>);   
         clear Xmat dy
         y(:, :, :, b) = <span class="hljs-built_in">reshape</span>(dzdx, <span class="hljs-matrix">[h, w, ch]</span>);
     <span class="hljs-keyword">end</span>

 <span class="hljs-keyword">end</span>
</code></pre>
</li><li><p>实验结果.</p>
<p> 初步实验结果表明, 文章中所谓的 Bilinear 背后更合理的数学意义可能是方差统计.</p>
</li></ol><h2 id="附录-7-bovw,-fisher-vector-和-vlad-简介"><a name="附录-7-bovw,-fisher-vector-和-vlad-简介" href="#附录-7-bovw,-fisher-vector-和-vlad-简介"></a>附录-7 BoVW, Fisher Vector 和 VLAD 简介</h2><h4 id="7.1-bovw-(bag-of-visual-word-[6])"><a name="7.1-bovw-(bag-of-visual-word-[6])" href="#7.1-bovw-(bag-of-visual-word-[6])"></a>7.1 BoVW (bag-of-visual-word [6])</h4><p><strong>术语</strong>:</p><ul>
<li>视字 (<em>visual word</em>)</li><li>关键点 (<em>keypoint</em>)</li><li>视字本 (<em>vocabulary of visual word</em>)</li><li>关键点包 (<em>bag of keypoints</em>)</li><li>矢量量化 (<em>vector quantization</em>)</li></ul><p><strong>主要想法</strong>:</p><p>BoVW 方法受文本分类启发而提出, 用于图像分类.</p><p>考虑简单的邮件二分类任务, 需要将一封邮件分类为垃圾 (spam) 或 非垃圾邮件. 一个方法是选取一个单词本 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1410-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-22759" style="width: 12.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.836em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.471em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-22760"><span class="mi" id="MathJax-Span-22761" style="font-family: MathJax_Math; font-style: italic;">v</span><span class="mo" id="MathJax-Span-22762" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-22763" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="msubsup" id="MathJax-Span-22764"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-22765" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="mn" id="MathJax-Span-22766" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-22767" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-22768" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22769" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22770" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22771" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-22772" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-22773" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.492em;"><span class="mi" id="MathJax-Span-22774" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-22775" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-22776" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22777" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22778" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22779" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-22780" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-22781" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.492em;"><span class="mi" id="MathJax-Span-22782" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-22783" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1410">v = (v_1, ..., v_i, ..., v_n)</script></span>, 其中 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1411-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-22784" style="width: 1.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.874em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.579em 1000em 2.508em -0.471em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-22785"><span class="msubsup" id="MathJax-Span-22786"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-22787" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.492em;"><span class="mi" id="MathJax-Span-22788" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.866em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1411">v_i</script></span> 表示不同的单词, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1412-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-22789" style="width: 0.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.601em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-22790"><span class="mi" id="MathJax-Span-22791" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.686em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1412">n</script></span> 是总单词数. 对于一封待分类的邮件, 统计单词本中的各个单词在该邮件中出现的次数, 得到一个统计量 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1413-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-22792" style="width: 12.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.219em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.457em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-22793"><span class="mi" id="MathJax-Span-22794" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-22795" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-22796" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="msubsup" id="MathJax-Span-22797"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-22798" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-22799" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-22800" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-22801" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22802" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22803" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22804" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-22805" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-22806" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-22807" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-22808" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-22809" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22810" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22811" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22812" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-22813" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-22814" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-22815" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-22816" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1413">x = (x_1, ..., x_i, ..., x_n)</script></span>, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1414-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-22817" style="width: 0.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.383em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.689em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-22818"><span class="mi" id="MathJax-Span-22819" style="font-family: MathJax_Math; font-style: italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.953em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1414">i</script></span>指代单词本中的单词 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1415-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-22820" style="width: 1.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.874em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.579em 1000em 2.508em -0.471em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-22821"><span class="msubsup" id="MathJax-Span-22822"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-22823" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.492em;"><span class="mi" id="MathJax-Span-22824" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.866em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1415">v_i</script></span>, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1416-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-22825" style="width: 1.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.58em 1000em 2.508em -0.457em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-22826"><span class="msubsup" id="MathJax-Span-22827"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-22828" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-22829" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.865em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1416">x_i</script></span> 表示了这个单词在邮件中出现的次数. 将这个统计量<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1417-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-22830" style="width: 0.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.601em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-22831"><span class="mi" id="MathJax-Span-22832" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.686em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1417">x</script></span>作为这封邮件的特征向量, 则可以训练一个多分类器对其进行分类. 用于文本分类的朴素贝叶斯方法就是这样做的.</p><p>将这种方法应用于图像分类首先要解决的问题是单词本里面的单词是什么， 如何选取一个合适的单词本. BoVW 方法的做法是, 从训练集中提取 SIFT 特征, 然后利用矢量量化 (vector quantization) 算法对这些特征进行聚类, 然后将聚类中心作为单词, 称为视字 (visual word) 或关键点 (keypoints), 所有聚类中心的组合即是单词本, 称为视字本 (vocabulary of visual word). 对于一个待分类图像, 首先从中提取 SIFT 特征, 然后将其分配到各个聚类中心即关键点上, 统计各个关键点分配到的 SIFT 特征数得到一个直方图, 称为关键点包 (bag of keypoints). 这个关键点包被作为这个图片的特征向量. 然后可以用一个训练好的多分类器对其进行分类.</p><p><strong>分类步骤</strong>:</p><ol>
<li>对于一张图片, 提取它的 SIFT 特征集, 记为 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1418-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-22833" style="width: 12.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.164em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.457em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-22834"><span class="mi" id="MathJax-Span-22835" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-22836" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-22837" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="msubsup" id="MathJax-Span-22838"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-22839" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-22840" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-22841" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-22842" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22843" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22844" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22845" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-22846" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-22847" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-22848" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-22849" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-22850" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22851" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22852" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22853" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-22854" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-22855" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-22856" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-22857" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1418">x = (x_1, ..., x_i, ..., x_s)</script></span>, 其中 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1419-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-22858" style="width: 5.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.098em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.687em 1000em 3.054em -0.457em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-22859"><span class="msubsup" id="MathJax-Span-22860"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-22861" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-22862" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-22863" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="msubsup" id="MathJax-Span-22864" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.699em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-22865" style="font-family: MathJax_Math; font-style: italic;">R</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.705em; left: 0.765em;"><span class="texatom" id="MathJax-Span-22866"><span class="mrow" id="MathJax-Span-22867"><span class="mn" id="MathJax-Span-22868" style="font-size: 70.7%; font-family: MathJax_Main;">128</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.401em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1419">x_i\in R^{128}</script></span> 是一个 SIFT 特征, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1420-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-22869" style="width: 0.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.492em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.688em -0.439em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-22870"><span class="mi" id="MathJax-Span-22871" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.685em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1420">s</script></span> 表示 SIFT 特征数.</li><li>把各个 SIFT 特征分配到预训练好的视字本中距离最近的条目上去. 该距离可以是欧拉距离, 该视字本通过矢量量化算法得到.</li><li>构造一个关键点包. 一个关键点包是一个统计视字本上各个视字分配到的 SIFT 特征数的直方图 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1421-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-22872" style="width: 11.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.617em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.452em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-22873"><span class="mi" id="MathJax-Span-22874" style="font-family: MathJax_Math; font-style: italic;">b</span><span class="mo" id="MathJax-Span-22875" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-22876" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="msubsup" id="MathJax-Span-22877"><span style="display: inline-block; position: relative; width: 0.895em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.452em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-22878" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.437em;"><span class="mn" id="MathJax-Span-22879" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-22880" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-22881" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22882" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22883" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22884" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-22885" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.785em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.452em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-22886" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.437em;"><span class="mi" id="MathJax-Span-22887" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-22888" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-22889" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22890" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22891" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22892" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-22893" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.452em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-22894" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.437em;"><span class="mi" id="MathJax-Span-22895" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-22896" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1421">b = (b_1, ..., b_i, ..., b_n)</script></span>, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1422-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-22897" style="width: 1.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.328em 1000em 2.508em -0.452em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-22898"><span class="msubsup" id="MathJax-Span-22899"><span style="display: inline-block; position: relative; width: 0.785em; height: 0px;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.452em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-22900" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.437em;"><span class="mi" id="MathJax-Span-22901" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.173em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1422">b_i</script></span> 表示被分配到视字上的 SIFT 特征数, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1423-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-22902" style="width: 0.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.601em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-22903"><span class="mi" id="MathJax-Span-22904" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.686em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1423">n</script></span> 表示视字本条目数.</li><li>将该关键点包作为特征向量, 应用多分类器 (朴素贝叶斯或者SVM) 进行分类.</li></ol><p>视字本的训练过程通常是首先从训练集的图片中提取 SIFT 特征, 然后将所有的 SIFT 特征利用 <em>k-means</em> 算法进行矢量量化得到 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1424-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-22905" style="width: 0.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.601em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-22906"><span class="mi" id="MathJax-Span-22907" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.686em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1424">n</script></span> 个聚类中心, 即为视字本 (vocabulary of visual word). 后来的文章将 <em>k-means</em> 硬聚类换成了如 <em>GMM</em> 等软聚类.</p><h4 id="7.2-fv-(fisher-vector-[12])"><a name="7.2-fv-(fisher-vector-[12])" href="#7.2-fv-(fisher-vector-[12])"></a>7.2 FV (Fisher Vector [12])</h4><h5 id="7.2.1-fisher-vector"><a name="7.2.1-fisher-vector" href="#7.2.1-fisher-vector"></a>7.2.1 Fisher Vector</h5><p>记 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1425-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-22908" style="width: 13.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.71em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.466em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-22909"><span class="mi" id="MathJax-Span-22910" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-22911" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-22912" style="font-family: MathJax_Main; padding-left: 0.278em;">{</span><span class="msubsup" id="MathJax-Span-22913"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-22914" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-22915" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-22916" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-22917" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22918" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22919" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22920" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-22921" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-22922" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-22923" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-22924" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-22925" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22926" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22927" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-22928" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-22929" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-22930" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-22931" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-22932" style="font-family: MathJax_Main;">}</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1425">X = \{x_1, ..., x_i, ..., x_n\}</script></span> 为从一张图片中提取的 n 个局部特征, 比如可以是 SIFT 特征. 假设这些特征相互独立, 虽然这个假设是不准确的, 特别是有些 SIFT 特征对应的原图像区域可能会有重叠. </p><p>设用 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1426-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-22933" style="width: 3.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.06em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.531em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-22934"><span class="mi" id="MathJax-Span-22935" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-22936" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-22937" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-22938" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-22939" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">θ</span><span class="mo" id="MathJax-Span-22940" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1426">p(X;\theta)</script></span> 对这些特征的概率密度函数进行建模, 其中 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1427-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-22941" style="width: 3.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.224em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.846em 1000em 2.936em -0.457em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-22942"><span class="mi" id="MathJax-Span-22943" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-22944" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="msubsup" id="MathJax-Span-22945" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.699em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-22946" style="font-family: MathJax_Math; font-style: italic;">R</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.65em; left: 0.765em;"><span class="mi" id="MathJax-Span-22947" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.064em; vertical-align: -0.115em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1427">\theta \in R^m</script></span> 是该函数的 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1428-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-22948" style="width: 1.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.929em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-22949"><span class="mi" id="MathJax-Span-22950" style="font-family: MathJax_Math; font-style: italic;">m</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.686em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1428">m</script></span> 个参数组成的向量.</p><ol>
<li><p><strong>评分函数 (score function)</strong> </p>
<p> 评分函数 (sc function) 即是对数似然函数对参数的梯度:</p>
<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1429-Frame"><nobr><span class="math" id="MathJax-Span-22951" style="width: 10.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.907em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.653em 1000em 3.15em -0.44em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-22952"><span class="msubsup" id="MathJax-Span-22953"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.7em -0.44em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-22954" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.473em); top: -2.672em; left: 0.715em;"><span class="mi" id="MathJax-Span-22955" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.993em; left: 0.624em;"><span class="texatom" id="MathJax-Span-22956"><span class="mrow" id="MathJax-Span-22957"><span class="mi" id="MathJax-Span-22958" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-22959" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-22960" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-22961" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.086em; left: 0.874em;"><span class="texatom" id="MathJax-Span-22962"><span class="mrow" id="MathJax-Span-22963"><span class="mi" id="MathJax-Span-22964" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-22965" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-22966" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-22967" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mtext" id="MathJax-Span-22968" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-22969" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-22970" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-22971" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-22972" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-22973" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">θ</span><span class="mo" id="MathJax-Span-22974" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-22975" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.56em; vertical-align: -0.377em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-1429">S_{\theta}^X = \nabla_{\theta}log~p(X;\theta).</script><p></p><p><span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1430-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-22976" style="width: 1.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.421em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.107em 1000em 2.604em -0.44em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-22977"><span class="msubsup" id="MathJax-Span-22978"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.7em -0.44em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-22979" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.473em); top: -2.672em; left: 0.715em;"><span class="mi" id="MathJax-Span-22980" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.993em; left: 0.624em;"><span class="texatom" id="MathJax-Span-22981"><span class="mrow" id="MathJax-Span-22982"><span class="mi" id="MathJax-Span-22983" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.56em; vertical-align: -0.377em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1430">S_{\theta}^X</script></span> 描述了如何对概率密度函数模型参数进行调整从而更好地拟合数据. 注意 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1431-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-22984" style="width: 5.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.153em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.653em 1000em 3.15em -0.44em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-22985"><span class="msubsup" id="MathJax-Span-22986"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.7em -0.44em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-22987" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.473em); top: -2.672em; left: 0.715em;"><span class="mi" id="MathJax-Span-22988" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.993em; left: 0.624em;"><span class="texatom" id="MathJax-Span-22989"><span class="mrow" id="MathJax-Span-22990"><span class="mi" id="MathJax-Span-22991" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-22992" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="msubsup" id="MathJax-Span-22993" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.699em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-22994" style="font-family: MathJax_Math; font-style: italic;">R</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.65em; left: 0.765em;"><span class="mi" id="MathJax-Span-22995" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.56em; vertical-align: -0.377em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1431">S_{\theta}^X \in R^m</script></span>, 其维度由模型参数个数决定.</p>
</li><li><p><strong>Fisher Information Matrix (FIM)</strong></p>
<p> Fisher Information Matrix (FIM) <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1432-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-22996" style="width: 6.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.519em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.811em 1000em 3.057em -0.492em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-22997"><span class="mtext" id="MathJax-Span-22998" style="font-family: MathJax_Main;">&nbsp;</span><span class="mtext" id="MathJax-Span-22999" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-23000"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(1.67em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23001" style="font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.086em; left: 0.659em;"><span class="texatom" id="MathJax-Span-23002"><span class="mrow" id="MathJax-Span-23003"><span class="mi" id="MathJax-Span-23004" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23005" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="msubsup" id="MathJax-Span-23006" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 2.643em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.699em -0.459em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23007" style="font-family: MathJax_Math; font-style: italic;">R</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.705em; left: 0.765em;"><span class="texatom" id="MathJax-Span-23008"><span class="mrow" id="MathJax-Span-23009"><span class="mi" id="MathJax-Span-23010" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span class="mo" id="MathJax-Span-23011" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-23012" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.254em; vertical-align: -0.263em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1432">~~F_{\theta} \in R^{m\times m}</script></span> 定义在评分函数之上:</p>
<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1433-Frame"><nobr><span class="math" id="MathJax-Span-23013" style="width: 14.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.53em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.613em 1000em 3.259em -0.461em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-23014"><span class="msubsup" id="MathJax-Span-23015"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(1.67em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23016" style="font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.086em; left: 0.659em;"><span class="texatom" id="MathJax-Span-23017"><span class="mrow" id="MathJax-Span-23018"><span class="mi" id="MathJax-Span-23019" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23020" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-23021" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 4.038em; height: 0px;"><span style="position: absolute; clip: rect(1.67em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23022" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.109em; left: 0.739em;"><span class="texatom" id="MathJax-Span-23023"><span class="mrow" id="MathJax-Span-23024"><span class="mi" id="MathJax-Span-23025" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mo" id="MathJax-Span-23026" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="mi" id="MathJax-Span-23027" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23028" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23029" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mo" id="MathJax-Span-23030" style="font-size: 70.7%; font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23031" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-23032" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-23033" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-23034"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.7em -0.44em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23035" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.473em); top: -2.672em; left: 0.715em;"><span class="mi" id="MathJax-Span-23036" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.993em; left: 0.624em;"><span class="texatom" id="MathJax-Span-23037"><span class="mrow" id="MathJax-Span-23038"><span class="mi" id="MathJax-Span-23039" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23040" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-23041"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.7em -0.44em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23042" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.473em); top: -2.672em; left: 0.715em;"><span class="mi" id="MathJax-Span-23043" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.993em; left: 0.624em;"><span class="texatom" id="MathJax-Span-23044"><span class="mrow" id="MathJax-Span-23045"><span class="mi" id="MathJax-Span-23046" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-23047"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-23048" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-23049" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23050" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-23051" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.742em; vertical-align: -0.509em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-1433">F_{\theta} = E_{X \sim p(X;\theta)}[S_{\theta}^X(S_{\theta}^X)^T].</script><p></p></li><li><p><strong>Fisher Kernel (FK)</strong></p>
<p> 于是可以用 Fisher Kernel (FK) 来衡量两个样本 Y 和 Z 之间的相似性:</p>
<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1434-Frame"><nobr><span class="math" id="MathJax-Span-23052" style="width: 16.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.115em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.613em 1000em 3.175em -0.461em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-23053"><span class="msubsup" id="MathJax-Span-23054"><span style="display: inline-block; position: relative; width: 2.112em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23055" style="font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.889em;"><span class="texatom" id="MathJax-Span-23056"><span class="mrow" id="MathJax-Span-23057"><span class="mi" id="MathJax-Span-23058" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.075em;"></span></span><span class="mi" id="MathJax-Span-23059" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23060" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23061" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-23062" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-23063" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-23064" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-23065" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-23066" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="msubsup" id="MathJax-Span-23067"><span style="display: inline-block; position: relative; width: 1.337em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.7em -0.44em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23068" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.471em); top: -2.672em; left: 0.715em;"><span class="mi" id="MathJax-Span-23069" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.993em; left: 0.624em;"><span class="texatom" id="MathJax-Span-23070"><span class="mrow" id="MathJax-Span-23071"><span class="mi" id="MathJax-Span-23072" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-23073"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-23074" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-23075" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-23076"><span style="display: inline-block; position: relative; width: 1.851em; height: 0px;"><span style="position: absolute; clip: rect(1.67em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23077" style="font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.459em -0.432em); top: -2.702em; left: 0.847em;"><span class="texatom" id="MathJax-Span-23078"><span class="mrow" id="MathJax-Span-23079"><span class="mo" id="MathJax-Span-23080" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-23081" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.969em; left: 0.659em;"><span class="texatom" id="MathJax-Span-23082"><span class="mrow" id="MathJax-Span-23083"><span class="mi" id="MathJax-Span-23084" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23085" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-23086"><span style="display: inline-block; position: relative; width: 1.337em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.7em -0.44em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23087" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.451em); top: -2.672em; left: 0.715em;"><span class="mi" id="MathJax-Span-23088" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.993em; left: 0.624em;"><span class="texatom" id="MathJax-Span-23089"><span class="mrow" id="MathJax-Span-23090"><span class="mi" id="MathJax-Span-23091" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23092" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-23093" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.639em; vertical-align: -0.407em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-1434">K_{FK}(Y, Z) = (S_{\theta}^Y)^TF_{\theta}^{-1}(S_{\theta}^Z).</script><p></p></li><li><p><strong>Fisher Vector (FV)</strong></p>
<p>由于 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1435-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-23094" style="width: 1.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.342em 1000em 2.511em -0.461em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-23095"><span class="msubsup" id="MathJax-Span-23096"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(1.67em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23097" style="font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.086em; left: 0.659em;"><span class="texatom" id="MathJax-Span-23098"><span class="mrow" id="MathJax-Span-23099"><span class="mi" id="MathJax-Span-23100" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.16em; vertical-align: -0.263em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1435">F_{\theta}</script></span> 是对称半正定矩阵, 它的逆矩阵也对称半正定. 于是可以对之应用 <em>Cholesky</em> 分解： <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1436-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-23101" style="width: 6.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.628em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.68em 1000em 3.175em -0.461em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-23102"><span class="msubsup" id="MathJax-Span-23103"><span style="display: inline-block; position: relative; width: 1.851em; height: 0px;"><span style="position: absolute; clip: rect(1.67em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23104" style="font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.459em -0.432em); top: -2.702em; left: 0.847em;"><span class="texatom" id="MathJax-Span-23105"><span class="mrow" id="MathJax-Span-23106"><span class="mo" id="MathJax-Span-23107" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-23108" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.969em; left: 0.659em;"><span class="texatom" id="MathJax-Span-23109"><span class="mrow" id="MathJax-Span-23110"><span class="mi" id="MathJax-Span-23111" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23112" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-23113" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.46em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23114" style="font-family: MathJax_Math; font-style: italic;">L</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.598em 1000em 2.404em -0.477em); top: -2.65em; left: 0.71em;"><span class="mi" id="MathJax-Span-23115" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.972em; left: 0.71em;"><span class="texatom" id="MathJax-Span-23116"><span class="mrow" id="MathJax-Span-23117"><span class="mi" id="MathJax-Span-23118" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-23119"><span style="display: inline-block; position: relative; width: 1.168em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.46em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23120" style="font-family: MathJax_Math; font-style: italic;">L</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.086em; left: 0.71em;"><span class="texatom" id="MathJax-Span-23121"><span class="mrow" id="MathJax-Span-23122"><span class="mi" id="MathJax-Span-23123" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.557em; vertical-align: -0.407em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1436">F_{\theta}^{-1} = L_{\theta}^TL_{\theta}</script></span>.</p>
<p>于是， <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1437-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-23124" style="width: 5.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.863em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.461em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-23125"><span class="msubsup" id="MathJax-Span-23126"><span style="display: inline-block; position: relative; width: 2.112em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23127" style="font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.889em;"><span class="texatom" id="MathJax-Span-23128"><span class="mrow" id="MathJax-Span-23129"><span class="mi" id="MathJax-Span-23130" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="mi" id="MathJax-Span-23131" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.075em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23132" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23133" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-23134" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-23135" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-23136" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1437">K_{KF}(Y,Z)</script></span> 可以重写成:</p>
<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1438-Frame"><nobr><span class="math" id="MathJax-Span-23137" style="width: 12.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.383em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.613em 1000em 3.151em -0.461em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-23138"><span class="msubsup" id="MathJax-Span-23139"><span style="display: inline-block; position: relative; width: 2.112em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23140" style="font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.889em;"><span class="texatom" id="MathJax-Span-23141"><span class="mrow" id="MathJax-Span-23142"><span class="mi" id="MathJax-Span-23143" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="mi" id="MathJax-Span-23144" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.075em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23145" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23146" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-23147" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-23148" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-23149" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-23150" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-23151" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="msubsup" id="MathJax-Span-23152"><span style="display: inline-block; position: relative; width: 1.274em; height: 0px;"><span style="position: absolute; clip: rect(1.7em 1000em 2.851em -0.448em); top: -2.568em; left: 0em;"><span class="texatom" id="MathJax-Span-23153"><span class="mrow" id="MathJax-Span-23154"><span class="mi" id="MathJax-Span-23155" style="font-family: MathJax_Caligraphic;">G<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.568em;"></span></span><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.471em); top: -2.671em; left: 0.652em;"><span class="mi" id="MathJax-Span-23156" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.993em; left: 0.597em;"><span class="texatom" id="MathJax-Span-23157"><span class="mrow" id="MathJax-Span-23158"><span class="mi" id="MathJax-Span-23159" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-23160"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-23161" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-23162" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-23163"><span style="display: inline-block; position: relative; width: 1.274em; height: 0px;"><span style="position: absolute; clip: rect(1.7em 1000em 2.851em -0.448em); top: -2.568em; left: 0em;"><span class="texatom" id="MathJax-Span-23164"><span class="mrow" id="MathJax-Span-23165"><span class="mi" id="MathJax-Span-23166" style="font-family: MathJax_Caligraphic;">G<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.568em;"></span></span><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.451em); top: -2.671em; left: 0.652em;"><span class="mi" id="MathJax-Span-23167" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.993em; left: 0.597em;"><span class="texatom" id="MathJax-Span-23168"><span class="mrow" id="MathJax-Span-23169"><span class="mi" id="MathJax-Span-23170" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23171" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.61em; vertical-align: -0.377em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-1438">K_{KF}(Y,Z) = (\mathcal{G}_{\theta}^Y)^T\mathcal{G}_{\theta}^Z.</script><p></p><p>其中,</p>
<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1439-Frame"><nobr><span class="math" id="MathJax-Span-23172" style="width: 17.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.934em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.653em 1000em 3.15em -0.448em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-23173"><span class="msubsup" id="MathJax-Span-23174"><span style="display: inline-block; position: relative; width: 1.274em; height: 0px;"><span style="position: absolute; clip: rect(1.7em 1000em 2.851em -0.448em); top: -2.568em; left: 0em;"><span class="texatom" id="MathJax-Span-23175"><span class="mrow" id="MathJax-Span-23176"><span class="mi" id="MathJax-Span-23177" style="font-family: MathJax_Caligraphic;">G<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.568em;"></span></span><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.471em); top: -2.671em; left: 0.652em;"><span class="mi" id="MathJax-Span-23178" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.993em; left: 0.597em;"><span class="texatom" id="MathJax-Span-23179"><span class="mrow" id="MathJax-Span-23180"><span class="mi" id="MathJax-Span-23181" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23182" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-23183" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.168em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.46em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23184" style="font-family: MathJax_Math; font-style: italic;">L</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.086em; left: 0.71em;"><span class="texatom" id="MathJax-Span-23185"><span class="mrow" id="MathJax-Span-23186"><span class="mi" id="MathJax-Span-23187" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-23188"><span style="display: inline-block; position: relative; width: 1.337em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.7em -0.44em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23189" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.471em); top: -2.672em; left: 0.715em;"><span class="mi" id="MathJax-Span-23190" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.993em; left: 0.624em;"><span class="texatom" id="MathJax-Span-23191"><span class="mrow" id="MathJax-Span-23192"><span class="mi" id="MathJax-Span-23193" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23194" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-23195" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.168em; height: 0px;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.46em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23196" style="font-family: MathJax_Math; font-style: italic;">L</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.086em; left: 0.71em;"><span class="texatom" id="MathJax-Span-23197"><span class="mrow" id="MathJax-Span-23198"><span class="mi" id="MathJax-Span-23199" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-23200"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-23201" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.086em; left: 0.874em;"><span class="texatom" id="MathJax-Span-23202"><span class="mrow" id="MathJax-Span-23203"><span class="mi" id="MathJax-Span-23204" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mtext" id="MathJax-Span-23205" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-23206" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-23207" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-23208" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mtext" id="MathJax-Span-23209" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-23210" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23211" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23212" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-23213" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23214" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">θ</span><span class="mo" id="MathJax-Span-23215" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-23216" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.56em; vertical-align: -0.377em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-1439">\mathcal{G}_{\theta}^Y = L_{\theta}S_{\theta}^Y = L_{\theta}\nabla_{\theta}~log~p(Y;\theta).</script><p></p><p>该标准化的梯度向量<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1440-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-23217" style="width: 1.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.311em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.108em 1000em 2.604em -0.448em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-23218"><span class="msubsup" id="MathJax-Span-23219"><span style="display: inline-block; position: relative; width: 1.274em; height: 0px;"><span style="position: absolute; clip: rect(1.7em 1000em 2.851em -0.448em); top: -2.568em; left: 0em;"><span class="texatom" id="MathJax-Span-23220"><span class="mrow" id="MathJax-Span-23221"><span class="mi" id="MathJax-Span-23222" style="font-family: MathJax_Caligraphic;">G<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.568em;"></span></span><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.471em); top: -2.671em; left: 0.652em;"><span class="mi" id="MathJax-Span-23223" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.993em; left: 0.597em;"><span class="texatom" id="MathJax-Span-23224"><span class="mrow" id="MathJax-Span-23225"><span class="mi" id="MathJax-Span-23226" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.559em; vertical-align: -0.377em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1440">\mathcal{G}_{\theta}^Y</script></span> 即是 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1441-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-23227" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.765em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.677em -0.462em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-23228"><span class="mi" id="MathJax-Span-23229" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.965em; vertical-align: -0.065em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1441">Y</script></span> 的 <strong>Fisher Vector</strong> (FV).</p>
</li></ol><h5 id="7.2.2-深入理解-fisher-information-matrix-(fim)"><a name="7.2.2-深入理解-fisher-information-matrix-(fim)" href="#7.2.2-深入理解-fisher-information-matrix-(fim)"></a>7.2.2 深入理解 Fisher Information Matrix (FIM)</h5><ol>
<li><p><strong>FIM 是评分函数的方差</strong></p>
<p> 我们看看评分函数的期望(以下推导需要一定的条件):</p>
<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1442-Frame"><nobr><span class="math" id="MathJax-Span-23230" style="width: 28.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.951em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(-2.387em 1000em 6.258em -0.325em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-23231"><span class="mtable" id="MathJax-Span-23232" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 22.623em; height: 0px;"><span style="position: absolute; clip: rect(3.858em 1000em 10.764em -0.492em); top: -7.596em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.732em; height: 0px;"><span style="position: absolute; clip: rect(1.653em 1000em 3.15em -0.461em); top: -5.391em; right: 0em;"><span class="mtd" id="MathJax-Span-23233"><span class="mrow" id="MathJax-Span-23234"><span class="mi" id="MathJax-Span-23235" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-23236" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-23237"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.7em -0.44em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23238" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.473em); top: -2.672em; left: 0.715em;"><span class="mi" id="MathJax-Span-23239" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.993em; left: 0.624em;"><span class="texatom" id="MathJax-Span-23240"><span class="mrow" id="MathJax-Span-23241"><span class="mi" id="MathJax-Span-23242" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23243" style="font-family: MathJax_Main;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(3.825em 1000em 4.153em -0.492em); top: -3.622em; right: 0em;"><span class="mtd" id="MathJax-Span-23292"><span class="mrow" id="MathJax-Span-23293"></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(3.825em 1000em 4.153em -0.492em); top: -0.985em; right: 0em;"><span class="mtd" id="MathJax-Span-23349"><span class="mrow" id="MathJax-Span-23350"></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.596em;"></span></span><span style="position: absolute; clip: rect(4.772em 1000em 13.417em -0.214em); top: -9.344em; left: 2.732em;"><span style="display: inline-block; position: relative; width: 19.891em; height: 0px;"><span style="position: absolute; clip: rect(2.677em 1000em 6.004em -0.214em); top: -7.249em; left: 0em;"><span class="mtd" id="MathJax-Span-23244"><span class="mrow" id="MathJax-Span-23245"><span class="mo" id="MathJax-Span-23246" style="font-family: MathJax_Main; padding-left: 0.222em; padding-right: 0.333em;">=</span><span class="mi" id="MathJax-Span-23247" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-23248" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-23249"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-23250" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.086em; left: 0.874em;"><span class="texatom" id="MathJax-Span-23251"><span class="mrow" id="MathJax-Span-23252"><span class="mi" id="MathJax-Span-23253" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mtext" id="MathJax-Span-23254" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-23255" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-23256" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-23257" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mtext" id="MathJax-Span-23258" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-23259" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23260" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23261" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-23262" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23263" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">θ</span><span class="mo" id="MathJax-Span-23264" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-23265" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-23266" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-23267" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mrow" id="MathJax-Span-23268" style="padding-left: 0.167em;"><span class="mo" id="MathJax-Span-23269" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mfrac" id="MathJax-Span-23270"><span style="display: inline-block; position: relative; width: 4.765em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.446em); top: -3.459em; left: 50%; margin-left: -2.322em;"><span class="mrow" id="MathJax-Span-23271"><span class="msubsup" id="MathJax-Span-23272"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-23273" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.086em; left: 0.874em;"><span class="texatom" id="MathJax-Span-23274"><span class="mrow" id="MathJax-Span-23275"><span class="mi" id="MathJax-Span-23276" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mtext" id="MathJax-Span-23277" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-23278" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23279" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23280" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-23281" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23282" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">θ</span><span class="mo" id="MathJax-Span-23283" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.531em); top: -2.006em; left: 50%; margin-left: -1.53em;"><span class="mrow" id="MathJax-Span-23284"><span class="mi" id="MathJax-Span-23285" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23286" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23287" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-23288" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23289" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">θ</span><span class="mo" id="MathJax-Span-23290" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 4.765em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-23291" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.59em;"></span></span><span style="position: absolute; clip: rect(1.092em 1000em 3.873em -0.214em); top: -2.365em; left: 0em;"><span class="mtd" id="MathJax-Span-23294"><span class="mrow" id="MathJax-Span-23295"><span class="mo" id="MathJax-Span-23296" style="font-family: MathJax_Main; padding-left: 0.222em; padding-right: 0.333em;">=</span><span class="msubsup" id="MathJax-Span-23297"><span style="display: inline-block; position: relative; width: 1.108em; height: 0px;"><span style="position: absolute; clip: rect(2.191em 1000em 4.741em -0.437em); top: -3.716em; left: 0em;"><span class="mo" id="MathJax-Span-23298" style="font-family: MathJax_Size2; vertical-align: 0.001em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.388em;"></span></span><span style="display: inline-block; width: 0px; height: 3.716em;"></span></span><span style="position: absolute; top: -1.344em; left: 0.596em;"><span class="mi" id="MathJax-Span-23299" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-23300" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 4.492em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.446em); top: -3.459em; left: 50%; margin-left: -2.186em;"><span class="mrow" id="MathJax-Span-23301"><span class="msubsup" id="MathJax-Span-23302"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-23303" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.086em; left: 0.874em;"><span class="texatom" id="MathJax-Span-23304"><span class="mrow" id="MathJax-Span-23305"><span class="mi" id="MathJax-Span-23306" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mtext" id="MathJax-Span-23307" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-23308" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23309" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23310" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-23311" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23312" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">θ</span><span class="mo" id="MathJax-Span-23313" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.531em); top: -2.006em; left: 50%; margin-left: -1.393em;"><span class="mrow" id="MathJax-Span-23314"><span class="mi" id="MathJax-Span-23315" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23316" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23317" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-23318" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23319" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">θ</span><span class="mo" id="MathJax-Span-23320" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 4.492em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mi" id="MathJax-Span-23321" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">p</span><span class="mo" id="MathJax-Span-23322" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23323" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-23324" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23325" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">θ</span><span class="mo" id="MathJax-Span-23326" style="font-family: MathJax_Main;">)</span><span class="mtext" id="MathJax-Span-23327" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-23328" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-23329" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-23330" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-23331" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.108em; height: 0px;"><span style="position: absolute; clip: rect(2.191em 1000em 4.741em -0.437em); top: -3.716em; left: 0em;"><span class="mo" id="MathJax-Span-23332" style="font-family: MathJax_Size2; vertical-align: 0.001em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.388em;"></span></span><span style="display: inline-block; width: 0px; height: 3.716em;"></span></span><span style="position: absolute; top: -1.344em; left: 0.596em;"><span class="mi" id="MathJax-Span-23333" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-23334" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-23335" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.086em; left: 0.874em;"><span class="texatom" id="MathJax-Span-23336"><span class="mrow" id="MathJax-Span-23337"><span class="mi" id="MathJax-Span-23338" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mtext" id="MathJax-Span-23339" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-23340" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23341" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23342" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-23343" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23344" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">θ</span><span class="mo" id="MathJax-Span-23345" style="font-family: MathJax_Main;">)</span><span class="mtext" id="MathJax-Span-23346" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-23347" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-23348" style="font-family: MathJax_Math; font-style: italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.207em 1000em 3.8em -0.214em); top: 0.272em; left: 0em;"><span class="mtd" id="MathJax-Span-23351"><span class="mrow" id="MathJax-Span-23352"><span class="mo" id="MathJax-Span-23353" style="font-family: MathJax_Main; padding-left: 0.222em; padding-right: 0.333em;">=</span><span class="msubsup" id="MathJax-Span-23354"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-23355" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.086em; left: 0.874em;"><span class="texatom" id="MathJax-Span-23356"><span class="mrow" id="MathJax-Span-23357"><span class="mi" id="MathJax-Span-23358" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-23359" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.108em; height: 0px;"><span style="position: absolute; clip: rect(2.191em 1000em 4.741em -0.437em); top: -3.716em; left: 0em;"><span class="mo" id="MathJax-Span-23360" style="font-family: MathJax_Size2; vertical-align: 0.001em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.388em;"></span></span><span style="display: inline-block; width: 0px; height: 3.716em;"></span></span><span style="position: absolute; top: -1.344em; left: 0.596em;"><span class="mi" id="MathJax-Span-23361" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-23362" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">p</span><span class="mo" id="MathJax-Span-23363" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23364" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-23365" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23366" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">θ</span><span class="mo" id="MathJax-Span-23367" style="font-family: MathJax_Main;">)</span><span class="mtext" id="MathJax-Span-23368" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-23369" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-23370" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-23371" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-23372" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-23373" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.086em; left: 0.874em;"><span class="texatom" id="MathJax-Span-23374"><span class="mrow" id="MathJax-Span-23375"><span class="mi" id="MathJax-Span-23376" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mtext" id="MathJax-Span-23377" style="font-family: MathJax_Main;">&nbsp;</span><span class="mn" id="MathJax-Span-23378" style="font-family: MathJax_Main;">1</span><span class="mtext" id="MathJax-Span-23379" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-23380" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-23381" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-23382" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-23383" style="font-family: MathJax_Main; padding-left: 0.278em;">0.</span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="display: inline-block; width: 0px; height: 9.344em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 10.281em; vertical-align: -4.835em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-1442">
 \begin{align}
 E[S_{\theta}^X] &= E[\nabla_{\theta}~log~p(X;\theta)] = E\left[\frac{\nabla_{\theta}~p(X;\theta)}{p(X;\theta)}\right]\\
                 &= \int_x\frac{\nabla_{\theta}~p(x;\theta)}{p(x;\theta)}p(x;\theta)~dx = \int_x\nabla_{\theta}~p(x;\theta)~dx\\
                 &= \nabla_{\theta}\int_x p(x;\theta)~dx = \nabla_{\theta}~1~dx = 0.

 \end{align}</script><p></p><p> 因此有,</p>
<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1443-Frame"><nobr><span class="math" id="MathJax-Span-23384" style="width: 26.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.022em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.613em 1000em 3.15em -0.461em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-23385"><span class="mi" id="MathJax-Span-23386" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-23387" style="font-family: MathJax_Main;">[</span><span class="mo" id="MathJax-Span-23388" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-23389"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.7em -0.44em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23390" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.473em); top: -2.672em; left: 0.715em;"><span class="mi" id="MathJax-Span-23391" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.993em; left: 0.624em;"><span class="texatom" id="MathJax-Span-23392"><span class="mrow" id="MathJax-Span-23393"><span class="mi" id="MathJax-Span-23394" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23395" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-23396" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-23397"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.7em -0.44em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23398" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.473em); top: -2.672em; left: 0.715em;"><span class="mi" id="MathJax-Span-23399" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.993em; left: 0.624em;"><span class="texatom" id="MathJax-Span-23400"><span class="mrow" id="MathJax-Span-23401"><span class="mi" id="MathJax-Span-23402" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-23403"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-23404" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-23405" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23406" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-23407" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-23408" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-23409" style="font-family: MathJax_Main;">[</span><span class="mo" id="MathJax-Span-23410" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-23411"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.7em -0.44em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23412" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.473em); top: -2.672em; left: 0.715em;"><span class="mi" id="MathJax-Span-23413" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.993em; left: 0.624em;"><span class="texatom" id="MathJax-Span-23414"><span class="mrow" id="MathJax-Span-23415"><span class="mi" id="MathJax-Span-23416" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23417" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-23418" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-23419" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-23420"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.7em -0.44em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23421" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.473em); top: -2.672em; left: 0.715em;"><span class="mi" id="MathJax-Span-23422" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.993em; left: 0.624em;"><span class="texatom" id="MathJax-Span-23423"><span class="mrow" id="MathJax-Span-23424"><span class="mi" id="MathJax-Span-23425" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23426" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-23427" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-23428" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-23429"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.7em -0.44em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23430" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.473em); top: -2.672em; left: 0.715em;"><span class="mi" id="MathJax-Span-23431" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.993em; left: 0.624em;"><span class="texatom" id="MathJax-Span-23432"><span class="mrow" id="MathJax-Span-23433"><span class="mi" id="MathJax-Span-23434" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23435" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-23436" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-23437" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-23438"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.7em -0.44em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23439" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.473em); top: -2.672em; left: 0.715em;"><span class="mi" id="MathJax-Span-23440" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.993em; left: 0.624em;"><span class="texatom" id="MathJax-Span-23441"><span class="mrow" id="MathJax-Span-23442"><span class="mi" id="MathJax-Span-23443" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23444" style="font-family: MathJax_Main;">]</span><span class="msubsup" id="MathJax-Span-23445"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-23446" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-23447" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23448" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-23449" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.61em; vertical-align: -0.377em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-1443">
 E[(S_{\theta}^X)(S_{\theta}^X)^T] = E[(S_{\theta}^X - E[S_{\theta}^X])(S_{\theta}^X - E[S_{\theta}^X])^T].</script><p></p><p> 可见 <strong>FIM 即是评分函数的方差</strong>. 注意 FIM 并非某次观察结果的函数, 而是其期望. 评分函数的绝对值越大, 方差越大, 于是 FIM 携带的信息就越多.</p>
</li><li><p><strong>FIM 是评分函数的一阶导的负期望, 是对数似然函数二阶导的负期望</strong></p>
<p> 从另一方面看, 由于</p>
<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1444-Frame"><nobr><span class="math" id="MathJax-Span-23450" style="width: 30.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 24.754em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(-2.935em 1000em 6.806em -0.325em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-23451"><span class="mtable" id="MathJax-Span-23452" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 24.417em; height: 0px;"><span style="position: absolute; clip: rect(4.293em 1000em 12.223em -0.492em); top: -8.579em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.723em; height: 0px;"><span style="position: absolute; clip: rect(2.91em 1000em 4.407em -0.446em); top: -7.196em; right: 0em;"><span class="mtd" id="MathJax-Span-23453"><span class="mrow" id="MathJax-Span-23454"><span class="msubsup" id="MathJax-Span-23455"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-23456" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.086em; left: 0.874em;"><span class="texatom" id="MathJax-Span-23457"><span class="mrow" id="MathJax-Span-23458"><span class="mi" id="MathJax-Span-23459" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-23460"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.7em -0.44em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23461" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.473em); top: -2.672em; left: 0.715em;"><span class="mi" id="MathJax-Span-23462" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.993em; left: 0.624em;"><span class="texatom" id="MathJax-Span-23463"><span class="mrow" id="MathJax-Span-23464"><span class="mi" id="MathJax-Span-23465" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(3.825em 1000em 4.153em -0.492em); top: -3.692em; right: 0em;"><span class="mtd" id="MathJax-Span-23516"><span class="mrow" id="MathJax-Span-23517"></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(3.825em 1000em 4.153em -0.492em); top: -0.509em; right: 0em;"><span class="mtd" id="MathJax-Span-23594"><span class="mrow" id="MathJax-Span-23595"></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span><span style="display: inline-block; width: 0px; height: 8.579em;"></span></span><span style="position: absolute; clip: rect(5.317em 1000em 15.058em -0.214em); top: -10.437em; left: 2.723em;"><span style="display: inline-block; position: relative; width: 21.694em; height: 0px;"><span style="position: absolute; clip: rect(2.677em 1000em 6.004em -0.214em); top: -7.797em; left: 0em;"><span class="mtd" id="MathJax-Span-23466"><span class="mrow" id="MathJax-Span-23467"><span class="mo" id="MathJax-Span-23468" style="font-family: MathJax_Main; padding-left: 0.222em; padding-right: 0.333em;">=</span><span class="msubsup" id="MathJax-Span-23469"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-23470" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.459em -0.456em); top: -2.705em; left: 0.874em;"><span class="mn" id="MathJax-Span-23471" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.972em; left: 0.874em;"><span class="texatom" id="MathJax-Span-23472"><span class="mrow" id="MathJax-Span-23473"><span class="mi" id="MathJax-Span-23474" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mtext" id="MathJax-Span-23475" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-23476" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-23477" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-23478" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mtext" id="MathJax-Span-23479" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-23480" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23481" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23482" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-23483" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23484" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">θ</span><span class="mo" id="MathJax-Span-23485" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-23486" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-23487" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-23488" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.086em; left: 0.874em;"><span class="texatom" id="MathJax-Span-23489"><span class="mrow" id="MathJax-Span-23490"><span class="mi" id="MathJax-Span-23491" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mrow" id="MathJax-Span-23492" style="padding-left: 0.167em;"><span class="mo" id="MathJax-Span-23493" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">(</span></span><span class="mfrac" id="MathJax-Span-23494"><span style="display: inline-block; position: relative; width: 4.765em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.446em); top: -3.459em; left: 50%; margin-left: -2.322em;"><span class="mrow" id="MathJax-Span-23495"><span class="msubsup" id="MathJax-Span-23496"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-23497" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.086em; left: 0.874em;"><span class="texatom" id="MathJax-Span-23498"><span class="mrow" id="MathJax-Span-23499"><span class="mi" id="MathJax-Span-23500" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mtext" id="MathJax-Span-23501" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-23502" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23503" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23504" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-23505" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23506" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">θ</span><span class="mo" id="MathJax-Span-23507" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.531em); top: -2.006em; left: 50%; margin-left: -1.53em;"><span class="mrow" id="MathJax-Span-23508"><span class="mi" id="MathJax-Span-23509" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23510" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23511" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-23512" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23513" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">θ</span><span class="mo" id="MathJax-Span-23514" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 4.765em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-23515" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.59em;"></span></span><span style="position: absolute; clip: rect(2.471em 1000em 6.004em -0.214em); top: -4.293em; left: 0em;"><span class="mtd" id="MathJax-Span-23518"><span class="mrow" id="MathJax-Span-23519"><span class="mo" id="MathJax-Span-23520" style="font-family: MathJax_Main; padding-left: 0.222em; padding-right: 0.333em;">=</span><span class="mfrac" id="MathJax-Span-23521"><span style="display: inline-block; position: relative; width: 4.765em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.687em 1000em 3.172em -0.446em); top: -3.484em; left: 50%; margin-left: -2.322em;"><span class="mrow" id="MathJax-Span-23522"><span class="msubsup" id="MathJax-Span-23523"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-23524" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.459em -0.456em); top: -2.705em; left: 0.874em;"><span class="mn" id="MathJax-Span-23525" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.972em; left: 0.874em;"><span class="texatom" id="MathJax-Span-23526"><span class="mrow" id="MathJax-Span-23527"><span class="mi" id="MathJax-Span-23528" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mtext" id="MathJax-Span-23529" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-23530" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23531" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23532" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-23533" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23534" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">θ</span><span class="mo" id="MathJax-Span-23535" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.531em); top: -2.006em; left: 50%; margin-left: -1.53em;"><span class="mrow" id="MathJax-Span-23536"><span class="mi" id="MathJax-Span-23537" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23538" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23539" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-23540" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23541" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">θ</span><span class="mo" id="MathJax-Span-23542" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 4.765em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-23543" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mrow" id="MathJax-Span-23544" style="padding-left: 0.222em;"><span class="mo" id="MathJax-Span-23545" style="vertical-align: 0em; padding-left: 0.222em;"><span style="font-family: MathJax_Size4;">(</span></span><span class="mfrac" id="MathJax-Span-23546"><span style="display: inline-block; position: relative; width: 4.765em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.446em); top: -3.459em; left: 50%; margin-left: -2.322em;"><span class="mrow" id="MathJax-Span-23547"><span class="msubsup" id="MathJax-Span-23548"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-23549" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.086em; left: 0.874em;"><span class="texatom" id="MathJax-Span-23550"><span class="mrow" id="MathJax-Span-23551"><span class="mi" id="MathJax-Span-23552" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mtext" id="MathJax-Span-23553" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-23554" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23555" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23556" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-23557" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23558" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">θ</span><span class="mo" id="MathJax-Span-23559" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.531em); top: -2.006em; left: 50%; margin-left: -1.53em;"><span class="mrow" id="MathJax-Span-23560"><span class="mi" id="MathJax-Span-23561" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23562" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23563" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-23564" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23565" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">θ</span><span class="mo" id="MathJax-Span-23566" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 4.765em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-23567" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">)</span></span></span><span class="msubsup" id="MathJax-Span-23568" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 7.179em; height: 0px;"><span style="position: absolute; clip: rect(2.677em 1000em 6.004em -0.255em); top: -4.59em; left: 0em;"><span class="mrow" id="MathJax-Span-23569"><span class="mo" id="MathJax-Span-23570" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">(</span></span><span class="mfrac" id="MathJax-Span-23571"><span style="display: inline-block; position: relative; width: 4.765em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.446em); top: -3.459em; left: 50%; margin-left: -2.322em;"><span class="mrow" id="MathJax-Span-23572"><span class="msubsup" id="MathJax-Span-23573"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-23574" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.086em; left: 0.874em;"><span class="texatom" id="MathJax-Span-23575"><span class="mrow" id="MathJax-Span-23576"><span class="mi" id="MathJax-Span-23577" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mtext" id="MathJax-Span-23578" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-23579" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23580" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23581" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-23582" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23583" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">θ</span><span class="mo" id="MathJax-Span-23584" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.531em); top: -2.006em; left: 50%; margin-left: -1.53em;"><span class="mrow" id="MathJax-Span-23585"><span class="mi" id="MathJax-Span-23586" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23587" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23588" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-23589" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23590" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">θ</span><span class="mo" id="MathJax-Span-23591" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 4.765em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-23592" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.59em;"></span></span><span style="position: absolute; top: -3.717em; left: 6.612em;"><span class="mi" id="MathJax-Span-23593" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.59em;"></span></span><span style="position: absolute; clip: rect(1.973em 1000em 4.911em -0.214em); top: -0.29em; left: 0em;"><span class="mtd" id="MathJax-Span-23596"><span class="mrow" id="MathJax-Span-23597"><span class="mo" id="MathJax-Span-23598" style="font-family: MathJax_Main; padding-left: 0.222em; padding-right: 0.333em;">=</span><span class="mfrac" id="MathJax-Span-23599"><span style="display: inline-block; position: relative; width: 4.765em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.687em 1000em 3.172em -0.446em); top: -3.484em; left: 50%; margin-left: -2.322em;"><span class="mrow" id="MathJax-Span-23600"><span class="msubsup" id="MathJax-Span-23601"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-23602" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.459em -0.456em); top: -2.705em; left: 0.874em;"><span class="mn" id="MathJax-Span-23603" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.972em; left: 0.874em;"><span class="texatom" id="MathJax-Span-23604"><span class="mrow" id="MathJax-Span-23605"><span class="mi" id="MathJax-Span-23606" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mtext" id="MathJax-Span-23607" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-23608" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23609" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23610" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-23611" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23612" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">θ</span><span class="mo" id="MathJax-Span-23613" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.531em); top: -2.006em; left: 50%; margin-left: -1.53em;"><span class="mrow" id="MathJax-Span-23614"><span class="mi" id="MathJax-Span-23615" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23616" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23617" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-23618" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23619" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">θ</span><span class="mo" id="MathJax-Span-23620" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 4.765em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-23621" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mrow" id="MathJax-Span-23622" style="padding-left: 0.222em;"><span class="mo" id="MathJax-Span-23623" style="vertical-align: 0em; padding-left: 0.222em;"><span style="font-family: MathJax_Size2;">(</span></span><span class="msubsup" id="MathJax-Span-23624"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.7em -0.44em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23625" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.473em); top: -2.672em; left: 0.715em;"><span class="mi" id="MathJax-Span-23626" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.993em; left: 0.624em;"><span class="texatom" id="MathJax-Span-23627"><span class="mrow" id="MathJax-Span-23628"><span class="mi" id="MathJax-Span-23629" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23630" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span><span class="msubsup" id="MathJax-Span-23631" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 3.19em; height: 0px;"><span style="position: absolute; clip: rect(2.457em 1000em 4.584em -0.312em); top: -3.77em; left: 0em;"><span class="mrow" id="MathJax-Span-23632"><span class="mo" id="MathJax-Span-23633" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span><span class="msubsup" id="MathJax-Span-23634"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.7em -0.44em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23635" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.473em); top: -2.672em; left: 0.715em;"><span class="mi" id="MathJax-Span-23636" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.993em; left: 0.624em;"><span class="texatom" id="MathJax-Span-23637"><span class="mrow" id="MathJax-Span-23638"><span class="mi" id="MathJax-Span-23639" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23640" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.77em;"></span></span><span style="position: absolute; top: -3.117em; left: 2.623em;"><span class="mi" id="MathJax-Span-23641" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.77em;"></span></span></span><span style="display: inline-block; width: 0px; height: 10.437em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 11.618em; vertical-align: -5.504em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-1444">
 \begin{align}
 \nabla_{\theta}S_{\theta}^X &= \nabla_{\theta}^2~log~p(X;\theta) = \nabla_{\theta}\left(\frac{\nabla_{\theta}~p(X;\theta)}{p(X;\theta)}\right)\\
  &= \frac{\nabla_{\theta}^2~p(X;\theta)}{p(X;\theta)} - \left(\frac{\nabla_{\theta}~p(X;\theta)}{p(X;\theta)} \right)\left(\frac{\nabla_{\theta}~p(X;\theta)}{p(X;\theta)} \right)^T\\
  &= \frac{\nabla_{\theta}^2~p(X;\theta)}{p(X;\theta)} - \left(S_{\theta}^X\right)\left(S_{\theta}^X\right)^T
 \end{align}</script><p></p><p> 在一定条件下，容易证明 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1445-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-23642" style="width: 9.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.377em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.321em 1000em 5.048em -0.461em); top: -3.934em; left: 0em;"><span class="mrow" id="MathJax-Span-23643"><span class="mi" id="MathJax-Span-23644" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mrow" id="MathJax-Span-23645" style="padding-left: 0.167em;"><span class="mo" id="MathJax-Span-23646" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">[</span></span><span class="mfrac" id="MathJax-Span-23647"><span style="display: inline-block; position: relative; width: 3.289em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.508em 1000em 2.654em -0.459em); top: -2.902em; left: 50%; margin-left: -1.585em;"><span class="mrow" id="MathJax-Span-23648"><span class="msubsup" id="MathJax-Span-23649"><span style="display: inline-block; position: relative; width: 0.927em; height: 0px;"><span style="position: absolute; clip: rect(1.648em 1000em 2.482em -0.459em); top: -2.295em; left: 0em;"><span class="mi" id="MathJax-Span-23650" style="font-size: 70.7%; font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.689em 1000em 2.35em -0.467em); top: -2.476em; left: 0.601em;"><span class="mn" id="MathJax-Span-23651" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span><span style="position: absolute; clip: rect(1.669em 1000em 2.355em -0.474em); top: -1.996em; left: 0.601em;"><span class="texatom" id="MathJax-Span-23652"><span class="mrow" id="MathJax-Span-23653"><span class="mi" id="MathJax-Span-23654" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span><span class="mtext" id="MathJax-Span-23655" style="font-size: 70.7%; font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-23656" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23657" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23658" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mo" id="MathJax-Span-23659" style="font-size: 70.7%; font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23660" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-23661" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.601em 1000em 2.636em -0.519em); top: -1.852em; left: 50%; margin-left: -1.038em;"><span class="mrow" id="MathJax-Span-23662"><span class="mi" id="MathJax-Span-23663" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23664" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23665" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mo" id="MathJax-Span-23666" style="font-size: 70.7%; font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23667" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-23668" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 3.289em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-23669" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">]</span></span></span><span class="mo" id="MathJax-Span-23670" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-23671" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span></span><span style="display: inline-block; width: 0px; height: 3.934em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.06em; vertical-align: -1.225em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1445">E\left[\frac{\nabla_{\theta}^2~p(X;\theta)}{p(X;\theta)}\right] = 0</script></span>, 因此有:</p>
<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1446-Frame"><nobr><span class="math" id="MathJax-Span-23672" style="width: 27.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.842em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.321em 1000em 5.048em -0.461em); top: -3.934em; left: 0em;"><span class="mrow" id="MathJax-Span-23673"><span class="mi" id="MathJax-Span-23674" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-23675" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-23676"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-23677" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.086em; left: 0.874em;"><span class="texatom" id="MathJax-Span-23678"><span class="mrow" id="MathJax-Span-23679"><span class="mi" id="MathJax-Span-23680" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-23681"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.7em -0.44em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23682" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.473em); top: -2.672em; left: 0.715em;"><span class="mi" id="MathJax-Span-23683" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.993em; left: 0.624em;"><span class="texatom" id="MathJax-Span-23684"><span class="mrow" id="MathJax-Span-23685"><span class="mi" id="MathJax-Span-23686" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23687" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-23688" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-23689" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-23690" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-23691"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-23692" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.459em -0.456em); top: -2.705em; left: 0.874em;"><span class="mn" id="MathJax-Span-23693" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.972em; left: 0.874em;"><span class="texatom" id="MathJax-Span-23694"><span class="mrow" id="MathJax-Span-23695"><span class="mi" id="MathJax-Span-23696" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mtext" id="MathJax-Span-23697" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-23698" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-23699" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-23700" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mtext" id="MathJax-Span-23701" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-23702" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23703" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23704" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-23705" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23706" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">θ</span><span class="mo" id="MathJax-Span-23707" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-23708" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-23709" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-23710" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="mi" id="MathJax-Span-23711" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mrow" id="MathJax-Span-23712" style="padding-left: 0.167em;"><span class="mo" id="MathJax-Span-23713" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">[</span></span><span class="mrow" id="MathJax-Span-23714"><span class="mo" id="MathJax-Span-23715" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span><span class="msubsup" id="MathJax-Span-23716"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.7em -0.44em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23717" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.473em); top: -2.672em; left: 0.715em;"><span class="mi" id="MathJax-Span-23718" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.993em; left: 0.624em;"><span class="texatom" id="MathJax-Span-23719"><span class="mrow" id="MathJax-Span-23720"><span class="mi" id="MathJax-Span-23721" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23722" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span><span class="msubsup" id="MathJax-Span-23723" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 3.19em; height: 0px;"><span style="position: absolute; clip: rect(2.457em 1000em 4.584em -0.312em); top: -3.77em; left: 0em;"><span class="mrow" id="MathJax-Span-23724"><span class="mo" id="MathJax-Span-23725" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span><span class="msubsup" id="MathJax-Span-23726"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.7em -0.44em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23727" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.473em); top: -2.672em; left: 0.715em;"><span class="mi" id="MathJax-Span-23728" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.993em; left: 0.624em;"><span class="texatom" id="MathJax-Span-23729"><span class="mrow" id="MathJax-Span-23730"><span class="mi" id="MathJax-Span-23731" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23732" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.77em;"></span></span><span style="position: absolute; top: -3.117em; left: 2.623em;"><span class="mi" id="MathJax-Span-23733" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23734" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.934em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.06em; vertical-align: -1.225em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-1446">E[\nabla_{\theta}S_{\theta}^X] = E[\nabla_{\theta}^2~log~p(X;\theta)] = - E\left[ \left(S_{\theta}^X\right)\left(S_{\theta}^X\right)^T\right]</script><p></p><p> 可见<strong>FIM 是评分函数的一阶导的负期望, 是对数似然函数二阶导的负期望</strong>. 因此, FIM 可以看作是在对数似然函数在参数<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1447-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-23735" style="width: 0.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.492em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.645em 1000em 2.688em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-23736"><span class="mi" id="MathJax-Span-23737" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.006em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1447">\theta</script></span>附近的曲率估计. 该曲率越高窄, 说明参数<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1448-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-23738" style="width: 0.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.492em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.645em 1000em 2.688em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-23739"><span class="mi" id="MathJax-Span-23740" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.006em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1448">\theta</script></span>拟合得越好.</p>
</li></ol><h5 id="7.2.3-fisher-vector-应用于图像分类"><a name="7.2.3-fisher-vector-应用于图像分类" href="#7.2.3-fisher-vector-应用于图像分类"></a>7.2.3 Fisher Vector 应用于图像分类</h5><p>由于高斯混合模型 (GMM) 可以以任意精度近似任何连续分布, 在图像分类中, 通常用作为上面提到的概率密度函数 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1449-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-23741" style="width: 3.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.06em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.531em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-23742"><span class="mi" id="MathJax-Span-23743" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23744" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23745" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-23746" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23747" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">θ</span><span class="mo" id="MathJax-Span-23748" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1449">p(X;\theta)</script></span>. 于是将 FV 应用于图像分类的主要步骤通常为:</p><ol>
<li><p>从训练集中提取所有图片的 SIFT 特征, 每个特征是一个128维的向量.</p>
</li><li><p>假设给定一张图片的各个 SIFT 特征相互独立. 在从训练集中提取的所有 SIFT 特征上，利用 EM 算法训练一个方差为对角阵的高斯混合模型(GMM) </p>
<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1450-Frame"><nobr><span class="math" id="MathJax-Span-23749" style="width: 17.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.59em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(0.828em 1000em 4.228em -0.531em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-23750"><span class="mi" id="MathJax-Span-23751" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23752" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23753" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-23754" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23755" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">w</span><span class="mo" id="MathJax-Span-23756" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-23757" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">μ</span><span class="mo" id="MathJax-Span-23758" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-23759" style="font-family: MathJax_Main; padding-left: 0.167em;">Σ</span><span class="mo" id="MathJax-Span-23760" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-23761" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="munderover" id="MathJax-Span-23762" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.475em; height: 0px;"><span style="position: absolute; clip: rect(2.657em 1000em 4.384em -0.437em); top: -3.77em; left: 0em;"><span class="mo" id="MathJax-Span-23763" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.77em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.703em -0.5em); top: -1.207em; left: 0.137em;"><span class="texatom" id="MathJax-Span-23764"><span class="mrow" id="MathJax-Span-23765"><span class="mi" id="MathJax-Span-23766" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-23767" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-23768" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.486em 1000em 2.412em -0.458em); top: -3.39em; left: 0.546em;"><span class="mi" id="MathJax-Span-23769" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-23770" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.168em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23771" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.765em;"><span class="mi" id="MathJax-Span-23772" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-23773" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23774" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23775" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-23776" style="font-family: MathJax_Main;">;</span><span class="msubsup" id="MathJax-Span-23777" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.894em -0.469em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23778" style="font-family: MathJax_Math; font-style: italic;">μ</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -1.989em; left: 0.656em;"><span class="mi" id="MathJax-Span-23779" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23780" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-23781" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.168em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.896em -0.437em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-23782" style="font-family: MathJax_Main;">Σ</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.765em;"><span class="mi" id="MathJax-Span-23783" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23784" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-23785" style="font-family: MathJax_Main;">,</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.882em; vertical-align: -1.692em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-1450">p(x; w, \mu, \Sigma) = \sum_{j=1}^k w_j p(x; \mu_j, \Sigma_j),</script><p></p><p> 其中 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1451-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-23786" style="width: 9.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.486em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.471em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-23787"><span class="mi" id="MathJax-Span-23788" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="mo" id="MathJax-Span-23789" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-23790" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="msubsup" id="MathJax-Span-23791"><span style="display: inline-block; position: relative; width: 1.223em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23792" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.765em;"><span class="mn" id="MathJax-Span-23793" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-23794" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-23795" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-23796" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-23797" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-23798" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-23799" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.223em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23800" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.765em;"><span class="mi" id="MathJax-Span-23801" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23802" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1451">w = (w_1, ..., w_k)</script></span> 是 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1452-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-23803" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.444em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-23804"><span class="mi" id="MathJax-Span-23805" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1452">k</script></span> 个高斯函数的权重. <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1453-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-23806" style="width: 8.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.158em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.155em -0.469em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-23807"><span class="mi" id="MathJax-Span-23808" style="font-family: MathJax_Math; font-style: italic;">μ</span><span class="mo" id="MathJax-Span-23809" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-23810" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="msubsup" id="MathJax-Span-23811"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.894em -0.469em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23812" style="font-family: MathJax_Math; font-style: italic;">μ</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.044em; left: 0.656em;"><span class="mn" id="MathJax-Span-23813" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-23814" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-23815" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-23816" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-23817" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-23818" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-23819" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.894em -0.469em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23820" style="font-family: MathJax_Math; font-style: italic;">μ</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -1.989em; left: 0.656em;"><span class="mi" id="MathJax-Span-23821" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23822" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.364em; vertical-align: -0.383em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1453">\mu = (\mu_1, ..., \mu_k)</script></span> 和 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1454-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-23823" style="width: 9.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.486em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-23824"><span class="mi" id="MathJax-Span-23825" style="font-family: MathJax_Main;">Σ</span><span class="mo" id="MathJax-Span-23826" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-23827" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="msubsup" id="MathJax-Span-23828"><span style="display: inline-block; position: relative; width: 1.223em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.896em -0.437em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-23829" style="font-family: MathJax_Main;">Σ</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.765em;"><span class="mn" id="MathJax-Span-23830" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-23831" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-23832" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-23833" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-23834" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-23835" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-23836" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.223em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.896em -0.437em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-23837" style="font-family: MathJax_Main;">Σ</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.765em;"><span class="mi" id="MathJax-Span-23838" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23839" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1454">\Sigma = (\Sigma_1, ..., \Sigma_k)</script></span> 是各个高斯函数的均值和方差矩阵. </p>
<p> <strong>假设这些方差矩阵为对角阵是一个标准的假设</strong>.</p>
</li><li><p>对于一幅图片, 首先提取其 SIFT 特征 </p>
<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1455-Frame"><nobr><span class="math" id="MathJax-Span-23840" style="width: 13.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.038em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.466em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-23841"><span class="mi" id="MathJax-Span-23842" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-23843" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-23844" style="font-family: MathJax_Main; padding-left: 0.278em;">{</span><span class="msubsup" id="MathJax-Span-23845"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23846" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.601em;"><span class="mn" id="MathJax-Span-23847" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-23848" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-23849" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-23850" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-23851" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-23852" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-23853" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23854" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-23855" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23856" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-23857" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-23858" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-23859" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-23860" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-23861" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23862" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-23863" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23864" style="font-family: MathJax_Main;">}</span><span class="mo" id="MathJax-Span-23865" style="font-family: MathJax_Main;">,</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-1455">X = \{x_1, ..., x_i, ..., x_n\},</script><p></p><p> 计算 GMM 模型</p>
<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1456-Frame"><nobr><span class="math" id="MathJax-Span-23866" style="width: 18.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.355em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(0.828em 1000em 4.228em -0.531em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-23867"><span class="mi" id="MathJax-Span-23868" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23869" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-23870"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23871" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-23872" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23873" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23874" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">w</span><span class="mo" id="MathJax-Span-23875" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-23876" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">μ</span><span class="mo" id="MathJax-Span-23877" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-23878" style="font-family: MathJax_Main; padding-left: 0.167em;">Σ</span><span class="mo" id="MathJax-Span-23879" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-23880" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="munderover" id="MathJax-Span-23881" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.475em; height: 0px;"><span style="position: absolute; clip: rect(2.657em 1000em 4.384em -0.437em); top: -3.77em; left: 0em;"><span class="mo" id="MathJax-Span-23882" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.77em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.703em -0.5em); top: -1.207em; left: 0.137em;"><span class="texatom" id="MathJax-Span-23883"><span class="mrow" id="MathJax-Span-23884"><span class="mi" id="MathJax-Span-23885" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-23886" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-23887" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.486em 1000em 2.412em -0.458em); top: -3.39em; left: 0.546em;"><span class="mi" id="MathJax-Span-23888" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-23889" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.168em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23890" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.765em;"><span class="mi" id="MathJax-Span-23891" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mi" id="MathJax-Span-23892" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23893" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-23894"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23895" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-23896" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23897" style="font-family: MathJax_Main;">;</span><span class="msubsup" id="MathJax-Span-23898" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.059em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.894em -0.469em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23899" style="font-family: MathJax_Math; font-style: italic;">μ</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -1.989em; left: 0.656em;"><span class="mi" id="MathJax-Span-23900" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23901" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-23902" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.168em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.896em -0.437em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-23903" style="font-family: MathJax_Main;">Σ</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.765em;"><span class="mi" id="MathJax-Span-23904" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23905" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-23906" style="font-family: MathJax_Main;">,</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.882em; vertical-align: -1.692em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-1456">p(x_i; w, \mu, \Sigma) = \sum_{j=1}^k w_j p(x_i; \mu_j, \Sigma_j),</script><p></p><p> 然后求 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1457-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-23907" style="width: 1.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.874em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-23908"><span class="mi" id="MathJax-Span-23909" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1457">X</script></span> 的评分函数 (假设一幅图片的各个 SIFT 特征相互独立, 虽然该假设有偏颇)</p>
<p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1458-Frame"><nobr><span class="math" id="MathJax-Span-23910" style="width: 28.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.951em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.006em 1000em 4.092em -0.44em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-23911"><span class="msubsup" id="MathJax-Span-23912"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px;"><span style="position: absolute; clip: rect(1.645em 1000em 2.7em -0.44em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23913" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(1.594em 1000em 2.404em -0.473em); top: -2.672em; left: 0.715em;"><span class="mi" id="MathJax-Span-23914" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(1.578em 1000em 2.411em -0.467em); top: -1.993em; left: 0.624em;"><span class="mi" id="MathJax-Span-23915" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23916" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-23917" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-23918" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.086em; left: 0.874em;"><span class="mi" id="MathJax-Span-23919" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mtext" id="MathJax-Span-23920" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-23921" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-23922" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-23923" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mtext" id="MathJax-Span-23924" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-23925" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23926" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23927" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-23928" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23929" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">w</span><span class="mo" id="MathJax-Span-23930" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-23931" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">μ</span><span class="mo" id="MathJax-Span-23932" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-23933" style="font-family: MathJax_Main; padding-left: 0.167em;">Σ</span><span class="mo" id="MathJax-Span-23934" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-23935" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="munderover" id="MathJax-Span-23936" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.475em; height: 0px;"><span style="position: absolute; clip: rect(2.657em 1000em 4.384em -0.437em); top: -3.77em; left: 0em;"><span class="mo" id="MathJax-Span-23937" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.77em;"></span></span><span style="position: absolute; clip: rect(1.66em 1000em 2.567em -0.477em); top: -1.207em; left: 0.164em;"><span class="texatom" id="MathJax-Span-23938"><span class="mrow" id="MathJax-Span-23939"><span class="mi" id="MathJax-Span-23940" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-23941" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-23942" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.664em 1000em 2.412em -0.477em); top: -3.39em; left: 0.519em;"><span class="mi" id="MathJax-Span-23943" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-23944" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-23945" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.086em; left: 0.874em;"><span class="mi" id="MathJax-Span-23946" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mtext" id="MathJax-Span-23947" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-23948" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-23949" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-23950" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mtext" id="MathJax-Span-23951" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-23952" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-23953" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-23954"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-23955" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-23956" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-23957" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-23958" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">w</span><span class="mo" id="MathJax-Span-23959" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-23960" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">μ</span><span class="mo" id="MathJax-Span-23961" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-23962" style="font-family: MathJax_Main; padding-left: 0.167em;">Σ</span><span class="mo" id="MathJax-Span-23963" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.498em; vertical-align: -1.525em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-1458">S_\theta^X=\nabla_\theta~log~p(X;w, \mu, \Sigma) = \sum_{i=1}^n\nabla_\theta~log~p(x_i;w, \mu, \Sigma)</script><p></p><p> 即<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1459-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-23964" style="width: 1.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.874em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.466em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-23965"><span class="mi" id="MathJax-Span-23966" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1459">X</script></span>的对数似然函数对参数的梯度 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1460-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-23967" style="width: 5.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.098em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.885em 1000em 3.199em -0.446em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-23968"><span class="msubsup" id="MathJax-Span-23969"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-23970" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-23971" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mtext" id="MathJax-Span-23972" style="font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-23973" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-23974" style="font-family: MathJax_Main; padding-left: 0.167em;">&nbsp;</span><span class="msubsup" id="MathJax-Span-23975"><span style="display: inline-block; position: relative; width: 1.386em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-23976" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-23977" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">μ</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mtext" id="MathJax-Span-23978" style="font-family: MathJax_Main;">&nbsp;</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.336em; vertical-align: -0.436em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1460">\nabla_w~, ~\nabla_\mu~</script></span>, 和 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1461-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-23979" style="width: 2.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.022em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.885em 1000em 3.046em -0.492em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-23980"><span class="mtext" id="MathJax-Span-23981" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-23982"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-23983" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.874em;"><span class="mi" id="MathJax-Span-23984" style="font-size: 70.7%; font-family: MathJax_Main;">Σ</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mtext" id="MathJax-Span-23985" style="font-family: MathJax_Main;">&nbsp;</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.15em; vertical-align: -0.25em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1461">~\nabla_\Sigma~</script></span>. 用 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1462-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-23986" style="width: 16.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.77em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.613em 1000em 3.245em -0.409em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-23987"><span class="mn" id="MathJax-Span-23988" style="font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-23989"><span class="mrow" id="MathJax-Span-23990"><span class="mo" id="MathJax-Span-23991" style="font-family: MathJax_Main;">/</span></span></span><span class="msqrt" id="MathJax-Span-23992"><span style="display: inline-block; position: relative; width: 1.694em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0.82em;"><span class="mrow" id="MathJax-Span-23993"><span class="mi" id="MathJax-Span-23994" style="font-family: MathJax_Math; font-style: italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; clip: rect(3.555em 1000em 4.023em -0.492em); top: -4.452em; left: 0.82em;"><span style="display: inline-block; position: relative; width: 0.874em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.989em; left: -0.084em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.989em; left: 0.18em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(3.025em 1000em 4.353em -0.42em); top: -3.914em; left: 0em;"><span style="font-family: MathJax_Main;">√</span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span></span><span class="mo" id="MathJax-Span-23995" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-23996" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="mn" id="MathJax-Span-23997" style="font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-23998"><span class="mrow" id="MathJax-Span-23999"><span class="mo" id="MathJax-Span-24000" style="font-family: MathJax_Main;">/</span></span></span><span class="msqrt" id="MathJax-Span-24001"><span style="display: inline-block; position: relative; width: 2.067em; height: 0px;"><span style="position: absolute; clip: rect(3.382em 1000em 4.303em -0.471em); top: -3.989em; left: 0.82em;"><span class="mrow" id="MathJax-Span-24002"><span class="msubsup" id="MathJax-Span-24003"><span style="display: inline-block; position: relative; width: 1.223em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-24004" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.765em;"><span class="mn" id="MathJax-Span-24005" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(3.555em 1000em 4.023em -0.492em); top: -4.382em; left: 0.82em;"><span style="display: inline-block; position: relative; width: 1.248em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.989em; left: -0.084em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.989em; left: 0.554em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 0.222em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(3.025em 1000em 4.353em -0.42em); top: -3.844em; left: 0em;"><span style="font-family: MathJax_Main;">√</span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span></span><span class="mo" id="MathJax-Span-24006" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-24007" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-24008" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-24009" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-24010" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="mn" id="MathJax-Span-24011" style="font-family: MathJax_Main; padding-left: 0.167em;">1</span><span class="texatom" id="MathJax-Span-24012"><span class="mrow" id="MathJax-Span-24013"><span class="mo" id="MathJax-Span-24014" style="font-family: MathJax_Main;">/</span></span></span><span class="msqrt" id="MathJax-Span-24015"><span style="display: inline-block; position: relative; width: 2.067em; height: 0px;"><span style="position: absolute; clip: rect(3.382em 1000em 4.311em -0.471em); top: -3.989em; left: 0.82em;"><span class="mrow" id="MathJax-Span-24016"><span class="msubsup" id="MathJax-Span-24017"><span style="display: inline-block; position: relative; width: 1.223em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-24018" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.765em;"><span class="mi" id="MathJax-Span-24019" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(3.555em 1000em 4.023em -0.492em); top: -4.378em; left: 0.82em;"><span style="display: inline-block; position: relative; width: 1.248em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.989em; left: -0.084em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.989em; left: 0.554em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 0.222em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(3.025em 1000em 4.353em -0.42em); top: -3.84em; left: 0em;"><span style="font-family: MathJax_Main;">√</span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-24020"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.437em); top: -2.732em; left: 0em;"><span class="mo" id="MathJax-Span-24021" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.717em; left: 0.437em;"><span class="mi" id="MathJax-Span-24022" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.725em; vertical-align: -0.492em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1462">1/\sqrt{w} = (1/\sqrt{w_1}, ..., 1/\sqrt{w_k})^T</script></span>对评分函数进行标准化(normalization). 注意, 在一定的假设下, FIM 成为一个对角阵, 该标准化操作意味着FIM <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1463-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24023" style="width: 7.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.847em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.461em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24024"><span class="msubsup" id="MathJax-Span-24025"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(1.67em 1000em 2.678em -0.461em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-24026" style="font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.086em; left: 0.659em;"><span class="mi" id="MathJax-Span-24027" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-24028" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-24029" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-24030" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-24031" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-24032" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-24033" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-24034" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="mo" id="MathJax-Span-24035" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1463">F_\theta = diag(w)</script></span>. </p>
<p> 最终得到这样一个FV向量 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1464-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24036" style="width: 14.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.803em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.685em 1000em 3.521em -0.461em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24037"><span class="mi" id="MathJax-Span-24038" style="font-family: MathJax_Math; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mi" id="MathJax-Span-24039" style="font-family: MathJax_Math; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.186em;"></span></span><span class="mo" id="MathJax-Span-24040" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-24041" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.268em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.66em 1000em 2.459em -0.433em); top: -2.708em; left: 50%; margin-left: -0.191em;"><span class="mn" id="MathJax-Span-24042" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(3.322em 1000em 4.363em -0.441em); top: -3.574em; left: 50%; margin-left: -0.574em;"><span class="msqrt" id="MathJax-Span-24043"><span style="display: inline-block; position: relative; width: 1.148em; height: 0px;"><span style="position: absolute; clip: rect(1.763em 1000em 2.412em -0.477em); top: -2.24em; left: 0.601em;"><span class="mrow" id="MathJax-Span-24044"><span class="mi" id="MathJax-Span-24045" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; clip: rect(0.929em 1000em 1.325em -0.492em); top: -1.596em; left: 0.601em;"><span style="border-left-width: 0.546em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: -0.068em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span><span style="position: absolute; clip: rect(3.259em 1000em 4.294em -0.441em); top: -3.921em; left: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Main;">√</span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 1.268em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-24046" style="font-family: MathJax_Main; padding-left: 0.167em;">(</span><span class="msubsup" id="MathJax-Span-24047"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-24048" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-24049" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mtext" id="MathJax-Span-24050" style="font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-24051" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-24052" style="font-family: MathJax_Main; padding-left: 0.167em;">&nbsp;</span><span class="msubsup" id="MathJax-Span-24053"><span style="display: inline-block; position: relative; width: 1.386em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-24054" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.874em;"><span class="mi" id="MathJax-Span-24055" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">μ</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mtext" id="MathJax-Span-24056" style="font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-24057" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-24058" style="font-family: MathJax_Main; padding-left: 0.167em;">&nbsp;</span><span class="msubsup" id="MathJax-Span-24059"><span style="display: inline-block; position: relative; width: 1.496em; height: 0px;"><span style="position: absolute; clip: rect(1.885em 1000em 2.929em -0.446em); top: -2.732em; left: 0em;"><span class="mi" id="MathJax-Span-24060" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.874em;"><span class="mi" id="MathJax-Span-24061" style="font-size: 70.7%; font-family: MathJax_Main;">Σ</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mtext" id="MathJax-Span-24062" style="font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-24063" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.974em; vertical-align: -0.829em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1464">FV = \frac{1}{\sqrt{w}}(\nabla_w~, ~\nabla_\mu~, ~\nabla_\Sigma~)</script></span>. 假设高斯混合模型由<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1465-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24064" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.444em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24065"><span class="mi" id="MathJax-Span-24066" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1465">k</script></span> 个高斯函数加权混合而成, 每个高斯函数的均值和方差均为 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1466-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24067" style="width: 1.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.874em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.667em 1000em 2.678em -0.459em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24068"><span class="mi" id="MathJax-Span-24069" style="font-family: MathJax_Math; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.967em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1466">D</script></span> 维, 那么最终得到的FV向量为 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1467-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24070" style="width: 5.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.372em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24071"><span class="mo" id="MathJax-Span-24072" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-24073" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-24074" style="font-family: MathJax_Math; font-style: italic;">D</span><span class="mo" id="MathJax-Span-24075" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mn" id="MathJax-Span-24076" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span><span class="mo" id="MathJax-Span-24077" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-24078" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1467">(2D+1)k</script></span> 维. 注意，方差为对角阵, 可以用一向量表示.</p>
</li><li><p>该 FV 向量便可以作为一幅图片的特征向量, 用多分类器对其进行分类.</p>
</li></ol><h4 id="7.3-vlad-(vector-of-locally-aggregated-descriptor-[13])"><a name="7.3-vlad-(vector-of-locally-aggregated-descriptor-[13])" href="#7.3-vlad-(vector-of-locally-aggregated-descriptor-[13])"></a>7.3 VLAD (vector of locally aggregated descriptor [13])</h4><p>VLAD 像 BoVW 一样, 先用 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1468-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24079" style="width: 5.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.699em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.874em 1000em 2.907em -0.444em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24080"><span class="mi" id="MathJax-Span-24081" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-24082" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-24083" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">m</span><span class="mi" id="MathJax-Span-24084" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-24085" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-24086" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-24087" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1468">k-means</script></span> 算法学习一个包含 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1469-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24088" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.444em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24089"><span class="mi" id="MathJax-Span-24090" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1469">k</script></span> 个字的视字本 (vocabulary of visual word) <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1470-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24091" style="width: 8.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.667em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.48em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24092"><span class="texatom" id="MathJax-Span-24093"><span class="mrow" id="MathJax-Span-24094"><span class="mi" id="MathJax-Span-24095" style="font-family: MathJax_Caligraphic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span></span><span class="mo" id="MathJax-Span-24096" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-24097" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="msubsup" id="MathJax-Span-24098"><span style="display: inline-block; position: relative; width: 0.895em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.458em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-24099" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.437em;"><span class="mn" id="MathJax-Span-24100" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-24101" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-24102" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-24103" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-24104" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-24105" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-24106" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.895em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.458em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-24107" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.437em;"><span class="mi" id="MathJax-Span-24108" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-24109" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1470">\mathcal{C} = (c_1, ..., c_k)</script></span>.</p><p>图片的每一个局部特征 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1471-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24110" style="width: 0.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.601em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24111"><span class="mi" id="MathJax-Span-24112" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.686em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1471">x</script></span> 都会被分配到与它距离最近的视字 (visual word) <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1472-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24113" style="width: 6.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.246em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.458em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24114"><span class="msubsup" id="MathJax-Span-24115"><span style="display: inline-block; position: relative; width: 0.785em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.458em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-24116" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.437em;"><span class="mi" id="MathJax-Span-24117" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-24118" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-24119" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span class="mi" id="MathJax-Span-24120" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span class="mo" id="MathJax-Span-24121" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-24122" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-24123" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1472">c_i = NN(x)</script></span>.</p><p>VLAD 的关键想法是 将分配到视字 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1473-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24124" style="width: 1.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.58em 1000em 2.508em -0.458em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-24125"><span class="msubsup" id="MathJax-Span-24126"><span style="display: inline-block; position: relative; width: 0.785em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.458em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-24127" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.437em;"><span class="mi" id="MathJax-Span-24128" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.865em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1473">c_i</script></span> 的所有局部特征 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1474-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24129" style="width: 0.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.601em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24130"><span class="mi" id="MathJax-Span-24131" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.686em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1474">x</script></span> 到该视字的距离 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1475-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24132" style="width: 12.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 4.12em -0.471em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24133"><span class="msubsup" id="MathJax-Span-24134"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-24135" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.492em;"><span class="mi" id="MathJax-Span-24136" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-24137" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="munderover" id="MathJax-Span-24138" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 5.082em; height: 0px;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.436em); top: -2.732em; left: 1.995em;"><span class="mo" id="MathJax-Span-24139" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span><span style="position: absolute; clip: rect(1.601em 1000em 2.736em -0.467em); top: -1.348em; left: 0em;"><span class="texatom" id="MathJax-Span-24140"><span class="mrow" id="MathJax-Span-24141"><span class="mi" id="MathJax-Span-24142" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span class="mtext" id="MathJax-Span-24143" style="font-size: 70.7%; font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-24144" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-24145" style="font-size: 70.7%; font-family: MathJax_Main;">.</span><span class="mi" id="MathJax-Span-24146" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-24147" style="font-size: 70.7%; font-family: MathJax_Main;">.</span><span class="mtext" id="MathJax-Span-24148" style="font-size: 70.7%; font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-24149" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-24150" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-24151" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-24152" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-24153" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-24154" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="msubsup" id="MathJax-Span-24155"><span style="display: inline-block; position: relative; width: 0.599em; height: 0px;"><span style="position: absolute; clip: rect(1.764em 1000em 2.412em -0.468em); top: -2.24em; left: 0em;"><span class="mi" id="MathJax-Span-24156" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; top: -2.08em; left: 0.328em;"><span class="mi" id="MathJax-Span-24157" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mi" id="MathJax-Span-24158" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">x</span><span class="mo" id="MathJax-Span-24159" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-24160" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.785em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.458em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-24161" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.437em;"><span class="mi" id="MathJax-Span-24162" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.541em; vertical-align: -1.56em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1475">v_i = \sum\limits_{x~s.t.~NN(x)=c_i} x - c_i</script></span> 累加起来. </p><p>假设局部特征 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1476-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24163" style="width: 0.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.601em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24164"><span class="mi" id="MathJax-Span-24165" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.686em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1476">x</script></span> 具有 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1477-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24166" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.656em 1000em 2.688em -0.459em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24167"><span class="mi" id="MathJax-Span-24168" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.992em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1477">d</script></span> 维, 视字本有 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1478-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24169" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.444em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24170"><span class="mi" id="MathJax-Span-24171" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1478">k</script></span> 个字, 那么整个图像的全局特征就是 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1479-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24172" style="width: 2.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.295em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.874em 1000em 2.907em -0.444em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24173"><span class="mi" id="MathJax-Span-24174" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-24175" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mi" id="MathJax-Span-24176" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1479">k\times d</script></span> 维的. </p><p>如果用下标 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1480-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24177" style="width: 0.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.437em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.689em 1000em 2.882em -0.504em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24178"><span class="mi" id="MathJax-Span-24179" style="font-family: MathJax_Math; font-style: italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.189em; vertical-align: -0.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1480">j</script></span> 索引向量 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1481-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24180" style="width: 4.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.607em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.125em 1000em 3.09em -0.471em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24181"><span class="msubsup" id="MathJax-Span-24182"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-24183" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.492em;"><span class="mi" id="MathJax-Span-24184" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-24185" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-24186" style="font-family: MathJax_Main; padding-left: 0.167em;">&nbsp;</span><span class="mi" id="MathJax-Span-24187" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-24188" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-24189" style="font-family: MathJax_Main; padding-left: 0.167em;">&nbsp;</span><span class="msubsup" id="MathJax-Span-24190"><span style="display: inline-block; position: relative; width: 0.785em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.458em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-24191" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.437em;"><span class="mi" id="MathJax-Span-24192" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.91em; vertical-align: -0.303em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1481">v_i, ~x, ~c_i</script></span> 的各个分量, 那么</p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1482-Frame"><nobr><span class="math" id="MathJax-Span-24193" style="width: 21.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.869em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.618em 1000em 4.32em -0.471em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24194"><span class="msubsup" id="MathJax-Span-24195"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-24196" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="texatom" id="MathJax-Span-24197"><span class="mrow" id="MathJax-Span-24198"><span class="mi" id="MathJax-Span-24199" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-24200" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-24201" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-24202" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="munderover" id="MathJax-Span-24203" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 5.082em; height: 0px;"><span style="position: absolute; clip: rect(2.657em 1000em 4.384em -0.437em); top: -3.77em; left: 1.803em;"><span class="mo" id="MathJax-Span-24204" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.77em;"></span></span><span style="position: absolute; clip: rect(1.601em 1000em 2.736em -0.467em); top: -1.148em; left: 0em;"><span class="texatom" id="MathJax-Span-24205"><span class="mrow" id="MathJax-Span-24206"><span class="mi" id="MathJax-Span-24207" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span class="mtext" id="MathJax-Span-24208" style="font-size: 70.7%; font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-24209" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-24210" style="font-size: 70.7%; font-family: MathJax_Main;">.</span><span class="mi" id="MathJax-Span-24211" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-24212" style="font-size: 70.7%; font-family: MathJax_Main;">.</span><span class="mtext" id="MathJax-Span-24213" style="font-size: 70.7%; font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-24214" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-24215" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-24216" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-24217" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-24218" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-24219" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="msubsup" id="MathJax-Span-24220"><span style="display: inline-block; position: relative; width: 0.599em; height: 0px;"><span style="position: absolute; clip: rect(1.764em 1000em 2.412em -0.468em); top: -2.24em; left: 0em;"><span class="mi" id="MathJax-Span-24221" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span><span style="position: absolute; top: -2.08em; left: 0.328em;"><span class="mi" id="MathJax-Span-24222" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-24223" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.457em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-24224" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.601em;"><span class="mi" id="MathJax-Span-24225" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-24226" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-24227" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(1.908em 1000em 2.689em -0.458em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-24228" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.437em;"><span class="texatom" id="MathJax-Span-24229"><span class="mrow" id="MathJax-Span-24230"><span class="mi" id="MathJax-Span-24231" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-24232" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-24233" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-24234" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-24235" style="font-family: MathJax_Main; padding-left: 0.167em;">&nbsp;</span><span class="mi" id="MathJax-Span-24236" style="font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-24237" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-24238" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="mo" id="MathJax-Span-24239" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-24240" style="font-family: MathJax_Main; padding-left: 0.167em;">&nbsp;</span><span class="mo" id="MathJax-Span-24241" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-24242" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-24243" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-24244" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="mtext" id="MathJax-Span-24245" style="font-family: MathJax_Main; padding-left: 0.167em;">&nbsp;</span><span class="mi" id="MathJax-Span-24246" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-24247" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.029em; vertical-align: -1.804em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-1482">v_{i,j} = \sum\limits_{x~s.t.~NN(x)=c_i} x_j - c_{i,j},~ j=1,~...,~d.</script><p></p><p>最终得到的向量 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1483-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24248" style="width: 8.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.213em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.471em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24249"><span class="mi" id="MathJax-Span-24250" style="font-family: MathJax_Math; font-style: italic;">v</span><span class="mo" id="MathJax-Span-24251" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-24252" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="msubsup" id="MathJax-Span-24253"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-24254" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="mn" id="MathJax-Span-24255" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-24256" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-24257" style="font-family: MathJax_Main; padding-left: 0.167em;">&nbsp;</span><span class="mo" id="MathJax-Span-24258" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-24259" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-24260" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-24261" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="mtext" id="MathJax-Span-24262" style="font-family: MathJax_Main; padding-left: 0.167em;">&nbsp;</span><span class="msubsup" id="MathJax-Span-24263"><span style="display: inline-block; position: relative; width: 0.949em; height: 0px;"><span style="position: absolute; clip: rect(1.907em 1000em 2.689em -0.471em); top: -2.514em; left: 0em;"><span class="mi" id="MathJax-Span-24264" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.492em;"><span class="mi" id="MathJax-Span-24265" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 2.24em;"></span></span></span></span><span class="mo" id="MathJax-Span-24266" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1483">v = (v_1,~...,~v_k)</script></span> 即是整个图像的全局特征向量.</p><h4 id="7.4-bov,-fv-和-vlad-的关系"><a name="7.4-bov,-fv-和-vlad-的关系" href="#7.4-bov,-fv-和-vlad-的关系"></a>7.4 BoV, FV 和 VLAD 的关系</h4><p>FV 可以看作是 BoV 的推广, VLAD 则是 FV 的简化. </p><p>对于同样大小的视字本 (visual vocabulary) 来说, FV 由于包含了对均值和方差的梯度而显著地比 BoV 携带了更多关于图像的信息. 特别是, BoV 特征只是一个 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1484-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24267" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.444em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24268"><span class="mi" id="MathJax-Span-24269" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1484">k</script></span> 维的向量, 而 FV 特征具有 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1485-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24270" style="width: 6.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.301em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.398em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-24271"><span class="mo" id="MathJax-Span-24272" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-24273" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-24274" style="font-family: MathJax_Math; font-style: italic;">D</span><span class="mo" id="MathJax-Span-24275" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mn" id="MathJax-Span-24276" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span><span class="mo" id="MathJax-Span-24277" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-24278" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mi" id="MathJax-Span-24279" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">k</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1485">(2D+1)*k</script></span> 维. 实验表明, 对于同样维度的特征来说, FV 的性能通常不低于甚至有时明显好于 BoV; 并且由于 FV 的 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1486-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24280" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.656em 1000em 2.689em -0.444em); top: -2.514em; left: 0em;"><span class="mrow" id="MathJax-Span-24281"><span class="mi" id="MathJax-Span-24282" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.514em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1486">k</script></span> 值更小, 从而在运算速度上比 BoV 快得多.</p>

<footer style="position:fixed; font-size:.8em; text-align:right; bottom:0px; margin-left:-25px; height:20px; width:100%;">generated by <a href="http://pad.haroopress.com" target="_blank">haroopad</a></footer>
</body>
</html>
